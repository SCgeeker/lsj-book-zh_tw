<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>用jamovi上手統計學 - 10&nbsp; 類別資料分析</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./11-Comparing-two-means.html" rel="next">
<link href="./Prelude-Part-V.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "沒有結果",
    "search-matching-documents-text": "符合的文件",
    "search-copy-link-title": "複製搜尋連結",
    "search-hide-matches-text": "隱藏其他符合的結果",
    "search-more-match-text": "更多符合結果",
    "search-more-matches-text": "更多符合結果",
    "search-clear-button-title": "清除",
    "search-detached-cancel-button-title": "取消",
    "search-submit-button-title": "送出"
  }
}</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['S$','S$'], ["\\[","\\]"] ]
      processEscapes: true
    }
  });
</script>
    

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="用jamovi上手統計學 - 10&nbsp; 類別資料分析">
<meta property="og:description" content="">
<meta property="og:image" content="https://scgeeker.github.io/lsj-book-zh_tw/10-Categorical-data-analysis_files/figure-html/fig-fig14-1-1.png">
<meta property="og:site-name" content="用jamovi上手統計學">
<meta property="og:image:height" content="960">
<meta property="og:image:width" content="960">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="切換側邊欄導航" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Prelude-Part-V.html">統計方法</a></li><li class="breadcrumb-item"><a href="./10-Categorical-data-analysis.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">類別資料分析</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="切換側邊欄導航" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">用jamovi上手統計學</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/SCgeeker/lsj-book-zh_tw/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./用jamovi上手統計學.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="切換深色模式"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="切換閱讀器模式">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">&nbsp;</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">前言</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
 <span class="menu-text">新手須知</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false" aria-label="切換區段">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-Why-do-we-learn-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">為什麼要學習統計</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-A-brief-introduction-to-research-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">研究設計入門</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
 <span class="menu-text">jamovi初體驗</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="切換區段">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-Getting-started-with-jamovi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">與jamovi的第一次接觸</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">資料處理</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="切換區段">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-Descriptive-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">描述統計</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-Drawing-graphs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">繪製統計圖</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-Pragmatic-matters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">實務課題</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
 <span class="menu-text">統計理論</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="切換區段">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Prelude-Part-IV.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">中場故事</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-Introduction-to-probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">機率入門</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-Estimating-unknown-quantities-from-a-sample.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">運用樣本估計未知量數</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-Hypothesis-testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">假設檢定</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">統計方法</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="切換區段">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Prelude-Part-V.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">線性模型的學習取向</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-Categorical-data-analysis.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">類別資料分析</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-Comparing-two-means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">比較單一與兩組平均值</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-Correlation-and-linear-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">相關與線性迴歸</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-Comparing-several-means-one-way-ANOVA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">比較多組平均值(單因子變異數分析)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-Factorial-ANOVA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">多因子變異數分析</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-Factor-Analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">因素分析</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
 <span class="menu-text">貝氏統計</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false" aria-label="切換區段">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-Bayesian-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">貝氏統計</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Epilogue.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">後記</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./References.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">參考資料</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">目錄</h2>
   
  <ul>
  <li><a href="#卡方適合度檢定" id="toc-卡方適合度檢定" class="nav-link active" data-scroll-target="#卡方適合度檢定"><span class="header-section-number">10.1</span> 卡方適合度檢定</a>
  <ul class="collapse">
  <li><a href="#撲克牌花色隨機選擇資料" id="toc-撲克牌花色隨機選擇資料" class="nav-link" data-scroll-target="#撲克牌花色隨機選擇資料"><span class="header-section-number">10.1.1</span> 撲克牌花色隨機選擇資料</a></li>
  <li><a href="#虛無假設與對立假設" id="toc-虛無假設與對立假設" class="nav-link" data-scroll-target="#虛無假設與對立假設"><span class="header-section-number">10.1.2</span> 虛無假設與對立假設</a></li>
  <li><a href="#適合度檢定統計程序" id="toc-適合度檢定統計程序" class="nav-link" data-scroll-target="#適合度檢定統計程序"><span class="header-section-number">10.1.3</span> 適合度檢定統計程序</a></li>
  <li><a href="#適合度檢定的樣本分佈" id="toc-適合度檢定的樣本分佈" class="nav-link" data-scroll-target="#適合度檢定的樣本分佈"><span class="header-section-number">10.1.4</span> 適合度檢定的樣本分佈</a></li>
  <li><a href="#自由度" id="toc-自由度" class="nav-link" data-scroll-target="#自由度"><span class="header-section-number">10.1.5</span> 自由度</a></li>
  <li><a href="#檢定虛無假設" id="toc-檢定虛無假設" class="nav-link" data-scroll-target="#檢定虛無假設"><span class="header-section-number">10.1.6</span> 檢定虛無假設</a></li>
  <li><a href="#jamovi實作" id="toc-jamovi實作" class="nav-link" data-scroll-target="#jamovi實作"><span class="header-section-number">10.1.7</span> jamovi實作</a></li>
  <li><a href="#另一種虛無假設" id="toc-另一種虛無假設" class="nav-link" data-scroll-target="#另一種虛無假設"><span class="header-section-number">10.1.8</span> 另一種虛無假設</a></li>
  <li><a href="#sec-How-to-report-the-results-of-a-test" id="toc-sec-How-to-report-the-results-of-a-test" class="nav-link" data-scroll-target="#sec-How-to-report-the-results-of-a-test"><span class="header-section-number">10.1.9</span> 適合度檢定的報告寫作</a></li>
  </ul></li>
  <li><a href="#卡方獨立性檢定" id="toc-卡方獨立性檢定" class="nav-link" data-scroll-target="#卡方獨立性檢定"><span class="header-section-number">10.2</span> 卡方獨立性檢定</a>
  <ul class="collapse">
  <li><a href="#sec-Constructing-independence-test" id="toc-sec-Constructing-independence-test" class="nav-link" data-scroll-target="#sec-Constructing-independence-test"><span class="header-section-number">10.2.1</span> 建立獨立性的假設檢定</a></li>
  <li><a href="#sec-doing-independence-test" id="toc-sec-doing-independence-test" class="nav-link" data-scroll-target="#sec-doing-independence-test"><span class="header-section-number">10.2.2</span> 獨立性檢定實作</a></li>
  </ul></li>
  <li><a href="#卡方檢定的校正" id="toc-卡方檢定的校正" class="nav-link" data-scroll-target="#卡方檢定的校正"><span class="header-section-number">10.3</span> 卡方檢定的校正</a></li>
  <li><a href="#卡方檢定的效果量" id="toc-卡方檢定的效果量" class="nav-link" data-scroll-target="#卡方檢定的效果量"><span class="header-section-number">10.4</span> 卡方檢定的效果量</a></li>
  <li><a href="#卡方檢定的適用條件" id="toc-卡方檢定的適用條件" class="nav-link" data-scroll-target="#卡方檢定的適用條件"><span class="header-section-number">10.5</span> 卡方檢定的適用條件</a></li>
  <li><a href="#sec-The-Fisher-test" id="toc-sec-The-Fisher-test" class="nav-link" data-scroll-target="#sec-The-Fisher-test"><span class="header-section-number">10.6</span> 費雪精確檢定</a></li>
  <li><a href="#sec-The-McNemar-test" id="toc-sec-The-McNemar-test" class="nav-link" data-scroll-target="#sec-The-McNemar-test"><span class="header-section-number">10.7</span> 麥內瑪檢定</a>
  <ul class="collapse">
  <li><a href="#sec-doing-The-McNemar-test" id="toc-sec-doing-The-McNemar-test" class="nav-link" data-scroll-target="#sec-doing-The-McNemar-test"><span class="header-section-number">10.7.1</span> 實作麥內瑪檢定</a></li>
  <li><a href="#sec-difference-McNemar-independence" id="toc-sec-difference-McNemar-independence" class="nav-link" data-scroll-target="#sec-difference-McNemar-independence"><span class="header-section-number">10.7.2</span> 與獨立性檢定有可分別?</a></li>
  </ul></li>
  <li><a href="#本章小結" id="toc-本章小結" class="nav-link" data-scroll-target="#本章小結"><span class="header-section-number">10.8</span> 本章小結</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/SCgeeker/lsj-book-zh_tw/edit/main/10-Categorical-data-analysis.qmd" class="toc-action">編輯本頁面</a></p><p><a href="https://github.com/SCgeeker/lsj-book-zh_tw/issues/new" class="toc-action">回報問題</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header">
<h1 class="title display-7"><span id="sec-Categorical-data-analysis" class="quarto-section-identifier"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">類別資料分析</span></span></h1>

</header>

<blockquote class="blockquote">
<p><strong>譯者註</strong> 20230417初步以ChatGPT-4完成翻譯，內容待編修。</p>
</blockquote>
<p>至此已經了解假設檢定的基本理論，是時候開始學習心理學研究常用的統計檢定方法。那麼應該從那種方法開始學習呢？並非所有教材作者都有共識，我(原作者)建議從“卡方檢定”（英文發音為“chi-square”<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>）和“t 檢定”（<a href="11-Comparing-two-means.html"><span>單元&nbsp;11</span></a>）開始。這兩種方法在科學研究實務經常被使用，雖然解析資料的威力不如後面單元介紹“迴歸分析”和“變異數分析”強大，對初學者來說相對容易理解。</p>
<p>“類別資料”（Categorical data）只是“名義尺度資料”（nominal scale data）的另一種稱呼。這不是本書尚未介紹的東西，只是在資料分析的場合，我不明白為何許多研究者習慣稱呼“類別資料”，而不是“名義尺度資料”。無論如何，<strong>類別資料分析</strong>是指處理名義尺度資料時，可以使用的一套統計方法。不過，專用於分析類別資料的方法非常多種，本單元僅介紹幾種較常用的方法。</p>
<!--- Now that we've covered the basic theory behind hypothesis testing it's time to start looking at specific tests that are commonly used in psychology. So where should we start? Not every textbook agrees on where to start, but I'm going to start with "$\chi^2$ tests" (this chapter, pronounced "chi-square"[^10-categorical-data-analysis-1] and "t-tests" in @sec-Comparing-two-means). Both of these tools are very frequently used in scientific practice, and whilst they're not as powerful as "regression" and "analysis of variance" which we cover in later chapters, they're much easier to understand.

[^10-categorical-data-analysis-1]: Also sometimes referred to as "chi-squared".

The term "categorical data" is just another name for "nominal scale data". It's nothing that we haven't already discussed, it's just that in the context of data analysis people tend to use the term "categorical data" rather than "nominal scale data". I don't know why. In any case, **categorical data analysis** refers to a collection of tools that you can use when your data are nominal scale. However, there are a lot of different tools that can be used for categorical data analysis, and this chapter covers only a few of the more common ones. --->
<section id="卡方適合度檢定" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="卡方適合度檢定"><span class="header-section-number">10.1</span> 卡方適合度檢定</h2>
<p>卡方適合度檢定(goodness-of-fit test)是統計學者們最早開發出來的假設檢定方法之一。主要發明者是20世紀初的統計學者卡爾．皮爾森( Karl Pearson , 皮爾森相關係數以他的名字命名) <span class="citation" data-cites="Pearson1900">(<a href="References.html#ref-Pearson1900" role="doc-biblioref">Pearson, 1900</a>)</span>，之後羅納德·費雪爵士(Sir Ronald Fisher) <span class="citation" data-cites="Fisher1922a">(<a href="References.html#ref-Fisher1922a" role="doc-biblioref">Fisher, 1922</a>)</span> 做了一些改良，這個方法是檢定名義變項的觀察次數分佈是否符合預期次數分佈。像是有一組病人接受了實驗性治療，根據治療後的健康狀況分類，醫師紀錄病情是否有改善、保持不變或惡化，接著使用適合度檢定可以確定每個類別的人次，是否匹配標準治療後的預期人次。以下用一些心理學研究案例學習如何使用卡方適合度檢定。</p>
<!--- The $\chi^2$ goodness-of-fit test is one of the oldest hypothesis tests around. It was invented by Karl Pearson around the turn of the century [@Pearson1900], with some corrections made later by Sir Ronald Fisher [@Fisher1922a]. It tests whether an observed frequency distribution of a nominal variable matches an expected frequency distribution. For example, suppose a group of patients has been undergoing an experimental treatment and have had their health assessed to see whether their condition has improved, stayed the same or worsened. A goodness-of-fit test could be used to determine whether the numbers in each category - improved, no change, worsened - match the numbers that would be expected given the standard treatment option. Let's think about this some more, with some psychology. --->
<section id="撲克牌花色隨機選擇資料" class="level3" data-number="10.1.1">
<h3 data-number="10.1.1" class="anchored" data-anchor-id="撲克牌花色隨機選擇資料"><span class="header-section-number">10.1.1</span> 撲克牌花色隨機選擇資料</h3>
<p>過去幾十年許多人類模擬隨機現象的研究顯示，這是人類很難學成的能力。雖然每個人或多或少會試表“隨機行動”，依照模式和結構進行思考仍然是一般人難以擺脫的習慣，就算是被要求“隨機做某件事情”，實際上完全無法隨機行事，所以這類研究反過來揭露了許多人類的非隨機行為，其中透露我們如何看待世界的深刻心理問題。這一節的範例啟發自隨機行為研究，以此虛構一個非常簡單的研究。假如研究人員要求參與者想像一副已經洗好的撲克牌，然後從這副牌裡“隨機”選出一張牌。參與者選好想像中的牌之後，再選出第二張牌。參與者選擇好之後，再請他們說出選擇的花色（紅心、梅花、黑桃或方塊）。假如這個研究最後收集了 <span class="math inline">\(N = 200\)</span> 個人選出的牌，研究人員想分析資料，確認一般人假裝選擇的撲克牌是否真的隨機。這份資料存在lsj檔案庫的 <em>Randomness</em> ，當讀者從 jamovi 的lsj檔案庫開啟這份資料的試算表，會看到三個變項：為每個參與者分配辨識碼<code>id</code> ，以及紀錄每個人先後選出的兩種撲克牌花色 <code>choice_1</code> 和 <code>choice_2</code>。</p>
<p>現在先看參與者第一次選擇的花色。開啟“Explore” - “Descriptives”的設定視窗，點選<code>Frequency table</code>選項計算每個花色被參與者們選擇的次數。得到的結果就如同 <a href="#tbl-tab14-1">表&nbsp;<span>10.1</span></a> ：</p>

<!--- Over the years there have been many studies showing that humans find it difficult to simulate randomness. Try as we might to "act" random, we think in terms of patterns and structure and so, when asked to "do something at random", what people actually do is anything but random. As a consequence, the study of human randomness (or non-randomness, as the case may be) opens up a lot of deep psychological questions about how we think about the world. With this in mind, let's consider a very simple study. Suppose I asked people to imagine a shuffled deck of cards, and mentally pick one card from this imaginary deck "at random". After they've chosen one card I ask them to mentally select a second one. For both choices what we're going to look at is the suit (hearts, clubs, spades or diamonds) that people chose. After asking, say, $N = 200$ people to do this, I'd like to look at the data and figure out whether or not the cards that people pretended to select were really random. The data are contained in the *randomness.csv* file in which, when you open it up in jamovi and take a look at the spreadsheet view, you will see three variables. These are: an id variable that assigns a unique identifier to each participant, and the two variables choice_1 and choice_2 that indicate the card suits that people chose.

For the moment, let's just focus on the first choice that people made. We'll use the Frequency tables option under 'Exploration' - 'Descriptives' to count the number of times that we observed people choosing each suit. This is what we get (@tbl-tab14-1): --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab14-1" class="anchored">
<table id="tab:tbl-tab14-1" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表&nbsp;10.1: 的第一次選擇撲克牌花色的次數紀錄</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;">clubs</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">diamonds</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">hearts</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">spades</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">35</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">51</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">64</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">50</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>這份小小的次數表非常有用。其中數字似乎暗示，參與者們可能偏好選擇紅心而且比較不想選擇梅花。只看表面數字並不能判斷這樣的差距是不是巧合，因此需要進行統計分析來找出答案，這就是下一節要學習的功課。</p>
<p>沒問題的話，接下來要分析 <a href="#tbl-tab14-1">表&nbsp;<span>10.1</span></a> 的資料囉。然後，這裡開始不得不用些數學符號討論這些資料，所以最好先認識一下每個符號的意義。首先是至目前為止一直提到“觀察值”，將用大寫字母<span class="math inline">\(O\)</span>，而字母的下標表示觀察值在表格裡的位置。像是 <a href="#tbl-tab14-1">表&nbsp;<span>10.1</span></a> 的第二個觀察值可寫為<span class="math inline">\(O_2\)</span>。<a href="#tbl-tab14-2">表&nbsp;<span>10.2</span></a> 說明每個花色的報告次數與代表符號之間的對應 。</p>

<!--- That little frequency table is quite helpful. Looking at it, there's a bit of a hint that people might be more likely to select hearts than clubs, but it's not completely obvious just from looking at it whether that's really true, or if this is just due to chance. So we'll probably have to do some kind of statistical analysis to find out, which is what I'm going to talk about in the next section.

Excellent. From this point on, we'll treat this table as the data that we're looking to analyse. However, since I'm going to have to talk about this data in mathematical terms (sorry!) it might be a good idea to be clear about what the notation is. In mathematical notation, we shorten the human-readable word "observed" to the letter $O$, and we use subscripts to denote the position of the observation. So the second observation in our table is written as $O_2$ in maths. The relationship between the English descriptions and the mathematical symbols are illustrated in @tbl-tab14-2. --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab14-2" class="anchored">
<table id="tab:tbl-tab14-2" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表&nbsp;10.2: 英語描述與數學符號之間的關係</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;">label</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">index, i</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">math. symbol</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">the value</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">clubs, \( \clubsuit \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( O_1 \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">35</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">diamonds, \( \diamondsuit \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">2</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( O_2 \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">51</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">hearts, \( \heartsuit \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">3</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( O_3 \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">64</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">spades, \( \spadesuit \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">4</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( O_4 \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">50</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>希望這樣整理能讓你搞清楚。同時提醒一下，數學家更喜歡談論一般事物而不是具體事物，因此接著會一直看到<span class="math inline">\(O_i\)</span>之類的符號，這是指在第 i 類別的觀察次數（其中 i 可能是 1，2，3 或 4）。最後，如果我們要在報告裡提及所有觀察次數，統計學家習慣將所有觀察值構成一個向量 <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>，本書稱為 <span class="math inline">\(O\)</span>。</p>
<p><span class="math display">\[O = (O_1, O_2, O_3, O_4)\]</span></p>
<p>同樣的，這裡沒有什麼新奇有趣之處，一切只是符號。如果說 <span class="math inline">\(O = (35, 51, 64, 50)\)</span>，就只是將描述觀察值的次數表，改用數學符號來表示而已。</p>

<!--- Hopefully that's pretty clear. It's also worth noting that mathematicians prefer to talk about general rather than specific things, so you'll also see the notation $O_i$, which refers to the number of observations that fall within the i-th category (where i could be 1, 2, 3 or 4). Finally, if we want to refer to the set of all observed frequencies, statisticians group all observed values into a vector [^10-categorical-data-analysis-2], which I'll refer to as $O$.

[^10-categorical-data-analysis-2]: A vector is a sequence of data elements of the same basic type.

$$O = (O_1, O_2, O_3, O_4)$$

Again, this is nothing new or interesting. It's just notation. If I say that $O = (35, 51, 64, 50)$ all I'm doing is describing the table of observed frequencies (i.e., observed), but I'm referring to it using mathematical notation. --->
</section>
<section id="虛無假設與對立假設" class="level3" data-number="10.1.2">
<h3 data-number="10.1.2" class="anchored" data-anchor-id="虛無假設與對立假設"><span class="header-section-number">10.1.2</span> 虛無假設與對立假設</h3>
<p>正如一開始的範例說明，研究者的假設是“一般人不會隨機選出想像中的撲克牌”。接著要做的是將這樣的假設說法，轉換為兩道統計假設，然後建構檢定這些統計假設的統計方法。這個範例需要的統計方法就是需要使用這一節要學習<strong>皮爾森 <span class="math inline">\(\chi^2\)</span> </strong>適合度檢定，建構適合度檢定的第一步是設定虛無假設，撲克牌範例的虛無假設是很簡單地。我們先用文字說明虛無假設：</p>
<p><span class="math display">\[H_0: \text{ 四種花色被選擇的機率相等}\]</span></p>
<p>在統計學課程，讀者要學習的項目之一是用數學表達虛無假設，這裡使用 <span class="math inline">\(P_j\)</span> 表示第j種花色被參與者 選擇的真實機率。如果研究結果符合虛無假設，那麼任何一種花色都有 25% 的機率被選中。換句話說，以上的虛無假設說明用數學符號表達的方式是<span class="math inline">\(P_1 = .25\)</span>，<span class="math inline">\(P_2 = .25\)</span>，<span class="math inline">\(P_3 = .25\)</span>， <span class="math inline">\(P_4 = .25\)</span>。然後，因為統計學者習慣用向量符號涵括同一個變項的資料，在此用P表示虛無假設涵括的所有機率事件。也就是向量 <span class="math inline">\(P = (P_1, P_2, P_3, P_4)\)</span> 表示虛無假設的機率事件集合，這麼一來可將虛無假設寫成：</p>
<p><span class="math display">\[H_0: P =(.25, .25, .25, .25)\]</span></p>
<p>這個範例的虛無假設對應機率向量 P，涵括的所有事件發生機率剛好相等，不過真實的研究條件不一定會是這樣。如同這個範例的實驗任務是讓參與者從想像中的一副撲克牌抽一張，若是這副牌的梅花數量是其他花色的兩倍，那麼虛無假設就要寫成<span class="math inline">\(P = (.4, .2, .2, .2)\)</span>。只要機率值都是正數，且總和為 1，這樣的向量就是合法的虛無假設。因為許多使用適合度檢定的場景，是用來對付所有類別事件發生機率相等的虛無假設，以下討論繼續使用四種花色被選擇機率相等的虛無假設。</p>
<p>那麼對立假設 <span class="math inline">\(H_1\)</span>是什麼呢？這則統計假設表示研究者感興趣的研究結果，也就是認為參與者的選擇不是完全隨機，因此四種花色的發生機率並不相等。所以兩則統計假設的白話版本看起來像這樣：</p>
<p><span class="math inline">\(H_0: \text{ 四種花色被選擇的機率相等}\)</span> <span class="math inline">\(H_1: \text{ 至少有一個選擇花色的機率不是 0.25}\)</span></p>
<p>…或者可寫成“數學家偏好的”版本：</p>
<!--- As the last section indicated, our research hypothesis is that "people don't choose cards randomly". What we're going to want to do now is translate this into some statistical hypotheses and then construct a statistical test of those hypotheses. The test that I'm going to describe to you is **Pearson's** $\chi^2$ (chi-square) goodness-of-fit test, and as is so often the case we have to begin by carefully constructing our null hypothesis. In this case, it's pretty easy. First, let's state the null hypothesis in words:

$$H_0: \text{ All four suits are chosen with equal probability}$$

Now, because this is statistics, we have to be able to say the same thing in a mathematical way. To do this, let's use the notation $P_j$ to refer to the true probability that the j-th suit is chosen. If the null hypothesis is true, then each of the four suits has a 25% chance of being selected. In other words, our null hypothesis claims that $P_1 = .25$, $P_2 = .25$, $P3 = .25$ and finally that $P_4 = .25$ . However, in the same way that we can group our observed frequencies into a vector O that summarises the entire data set, we can use P to refer to the probabilities that correspond to our null hypothesis. So if I let the vector $P = (P_1, P_2, P_3, P_4)$ refer to the collection of probabilities that describe our null hypothesis, then we have:

$$H_0: P =(.25, .25, .25, .25)$$

In this particular instance, our null hypothesis corresponds to a vector of probabilities P in which all of the probabilities are equal to one another. But this doesn't have to be the case. For instance, if the experimental task was for people to imagine they were drawing from a deck that had twice as many clubs as any other suit, then the null hypothesis would correspond to something like $P = (.4, .2, .2, .2)$. As long as the probabilities are all positive numbers, and they all sum to 1, then it's a perfectly legitimate choice for the null hypothesis. However, the most common use of the goodness-of-fit test is to test a null hypothesis that all of the categories are equally likely, so we'll stick to that for our example.

What about our alternative hypothesis, $H_1$? All we're really interested in is demonstrating that the probabilities involved aren't all identical (that is, people's choices weren't completely random). As a consequence, the "human friendly" versions of our hypotheses look like this:

$H_0: \text{ All four suits are chosen with equal probability}$
$H_1: \text{ At least one of the suit-choice probabilities isn’t 0.25}$

...and the "mathematician friendly" version is: --->
<p><span class="math inline">\(H_0: P= (.25, .25, .25, .25)\)</span> <span class="math inline">\(H_1: P \neq (.25, .25, .25, .25)\)</span></p>
</section>
<section id="適合度檢定統計程序" class="level3" data-number="10.1.3">
<h3 data-number="10.1.3" class="anchored" data-anchor-id="適合度檢定統計程序"><span class="header-section-number">10.1.3</span> 適合度檢定統計程序</h3>
<p>在此階段，我們有我們觀察到的頻率 O 和一組與我們要測試的虛無假設相對應的機率 P。我們現在要做的是構造一個虛無假設的檢驗。與往常一樣，如果我們想要檢驗 <span class="math inline">\(H_0\)</span> 和 <span class="math inline">\(H_1\)</span>，我們將需要一個檢驗統計量。適合度檢驗所使用的基本技巧是構造一個檢驗統計量，用來衡量資料與虛無假設之間的“接近度”。如果資料與虛無假設為真時所期望的情況不相符，那麼它可能不是真的。好吧，如果虛無假設是真的，我們會看到什麼呢？或者，使用正確的術語，這些是什麼<strong>期望頻率</strong>。總共有 <span class="math inline">\(N = 200\)</span> 次觀察，並且（如果虛無假設為真），任何一個選擇紅心的機率是 <span class="math inline">\(P_3 = .25\)</span>，所以我猜我們期望 <span class="math inline">\(200 \times .25 = 50\)</span> 顆紅心，對吧？或者，更具體地說，如果我們讓 Ei 指的是“在虛無假設為真時，我們期望觀察到的第 i 類反應的數量”，那麼</p>
<p><span class="math display">\[E_i=N \times P_i\]</span></p>
<p>這非常容易計算。如果有 200 個觀察可以分為四個類別，我們認為所有四個類別的可能性相等，那麼平均每個類別應該有 50 個觀察，對吧？</p>
<p>那麼，我們如何將這個轉換為檢驗統計量呢？顯然，我們要做的是比較每個類別的期望觀察數量（<span class="math inline">\(E_i\)</span>）與該類別的實際觀察數量（<span class="math inline">\(O_i\)</span>）。基於這種比較，我們應該能夠得出一個好的檢驗統計量。首先，讓我們計算虛無假設期望我們找到的數量和我們實際找到的數量之間的差異，也就是，我們計算“觀察到的值減去期望值”的差分數，<span class="math inline">\(O_i - E_i\)</span>。這在 <a href="#tbl-tab14-3">表&nbsp;<span>10.3</span></a> 中說明。</p>
<!--- At this point, we have our observed frequencies O and a collection of probabilities P corresponding to the null hypothesis that we want to test. What we now want to do is construct a test of the null hypothesis. As always, if we want to test $H_0$ against $H_1$, we're going to need a test statistic. The basic trick that a goodness-of-fit test uses is to construct a test statistic that measures how "close" the data are to the null hypothesis. If the data don't resemble what you'd "expect" to see if the null hypothesis were true, then it probably isn't true. Okay, if the null hypothesis were true, what would we expect to see? Or, to use the correct terminology, what are the **expected frequencies**. There are $N = 200$ observations, and (if the null is true) the probability of any one of them choosing a heart is $P_3 = .25$, so I guess we're expecting $200 \times .25 = 50$ hearts, right? Or, more specifically, if we let Ei refer to "the number of category i responses that we're expecting if the null is true", then

$$E_i=N \times P_i$$

This is pretty easy to calculate.If there are 200 observations that can fall into four categories, and we think that all four categories are equally likely, then on average we'd expect to see 50 observations in each category, right?

Now, how do we translate this into a test statistic? Clearly, what we want to do is compare the expected number of observations in each category ($E_i$) with the observed number of observations in that category ($O_i$). And on the basis of this comparison we ought to be able to come up with a good test statistic. To start with, let's calculate the difference between what the null hypothesis expected us to find and what we actually did find. That is, we calculate the "observed minus expected" difference score, $O_i - E_i$ . This is illustrated in @tbl-tab14-3. --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab14-3" class="anchored">
<table id="tab:tbl-tab14-3" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表&nbsp;10.3: 預期和觀察到的頻率</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;"></td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">\( \clubsuit \)</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">\( \diamondsuit \)</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">\( \heartsuit \)</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">\( \spadesuit \)</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">expected frequency \( E_i\)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">50</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">50</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">50</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">50</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">observed frequency \( O_i\)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">35</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">51</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">64</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">50</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">difference score \( O_i-E_i\)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">-15</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">14</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>因此，根據我們的計算，顯然人們選擇紅心的次數比虛無假設預測的多，而選擇梅花的次數則少。然而，稍作思考便會發現，這些原始差異並非我們所尋求的。直覺上，當虛無假設預測觀察次數過少（就像紅心那樣）時，它與預測觀察次數過多（就像梅花那樣）一樣糟糕。因此，對於梅花有負數，對於紅心有正數有點奇怪。解決這個問題的一個簡單方法是將所有數字平方，這樣我們現在就可以計算平方差，<span class="math inline">\((E_i - O_i)^2\)</span>。就像以前一樣，我們可以手工計算（<a href="#tbl-tab14-4">表&nbsp;<span>10.4</span></a>）。</p>
<!--- So, based on our calculations, it's clear that people chose more hearts and fewer clubs than the null hypothesis predicted. However, a moment's thought suggests that these raw differences aren't quite what we're looking for. Intuitively, it feels like it's just as bad when the null hypothesis predicts too few observations (which is what happened with hearts) as it is when it predicts too many (which is what happened with clubs). So it's a bit weird that we have a negative number for clubs and a positive number for hearts. One easy way to fix this is to square everything, so that we now calculate the squared differences, $(E_i - O_i)^2$ . As before, we can do this by hand (@tbl-tab14-4). --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab14-4" class="anchored">
<table id="tab:tbl-tab14-4" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表&nbsp;10.4: 將差異得分平方</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;">\( \clubsuit \)</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">\( \diamondsuit \)</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">\( \heartsuit \)</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">\( \spadesuit \)</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">225</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">196</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>現在我們取得了進展。現在我們有了一組數字，在虛無假設做出糟糕預測時（梅花和紅心），數字很大，但在做出好的預測時（方塊和黑桃），數字很小。接下來，由於我將在稍後解釋的一些技術原因，讓我們也將這些數字除以期望頻率 Ei，因此我們實際上計算的是 <span class="math inline">\(\frac{(E_i-O_i)^2}{E_i}\)</span>。由於我們例子中所有類別的 <span class="math inline">\(E_i = 50\)</span>，所以這不是一個非常有趣的計算，但無論如何，讓我們這麼做（<a href="#tbl-tab14-5">表&nbsp;<span>10.5</span></a>）。</p>
<!--- Now we're making progress. What we've got now is a collection of numbers that are big whenever the null hypothesis makes a bad prediction (clubs and hearts), but are small whenever it makes a good one (diamonds and spades). Next, for some technical reasons that I'll explain in a moment, let's also divide all these numbers by the expected frequency Ei , so we're actually calculating $\frac{(E_i-O_i)^2}{E_i}$ . Since $E_i = 50$ for all categories in our example, it's not a very interesting calculation, but let's do it anyway (@tbl-tab14-5). -->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab14-5" class="anchored">
<table id="tab:tbl-tab14-5" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表&nbsp;10.5: 將平方差異得分除以期望頻率以提供一個’誤差’得分</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;">\( \clubsuit \)</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">\( \diamondsuit \)</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">\( \heartsuit \)</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">\( \spadesuit \)</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">4.50</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.02</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">3.92</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.00</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>實際上，我們在這裡得到的是四個不同的“誤差”得分，每個都告訴我們在嘗試用虛無假設預測我們的觀察頻率時，空假設所犯的“錯誤”有多大。因此，為了將其轉換為有用的檢驗統計量，我們可以做的一件事就是將這些數字加起來。結果被稱為<strong>適合度</strong>統計量，通常表示為 <span class="math inline">\(\chi^2\)</span>（卡方）或 GOF。我們可以像 <a href="#tbl-tab14-6">表&nbsp;<span>10.6</span></a> 中那樣計算它。</p>
<p><span class="math display">\[\sum( (observed - expected)^2 / expected )\]</span></p>
<p>這給了我們一個 8.44 的值。</p>
<p>[額外的技術細節 <a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>]</p>
<p>如我們從計算中看到的，在我們的卡片資料集中，我們得到了一個 <span class="math inline">\(\chi^2\)</span> = 8.44 的值。那麼現在的問題是，這個值是否足夠大以拒絕虛無假設？</p>
<!--- In effect, what we've got here are four different "error" scores, each one telling us how big a "mistake" the null hypothesis made when we tried to use it to predict our observed frequencies. So, in order to convert this into a useful test statistic, one thing we could do is just add these numbers up. The result is called the **goodness-of-fit** statistic, conventionally referred to either as $\chi^2$ (chi-square) or GOF. We can calculate it as in @tbl-tab14-6.

$$\sum( (observed - expected)^2 / expected )$$

This gives us a value of 8.44.

[Additional technical detail [^10-categorical-data-analysis-3]]

[^10-categorical-data-analysis-3]: If we let k refer to the total number of categories (i.e., k = 4 for our cards data), then the $\chi^2$ statistic is given by: $$\chi^2 = \sum_{i=1}^{k} \frac{(O_i-E_i)^2}{E_i}$$ Intuitively, it's clear that if $chi^2$ is small, then the observed data Oi are very close to what the null hypothesis predicted $E_i$, so we're going to need a large $\chi^2$ statistic in order to reject the null.

As we've seen from our calculations, in our cards data set we've got a value of $\chi^2$ = 8.44. So now the question becomes is this a big enough value to reject the null? --->
</section>
<section id="適合度檢定的樣本分佈" class="level3" data-number="10.1.4">
<h3 data-number="10.1.4" class="anchored" data-anchor-id="適合度檢定的樣本分佈"><span class="header-section-number">10.1.4</span> 適合度檢定的樣本分佈</h3>
<p>要確定某個 <span class="math inline">\(\chi^2\)</span> 值是否足夠大，以便拒絕虛無假設，我們需要確定如果虛無假設為真，<span class="math inline">\(\chi^2\)</span> 的抽樣分佈會是什麼。因此，在本節中我將做的就是這件事。我將詳細向您展示這個抽樣分佈的構建方式，然後在下一節中使用它構建一個假設檢驗。如果你想跳過本節的其他部分，並且願意相信抽樣分佈是具有 <span class="math inline">\(k - 1\)</span> 自由度的 <span class="math inline">\(\chi^2\)</span>（卡方）分佈，你可以跳過本節的其他部分。然而，如果您想了解<em>為什麼</em>適合度檢驗的工作方式是這樣的，請繼續閱讀。</p>
<p>好吧，讓我們假設虛無假設實際上是真的。如果是這樣，那麼觀察值落入第 i 類的真實機率是 <span class="math inline">\(P_i\)</span>。畢竟，這幾乎就是我們的虛無假設的定義。讓我們思考一下這實際上意味著什麼。這有點像說“自然”通過翻轉一個加權硬幣（即，得到正面的機率是 <span class="math inline">\(P_j\)</span> ）來決定觀察值是否最終落入第 i 類。因此，我們可以將觀察到的頻率 <span class="math inline">\(O_i\)</span> 想像成自然界翻轉了 N 個這樣的硬幣（資料集中每個觀察值各有一個），並且其中正好 <span class="math inline">\(O_i\)</span> 個硬幣是正面朝上。顯然，這是一種非常奇怪的思考實驗的方式。但是，這樣做（希望）是提醒你我們之前其實已經見過這種情景。這與 <a href="07-Introduction-to-probability.html"><span>單元&nbsp;7</span></a> 中 <a href="07-Introduction-to-probability.html#sec-The-binomial-distribution"><span>小單元&nbsp;7.4</span></a> 部分所提到的設置完全相同。換句話說，如果虛無假設是真的，那麼我們的觀察頻率是由抽樣自二項分佈生成的：</p>
<p><span class="math display">\[O_i \sim Binomial(P_i,N) \]</span></p>
<p>現在，如果您還記得我們對 <a href="08-Estimating-unknown-quantities-from-a-sample.html#sec-The-central-limit-theorem"><span>小單元&nbsp;8.3.3</span></a> 限定定理的討論，特別是當 <span class="math inline">\(N\)</span> 較大且 <span class="math inline">\(P_i\)</span> 與 0 或 1 不太接近時，二項分佈看起來幾乎與正態分佈相同。換句話說，只要 <span class="math inline">\(N^P_i\)</span> 足夠大。或者，換句話說，當期望頻率 Ei 足夠大時，<span class="math inline">\(O_i\)</span> 的理論分佈近似為正態分佈。更好的是，如果 <span class="math inline">\(O_i\)</span> 是正態分佈的，那麼 <span class="math inline">\((O_i-E_i)/\sqrt{(E_i)}\)</span> 也是正態分佈的。因為 <span class="math inline">\(E_i\)</span> 是一個固定值，所以減去 Ei 並除以？ Ei 改變了正態分佈的均值和標準差，但這就是它所做的全部。好吧，現在讓我們看看我們的適合度統計量實際上是什麼。我們正在做的是取一堆近似正態分佈的東西，將它們平方，然後加起來。等等。我們之前也見過這個！正如我們在談論@sec-Other-useful-distributions時所討論的那樣，當您取一堆具有標準正態分佈（即，均值為 0 且標準差為 1）的東西，將它們平方然後加起來時，所得到的數量具有卡方分佈。所以現在我們知道了虛無假設預測適合度統計量的抽樣分佈是卡方分佈。很酷。</p>
<p>還有一個最後的細節要談論，即自由度。如果您回想一下@sec-Other-useful-distributions，我說過如果你加起來的東西數量是 k，那麼生成的卡方分佈的自由度就是 k。然而，在本節開始時我所說的是，卡方適合度檢驗的實際自由度是 <span class="math inline">\(k - 1\)</span>。這是怎麼回事呢？答案在於，我們應該考慮的是被加在一起的真正獨立的東西數量。正如我將在下一節中談論的那樣，儘管我們加起來有 k 個東西，但只有 <span class="math inline">\(k - 1\)</span> 個東西是真正獨立的，所以自由度實際上只有 <span class="math inline">\(k - 1\)</span>。這就是下一節的主題<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>。</p>
<!--- To determine whether or not a particular value of $\chi^2$ is large enough to justify rejecting the null hypothesis, we're going to need to figure out what the sampling distribution for $\chi^2$ would be if the null hypothesis were true. So that's what I'm going to do in this section. I'll show you in a fair amount of detail how this sampling distribution is constructed, and then, in the next section, use it to build up a hypothesis test. If you want to cut to the chase and are willing to take it on faith that the sampling distribution is a $\chi^2$ (chi-square) distribution with $k - 1$ degrees of freedom, you can skip the rest of this section. However, if you want to understand *why* the goodness-of-fit test works the way it does, read on.

Okay, let's suppose that the null hypothesis is actually true. If so, then the true probability that an observation falls in the i-th category is $P_i$ . After all, that's pretty much the definition of our null hypothesis. Let's think about what this actually means. This is kind of like saying that "nature" makes the decision about whether or not the observation ends up in category i by flipping a weighted coin (i.e., one where the probability of getting a head is $P_j$ ). And therefore we can think of our observed frequency $O_i$ by imagining that nature flipped N of these coins (one for each observation in the data set), and exactly $O_i$ of them came up heads. Obviously, this is a pretty weird way to think about the experiment. But what it does (I hope) is remind you that we've actually seen this scenario before. It's exactly the same set up that gave rise to @sec-The-binomial-distribution in @sec-Introduction-to-probability. In other words, if the null hypothesis is true, then it follows that our observed frequencies were generated by sampling from a binomial distribution:

$$O_i \sim Binomial(P_i,N) $$

Now, if you remember from our discussion of @sec-The-central-limit-theorem the binomial distribution starts to look pretty much identical to the normal distribution, especially when $N$ is large and when $P_i$ isn't too close to 0 or 1. In other words as long as $N^P_i$ is large enough. Or, to put it another way, when the expected frequency Ei is large enough then the theoretical distribution of $O_i$ is approximately normal. Better yet, if $O_i$ is normally distributed, then so is $(O_i-E_i)/\sqrt{(E_i)}$ . Since $E_i$ is a fixed value, subtracting off Ei and dividing by ? Ei changes the mean and standard deviation of the normal distribution but that's all it does. Okay, so now let's have a look at what our goodness-of-fit statistic actually is. What we're doing is taking a bunch of things that are normally-distributed, squaring them, and adding them up. Wait. We've seen that before too! As we discussed in the section on @sec-Other-useful-distributions, when you take a bunch of things that have a standard normal distribution (i.e., mean 0 and standard deviation 1), square them and then add them up, the resulting quantity has a chi-square distribution. So now we know that the null hypothesis predicts that the sampling distribution of the goodness-of-fit statistic is a chi-square distribution. Cool.

There's one last detail to talk about, namely the degrees of freedom. If you remember back to @sec-Other-useful-distributions, I said that if the number of things you're adding up is k, then the degrees of freedom for the resulting chi-square distribution is k. Yet, what I said at the start of this section is that the actual degrees of freedom for the chi-square goodness-of-fit test is $k - 1$. What's up with that? The answer here is that what we're supposed to be looking at is the number of genuinely independent things that are getting added together. And, as I'll go on to talk about in the next section, even though there are k things that we're adding only $k - 1$ of them are truly independent, and so the degrees of freedom is actually only $k - 1$. That's the topic of the next section[^10-categorical-data-analysis-4].

[^10-categorical-data-analysis-4]: If you rewrite the equation for the goodness-of-fit statistic as a sum over k - 1 independent things you get the "proper" sampling distribution, which is chi-square with k - 1 degrees of freedom. It's beyond the scope of an introductory book to show the maths in that much detail. All I wanted to do is give you a sense of why the goodness-of-fit statistic is associated with the chi-square distribution. --->
</section>
<section id="自由度" class="level3" data-number="10.1.5">
<h3 data-number="10.1.5" class="anchored" data-anchor-id="自由度"><span class="header-section-number">10.1.5</span> 自由度</h3>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-1" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="10-Categorical-data-analysis_files/figure-html/fig-fig14-1-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">圖&nbsp;10.1: 卡方分佈具有不同“自由度”值</figcaption>
</figure>
</div>
</div>
</div>
<p>當我在@sec-Other-useful-distributions中介紹卡方分佈時，對於<strong>“自由度”</strong>的含義有點籠統。顯然，它很重要。觀察@fig-fig14-1，可以看到如果我們改變自由度，那麼卡方分佈的形狀會發生很大變化。但它究竟是什麼呢？同樣，當我介紹分佈並解釋它與正態分佈的關係時，我確實提供了一個答案：它是我要平方並相加的“正態分布變項”的數量。但是，對於大多數人來說，這有點抽象，並不十分有幫助。我們真正需要做的是嘗試根據我們的資料來理解自由度。下面就讓我們開始吧。</p>
<p>自由度背後的基本概念非常簡單。您計算它的方法是將描述資料的不同“數量”加起來，然後減去這些資料必須滿足的所有“約束”。<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>這有點籠統，所以讓我們用我們的撲克牌資料作為一個具體例子。我們使用四個數字來描述我們的資料，分別是 <span class="math inline">\(O1, O2, O3\)</span> 和 <span class="math inline">\(O4\)</span>，對應於四個不同類別（紅心，梅花，方塊，黑桃）的觀察頻率。這四個數字是我們實驗的隨機結果。但是我的實驗實際上內置了一個固定的約束：樣本大小 <span class="math inline">\(N\)</span>。<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>也就是說，如果我們知道</p>
<p>有多少人選擇紅心，有多少人選擇方塊，以及有多少人選擇梅花，那麼我們就能確切地知道有多少人選擇黑桃。換句話說，雖然我們的資料是用四個數字描述的，但它們實際上只對應於 <span class="math inline">\(4 - 1 = 3\)</span> 个自由度。稍微不同的思考方式是注意到我們感興趣的四個機率（同樣，對應於四個不同類別），但是這些機率必須加起來等於一，這將施加一個約束。因此，自由度是 <span class="math inline">\(4 - 1 = 3\)</span>。無論您想用觀察頻率還是機率的方式來思考它，答案都是一樣的。通常，當進行涉及 <span class="math inline">\(k\)</span> 個組的卡方適合度檢定時，自由度將為 <span class="math inline">\(k - 1\)</span>。</p>
<!--- When I introduced the chi-square distribution in @sec-Other-useful-distributions, I was a bit vague about what **"degrees of freedom"** actually means. Obviously, it matters. Looking at @fig-fig14-1, you can see that if we change the degrees of freedom then the chi-square distribution changes shape quite substantially. But what exactly is it? Again, when I introduced the distribution and explained its relationship to the normal distribution, I did offer an answer: it's the number of "normally distributed variables" that I'm squaring and adding together. But, for most people, that's kind of abstract and not entirely helpful. What we really need to do is try to understand degrees of freedom in terms of our data. So here goes.

The basic idea behind degrees of freedom is quite simple. You calculate it by counting up the number of distinct "quantities" that are used to describe your data and then subtracting off all of the "constraints" that those data must satisfy.[^10-categorical-data-analysis-5] This is a bit vague, so let's use our cards data as a concrete example. We describe our data using four numbers, $O1, O2, O3$ and O4 corresponding to the observed frequencies of the four different categories (hearts, clubs, diamonds, spades). These four numbers are the random outcomes of our experiment. But my experiment actually has a fixed constraint built into it: the sample size $N$. [^10-categorical-data-analysis-6] That is, if we know

[^10-categorical-data-analysis-5]: I feel obliged to point out that this is an over-simplification. It works nicely for quite a few situations, but every now and then we'll come across degrees of freedom values that aren't whole numbers. Don't let this worry you too much; when you come across this just remind yourself that "degrees of freedom" is actually a bit of a messy concept, and that the nice simple story that I'm telling you here isn't the whole story. For an introductory class it's usually best to stick to the simple story, but I figure it's best to warn you to expect this simple story to fall apart. If I didn't give you this warning you might start getting confused when you see $df = 3.4$ or something, (incorrectly) thinking that you had misunderstood something that I've taught you rather than (correctly) realising that there's something that I haven't told you.

[^10-categorical-data-analysis-6]: In practice, the sample size isn't always fixed. For example, we might run the experiment over a fixed period of time and the number of people participating depends on how many people show up. That doesn't matter for the current purposes

how many people chose hearts, how many chose diamonds and how many chose clubs, then we'd be able to figure out exactly how many chose spades. In other words, although our data are described using four numbers, they only actually correspond to $4 - 1 = 3$ degrees of freedom. A slightly different way of thinking about it is to notice that there are four probabilities that we're interested in (again, corresponding to the four different categories), but these probabilities must sum to one, which imposes a constraint. Therefore the degrees of freedom is $4 - 1 = 3$. Regardless of whether you want to think about it in terms of the observed frequencies or in terms of the probabilities, the answer is the same. In general, when running the $\chi^2$(chi-square) goodness-of-fit test for an experiment involving $k$ groups, then the degrees of freedom will be $k - 1$. --->
</section>
<section id="檢定虛無假設" class="level3" data-number="10.1.6">
<h3 data-number="10.1.6" class="anchored" data-anchor-id="檢定虛無假設"><span class="header-section-number">10.1.6</span> 檢定虛無假設</h3>
<p>構建假設檢定的過程的最後一步是找出拒絕域是什麼。也就是說，哪些 <span class="math inline">\(\chi^2\)</span> 值會讓我們拒絕虛無假設。如我們之前所見，<span class="math inline">\(\chi^2\)</span> 的大值意味著虛無假設在預測我們實驗中的資料方面做得很差，而 <span class="math inline">\(\chi^2\)</span> 的小值則意味著它實際上做得相當好。因此，一個相當明智的策略是說，有一個臨界值，如果 <span class="math inline">\(\chi^2\)</span> 大於臨界值，我們拒絕虛無假設；但如果 <span class="math inline">\(\chi^2\)</span> 小於這個值，我們保留虛無假設。換句話說，用我們在 <a href="09-Hypothesis-testing.html"><span>單元&nbsp;9</span></a> 中引入的語言，卡方適合度檢定總是一個<strong>單邊檢定</strong>。好的，所以我們要做的就是找出這個臨界值。這很簡單。如果我們希望檢定具有顯著性水平 <span class="math inline">\(\alpha = .05\)</span>（即，我們願意容忍 Type I 錯誤率為 <span class="math inline">\(5%\)</span>），那麼我們必須選擇我們的臨界值，使得在虛無假設成立的情況下，<span class="math inline">\(\chi^2\)</span> 達到那麼大的機率只有 5%。這在 <a href="#fig-fig14-2">圖&nbsp;<span>10.2</span></a> 中得到了說明。</p>
<!--- The final step in the process of constructing our hypothesis test is to figure out what the rejection region is. That is, what values of $\chi^2$ would lead us to reject the null hypothesis. As we saw earlier, large values of $\chi^2$ imply that the null hypothesis has done a poor job of predicting the data from our experiment, whereas small values of $\chi^2$ imply that it's actually done pretty well. Therefore, a pretty sensible strategy would be to say there is some critical value such that if $\chi^2$ is bigger than the critical value we reject the null, but if $\chi^2$ is smaller than this value we retain the null. In other words, to use the language we introduced in @sec-Hypothesis-testing the chi-square goodness-of-fit test is always a **one-sided test**. Right, so all we have to do is figure out what this critical value is. And it's pretty straightforward. If we want our test to have significance level of $\alpha = .05$ (that is, we are willing to tolerate a Type I error rate of $5%$), then we have to choose our critical value so that there is only a 5% chance that $\chi^2$ could get to be that big if the null hypothesis is true. This is illustrated in @fig-fig14-2. --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-2" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="10-Categorical-data-analysis_files/figure-html/fig-fig14-2-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">圖&nbsp;10.2: <span class="math inline">\(\chi^2\)</span>（卡方）適合度檢定的假設檢定如何運作的示意圖</figcaption>
</figure>
</div>
</div>
</div>
<p>啊，但我聽到你問，如何找到具有 <span class="math inline">\(k-1\)</span> 自由度的卡方分布的臨界值？很多很多年前，當我第一次上心理統計課時，我們曾經在一本臨界值表的書中查找這些臨界值，就像 <a href="#fig-fig14-3">圖&nbsp;<span>10.3</span></a> 中那樣。看這個圖，我們可以看到具有 3 個自由度的 <span class="math inline">\(\chi^2\)</span> 分布的臨界值，且 p=0.05 是 7.815。</p>

<!-- Ah but, I hear you ask, how do I find the critical value of a chi-square distribution with $k-1$ degrees of freedom? Many many years ago when I first took a psychology statistics class we used to look up these critical values in a book of critical value tables, like the one in @fig-fig14-3. Looking at this Figure, we can see that the critical value for a $\chi^2$ distribution with 3 degrees of freedom, and p=0.05 is 7.815. --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-3" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig10-3.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">圖&nbsp;10.3: 卡方分布的臨界值表</figcaption>
</figure>
</div>
</div>
</div>
<p>因此，如果我們計算出的 <span class="math inline">\(\chi^2\)</span> 統計量大於 7.815 的臨界值，那麼我們可以拒絕虛無假設（記住，虛無假設 <span class="math inline">\(H_0\)</span> 是所有四個花色都以相等的機率被選擇）。既然我們之前已經計算過了（即，<span class="math inline">\(\chi^2\)</span> = 8.44），我們可以拒絕虛無假設。基本上就是這樣了。現在你知道了“皮爾森卡方適合度檢定”。真幸運。</p>
<!--- So, if our calculated $\chi^2$ statistic is bigger than the critical value of $7.815$, then we can reject the null hypothesis (remember that the null hypothesis, $H_0$, is that all four suits are chosen with equal probability). Since we actually already calculated that before (i.e., $\chi^2$ = 8.44) we can reject the null hypothesis. And that's it, basically. You now know "Pearson's $\chi^2$ test for the goodness-of-fit". Lucky you. --->
</section>
<section id="jamovi實作" class="level3" data-number="10.1.7">
<h3 data-number="10.1.7" class="anchored" data-anchor-id="jamovi實作"><span class="header-section-number">10.1.7</span> jamovi實作</h3>
<p>毫不意外地，jamovi 提供了一個分析工具，可以幫你完成這些計算。讓我們使用 <em>Randomness.omv</em> 文件。在主要的“分析”工具欄中，選擇“頻率” - “單樣本比例檢驗” - “<span class="math inline">\(N\)</span> 個結果”。然後在出現的分析視窗中將要分析的變項（從選擇 1 開始）移到“變項”框中。此外，單擊“預期計數”復選框，以便將這些資料顯示在結果表中。完成所有這些操作後，你應該會在 jamovi 中看到分析結果，如 <a href="#fig-fig14-4">圖&nbsp;<span>10.4</span></a>。然後不出所料，jamovi 提供了與我們上面手動計算相同的預期計數和統計資料，<span class="math inline">\(\chi^2\)</span> 值為 <span class="math inline">\((8.44\)</span>，自由度為 <span class="math inline">\(3\)</span>，<span class="math inline">\(p=0.038\)</span>。注意，我們不再需要查找臨界 p 值閾值，因為 jamovi 給出了在 <span class="math inline">\(3\)</span> 自由度下計算得出的 <span class="math inline">\(\chi^2\)</span> 的實際 p 值。</p>

<!--- Not surprisingly, jamovi provides an analysis that will do these calculations for you. Let's use the *Randomness.omv* file. From the main 'Analyses' toolbar select 'Frequencies' - 'One Sample Proportion Tests' - '$N$ Outcomes'. Then in the analysis window that appears move the variable you want to analyse (choice 1 across into the 'Variable' box. Also, click on the 'Expected counts' check box so that these are shown on the results table. When you have done all this, you should see the analysis results in jamovi as in @fig-fig14-4. No surprise then that jamovi provides the same expected counts and statistics that we calculated by hand above, with a $\chi^2$ value of $(8.44$ with $3$ d.f. and $p=0.038$. Note that we don't need to look up a critical p-value threshold value any more, as jamovi gives us the actual p-value of the calculated $\chi^2$ for $3$ d.f. --->
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-4" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig10-4.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">圖&nbsp;10.4: jamovi 中的 <span class="math inline">\(\chi^2\)</span> 單樣本比例檢驗，表格顯示觀察到的頻率和比例以及期望的頻率和比例</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="另一種虛無假設" class="level3" data-number="10.1.8">
<h3 data-number="10.1.8" class="anchored" data-anchor-id="另一種虛無假設"><span class="header-section-number">10.1.8</span> 另一種虛無假設</h3>
<p>此時，你可能會想知道如果你想進行適合度檢驗，但你的虛無假設不是所有類別的機率都相等該怎麼辦。例如，假設有人提出了這樣的理論預測，即人們應該以 <span class="math inline">\(60\%\)</span> 的機率選擇紅色牌，以 <span class="math inline">\(40\%\)</span> 的機率選擇黑色牌（我不知道為什麼你會這樣預測），但沒有其他偏好。如果是這樣，虛無假設將期望選擇愛心的比例為 <span class="math inline">\(30\%\)</span>，選擇方塊的比例為 <span class="math inline">\(30\%\)</span>，選擇黑桃的比例為 <span class="math inline">\(20\%\)</span>，選擇梅花的比例為 <span class="math inline">\(20\%\)</span>。換句話說，我們期望愛心和方塊的出現次數是黑桃和梅花的 1.5 倍（<span class="math inline">\(30\%\)</span> : <span class="math inline">\(20\%\)</span> 的比例與 1.5 : 1 相同）。對我來說，這似乎是一個愚蠢的理論，但是用我們的 jamovi 分析可以很容易地測試這個明確指定的虛無假設。在分析視窗中（標記為“比例檢驗（N個結果）”的 <a href="#fig-fig14-4">圖&nbsp;<span>10.4</span></a> 中，你可以展開“預期比例”的選項。當你這樣做時，將會出現一些選項，讓你為選定的變項輸入不同的比例值，在我們的案例中，這個變項是 choice 1。將比例更改為反映新的虛無假設，如 <a href="#fig-fig14-5">圖&nbsp;<span>10.5</span></a> 所示，並觀察結果如何變化。</p>
<!--- At this point you might be wondering what to do if you want to run a goodness-of-fit test but your null hypothesis is not that all categories are equally likely. For instance, let's suppose that someone had made the theoretical prediction that people should choose red cards $60\%$ of the time, and black cards $40\%$ of the time (I've no idea why you'd predict that), but had no other preferences. If that were the case, the null hypothesis would be to expect $30\%$ of the choices to be hearts, $30\%$ to be diamonds, $20\%$ to be spades and $20\%$ to be clubs. In other words we would expect hearts and diamonds to appear 1.5 times more often than spades and clubs (the ratio $30\%$ : $20\%$ is the same as 1.5 : 1). This seems like a silly theory to me, and it's pretty easy to test this explicitly specified null hypothesis with the data in our jamovi analysis. In the analysis window (labelled 'Proportion Test (N Outcomes)' in @fig-fig14-4 you can expand the options for 'Expected Proportions'. When you do this, there are options for entering different ratio values for the variable you have selected, in our case this is choice 1. Change the ratio to reflect the new null hypothesis, as in @fig-fig14-5, and see how the results change. --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-5" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig10-5.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">圖&nbsp;10.5: 在 jamovi 中更改 <span class="math inline">\(\\chi^2\)</span> 單樣本比例檢驗的預期比例</figcaption>
</figure>
</div>
</div>
</div>
<p>預期計數現在顯示在 <a href="#tbl-tab14-6">表&nbsp;<span>10.6</span></a> 中。</p>
<!--- The expected counts are now shown in @tbl-tab14-6. --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab14-6" class="anchored">
<table id="tab:tbl-tab14-6" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表&nbsp;10.6: 不同虛無假設的預期計數</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;"></td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">\( \clubsuit \)</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">\( \diamondsuit \)</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">\( \heartsuit \)</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">\( \spadesuit \)</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">expected frequency \( E_i\)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">40</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">60</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">60</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">40</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p><span class="math inline">\(\chi^2\)</span> 統計量為 4.74，自由度為 3，<span class="math inline">\(p = 0.182\)</span>。現在，我們更新的假設和預期頻率與上次的結果有所不同。因此，我們的 <span class="math inline">\(\chi^2\)</span> 檢驗統計量和 p 值也有所不同。令人惱火的是，p 值為 <span class="math inline">\(.182\)</span>，因此我們不能拒絕虛無假設（回顧 <a href="09-Hypothesis-testing.html#sec-The-p-value-of-a-test"><span>小單元&nbsp;9.5</span></a> 提醒自己為什麼）。可悲的是，儘管虛無假設對應著一個非常愚蠢的理論，這些資料並沒有提供足夠的證據來反駁它。</p>
<!--- and the $\chi^2$ statistic is 4.74, 3 d.f., $p = 0.182$. Now, the results of our updated hypotheses and the expected frequencies are different from what they were last time. As a consequence our $\chi^2$ test statistic is different, and our p-value is different too. Annoyingly, the p-value is $.182$, so we can't reject the null hypothesis (look back at @sec-The-p-value-of-a-test to remind yourself why). Sadly, despite the fact that the null hypothesis corresponds to a very silly theory, these data don't provide enough evidence against it. --->
</section>
<section id="sec-How-to-report-the-results-of-a-test" class="level3" data-number="10.1.9">
<h3 data-number="10.1.9" class="anchored" data-anchor-id="sec-How-to-report-the-results-of-a-test"><span class="header-section-number">10.1.9</span> 適合度檢定的報告寫作</h3>
<p>現在你知道了這個測試的運作方式，也知道如何使用神奇的jamovi計算盒來進行測試。接下來你需要知道的是如何撰寫結果。畢竟，設計和執行實驗，然後分析資料，如果不告訴別人結果是沒有意義的！所以讓我們來談談在報告分析時需要做的事情。讓我們繼續以撲克牌花色為例。如果我想將這個結果寫成一篇論文之類的東西，那麼慣常的報告方式是這樣寫的：</p>
<blockquote class="blockquote">
<p>在實驗的200名參與者中，有64人首選紅心，51人選擇方塊，50人選擇黑桃，35人選擇梅花。進行了卡方適合度檢驗以測試四種花色的選擇機率是否相同。結果顯著（<span class="math inline">\(\chi^2(3) = 8.44, p&lt; .05\)</span>），這表明人們在選擇花色時並非完全隨機。</p>
</blockquote>
<p>這相當直接，希望它看起來很不起眼。儘管如此，你應該注意到這個描述中的幾點內容：</p>
<ul>
<li><p><em>描述統計資料在統計檢驗之前</em>。也就是說，在進行檢驗之前，我告訴讀者有關資料的一些信息。通常，這是一個很好的做法。永遠記住，你的讀者對你的資料了解得遠不如你。因此，除非你妥善地向他們描述，否則統計檢驗對他們來說毫無意義，他們會感到沮喪和哭泣。</p></li>
<li><p><em>描述告訴你正在測試的虛無假設是什麼</em>。老實說，作者並不總是這樣做，但在存在一定歧義的情況下，或者在你不能依賴你的讀者非常熟悉你正在使用的統計工具時，這通常是一個好主意。很多時候讀者可能不知道（或記不起）你正在使用的檢驗的所有細節，所以提醒他們是一種禮貌！對於適合度檢驗來說，你通常可以依賴科學觀眾了解它的運作方式（因為它涵蓋在大多數入門統計課程中）。然而，明確陳述虛無假設（簡要地！）仍然是一個好主意，因為虛無假設可能因你使用檢驗的目的而有所不同。例如，在撲克牌的例子中，我的虛無假設是四個花色的機率相同（即，<span class="math inline">\(P1 = P2 = P3 = P4 = 0.25\)</span>），但這個假設並沒有什麼特別的。我可以同樣使用適合度檢驗測試虛無假設，即<span class="math inline">\(P_1 = 0.7\)</span>和<span class="math inline">\(P2 = P3 = P4 = 0.1\)</span>。所以，向讀者解釋你的虛無假設是有幫助的。另外，注意到我用文字而不是數學描述虛無假設。這是完全可以接受的。你可以用數學描述它，但是因為大多數讀者發現文字比符號更容易閱讀，所以大多數作者傾向於用文字描述虛無假設（如果可以的話）。</p></li>
<li><p><em>包括”統計塊”</em>。在報告檢驗結果本身時，我不僅僅說結果顯著，還包括了一個“統計塊”（即括號內密集的數學部分），其中報告了所有“關鍵”統計信息。對於卡方適應度檢驗，報告的信息包括檢驗統計量（即適應度統計量為8.44）、用於檢驗的分布信息（具有3個自由度的<span class="math inline">\(\chi^2\)</span>，通常縮寫為<span class="math inline">\(\chi^2\)</span>(3)），然後是結果是否顯著（在本例中為<span class="math inline">\(p&lt; .05\)</span>）。每個檢驗所需的統計塊中的特定信息各不相同，因此每次我介紹一個新檢驗時，我都會向您展示統計塊應該是什麼樣子。<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> 但是，一般原則是您應該始終提供足夠的信息，以便讀者在需要時可以自己檢查測試結果。</p></li>
<li><p><em>對結果進行解釋</em>。除了指出結果顯著之外，我還提供了結果的解釋（即，人們沒有隨機選擇）。這對讀者也是一種友善，因為它告訴他們關於資料中發生了什麼事的一些信息。如果不包括這樣的東西，讀者很難理解發生了什麼事。<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a></p></li>
</ul>
<p>正如其他所有事物一樣，你應該首要關注的是向讀者解釋事物。永遠記住，報告結果的目的是與另一個人溝通。我無法告訴您我看過多少次報告、論文甚至科學文章的結果部分就是胡言亂語，因為作者只關注確保包含所有數字，卻忘記了與人類讀者真正交流。</p>
<blockquote class="blockquote">
<p><em>撒旦在統計和引用經文中同樣感到高興</em><a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a> – H.G. 威爾斯</p>
</blockquote>

<!--- So now you know how the test works, and you know how to do the test using a wonderful jamovi flavoured magic computing box. The next thing you need to know is how to write up the results. After all, there's no point in designing and running an experiment and then analysing the data if you don't tell anyone about it! So let's now talk about what you need to do when reporting your analysis. Let's stick with our card-suits example. If I wanted to write this result up for a paper or something, then the conventional way to report this would be to write something like this:

> Of the 200 participants in the experiment, 64 selected hearts for their first choice, 51 selected diamonds, 50 selected spades, and 35 selected clubs. A chi-square goodness-of-fit test was conducted to test whether the choice probabilities were identical for all four suits. The results were significant ($\chi^2(3) = 8.44, p< .05)$, suggesting that people did not select suits purely at random.

This is pretty straightforward and hopefully it seems pretty unremarkable. That said, there's a few things that you should note about this description:

- *The statistical test is preceded by the descriptive statistics*. That is, I told the reader something about what the data look like before going on to do the test. In general, this is good practice. Always remember that your reader doesn't know your data anywhere near as well as you do. So, unless you describe it to them properly, the statistical tests won't make any sense to them and they'll get frustrated and cry.
- *The description tells you what the null hypothesis being tested is*. To be honest, writers don't always do this but it's often a good idea in those situations where some ambiguity exists, or when you can't rely on your readership being intimately familiar with the statistical tools that you're using. Quite often the reader might not know (or remember) all the details of the test that your using, so it's a kind of politeness to "remind" them! As far as the goodness-of-fit test goes, you can usually rely on a scientific audience knowing how it works (since it's covered in most intro stats classes). However, it's still a good idea to be explicit about stating the null hypothesis (briefly!) because the null hypothesis can be different depending on what you're using the test for. For instance, in the cards example my null hypothesis was that all the four suit probabilities were identical (i.e., $P1 = P2 = P3 = P4 = 0.25$), but there's nothing special about that hypothesis. I could just as easily have tested the null hypothesis that $P_1 = 0.7$ and $P2 = P3 = P4 = 0.1$ using a goodness-of-fit test. So it's helpful to the reader if you explain to them what your null hypothesis was. Also, notice that I described the null hypothesis in words, not in maths. That's perfectly acceptable. You can describe it in maths if you like, but since most readers find words easier to read than symbols, most writers tend to describe the null using words if they can.
- *A "stat block" is included*. When reporting the results of the test itself, I didn't just say that the result was significant, I included a "stat block" (i.e., the dense mathematical looking part in the parentheses) which reports all the "key" statistical information. For the chi-square goodness-of-fit test, the information that gets reported is the test statistic (that the goodness-of-fit statistic was 8.44), the information about the distribution used in the test ($\chi^2$ with 3 degrees of freedom which is usually shortened to $\chi^2$(3)), and then the information about whether the result was significant (in this case $p< .05$). The particular information that needs to go into the stat block is different for every test, and so each time I introduce a new test I'll show you what the stat block should look like.[^10-categorical-data-analysis-7] However the general principle is that you should always provide enough information so that the reader could check the test results themselves if they really wanted to.
- *The results are interpreted*. In addition to indicating that the result was significant, I provided an interpretation of the result (i.e., that people didn't choose randomly). This is also a kindness to the reader, because it tells them something about what they should believe about what's going on in your data. If you don't include something like this, it's really hard for your reader to understand what's going on.[^10-categorical-data-analysis-8]

[^10-categorical-data-analysis-7]: Well, sort of. The conventions for how statistics should be reported tend to differ somewhat from discipline to discipline. I've tended to stick with how things are done in psychology, since that's what I do. But the general principle of providing enough information to the reader to allow them to check your results is pretty universal, I think.

[^10-categorical-data-analysis-8]: To some people, this advice might sound odd, or at least in conflict with the "usual" advice on how to write a technical report. Very typically, students are told that the "results" section of a report is for describing the data and reporting statistical analysis, and the "discussion" section is for providing interpretation. That's true as far as it goes, but I think people often interpret it way too literally. The way I usually approach it is to provide a quick and simple interpretation of the data in the results section, so that my reader understands what the data are telling us. Then, in the discussion, I try to tell a bigger story about how my results fit with the rest of the scientific literature. In short, don't let the "interpretation goes in the discussion" advice turn your results section into incomprehensible garbage. Being understood by your reader is much more important.

As with everything else, your overriding concern should be that you explain things to your reader. Always remember that the point of reporting your results is to communicate to another human being. I cannot tell you just how many times I've seen the results section of a report or a thesis or even a scientific article that is just gibberish, because the writer has focused solely on making sure they've included all the numbers and forgotten to actually communicate with the human reader.

> *Satan delights equally in statistics and in quoting scripture*[^10-categorical-data-analysis-9]
> -- H.G. Wells

[^10-categorical-data-analysis-9]: If you've been reading very closely, and are as much of a mathematical pedant as I am, there is one thing about the way I wrote up the chi-square test in the last section that might be bugging you a little bit. There's something that feels a bit wrong with writing "$\chi^2(3) = 8.44$", you might be thinking. After all, it's the goodness-of-fit statistic that is equal to 8.44, so shouldn't I have written $X^2 = 8.44$ or maybe $GOF = 8.44$? This seems to be conflating the sampling distribution (i.e., $\chi^2$ with df = 3) with the test statistic (i.e., $X^2$). Odds are you figured it was a typo, since $\chi$ and X look pretty similar. Oddly, it's not. Writing $\chi^2$(3)= 8.44 is essentially a highly condensed way of writing "the sampling distribution of the test statistic is $\chi^2$(3), and the value of the test statistic is 8.44" In one sense, this is kind of stupid. There are lots of different test statistics out there that turn out to have a chi-square sampling distribution. The $X^2$ statistic that we've used for our goodness-of-fit test is only one of many (albeit one of the most commonly encountered ones). In a sensible, perfectly organised world we'd always have a separate name for the test statistic and the sampling distribution. That way, the stat block itself would tell you exactly what it was that the researcher had calculated. Sometimes this happens. For instance, the test statistic used in the Pearson goodness-of-fit test is written $X^2$ , but there's a closely related test known as the G-test$^a$ [@Sokal1994], in which the test statistic is written as $G$. As it happens, the Pearson goodness-of-fit test and the G-test both test the same null hypothesis, and the sampling distribution is exactly the same (i.e., chi-square with $k - 1$ degrees of freedom). If I'd done a G-test for the cards data rather than a goodness-of-fit test, then I'd have ended up with a test statistic of $G = 8.65$, which is slightly different from the $X^2 = 8.44$ value that I got earlier and which produces a slightly smaller p-value of $p = .034$. Suppose that the convention was to report the test statistic, then the sampling distribution, and then the p-value. If that were true, then these two situations would produce different stat blocks: my original result would be written $X^2 = 8.44$, $\chi^2(3)$, $p = .038$, whereas the new version using the G-test would be written as $G = 8.65$, $\chi^2(3)$, $p = .034$. However, using the condensed reporting standard, the original result is written $\chi^2(3) = 8.44, p =.038$, and the new one is written $\chi^2(3) = 8.65, p = .034$, and so it's actually unclear which test I actually ran. So why don't we live in a world in which the contents of the stat block uniquely specifies what tests were ran? The deep reason is that life is messy. We (as users of statistical tools) want it to be nice and neat and organised. We want it to be designed, as if it were a product, but that's not how life works. Statistics is an intellectual discipline just as much as any other one, and as such it's a massively distributed, partly-collaborative and partly-competitive project that no-one really understands completely. The things that you and I use as data analysis tools weren't created by an Act of the Gods of Statistics. They were invented by lots of different people, published as papers in academic journals, implemented, corrected and modified by lots of other people, and then explained to students in textbooks by someone else. As a consequence, there's a lot of test statistics that don't even have names, and as a consequence they're just given the same name as the corresponding sampling distribution. As we'll see later, any test statistic that follows a $\chi^2$ distribution is commonly called a "chi-square statistic", anything that follows a $t$-distribution is called a "t-statistic", and so on. But, as the $\chi^2$ versus $G$ example illustrates, two different things with the same sampling distribution are still, well, different. As a consequence, it's sometimes a good idea to be clear about what the actual test was that you ran, especially if you're doing something unusual. If you just say "chi-square test" it's not actually clear what test you're talking about. Although, since the two most common chi-square tests are the goodness-of-fit test and the independence test, most readers with stats training can probably guess. Nevertheless, it's something to be aware of. -- $^a$ Complicating matters, the G-test is a special case of a whole class of tests that are known as likelihood ratio tests. I don't cover LRTs in this book, but they are quite handy things to know about. --->
</section>
</section>
<section id="卡方獨立性檢定" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="卡方獨立性檢定"><span class="header-section-number">10.2</span> 卡方獨立性檢定</h2>
<blockquote class="blockquote">
<p>警衛機器人 1：停！<br>
警衛機器人 2：你是機器人還是人類？<br>
莉娜：機器人…我們是。<br>
弗萊：呃，對！只是兩個機器人在機器人世界裡像機器人一樣生活！呃？<br>
警衛機器人 1：進行測試。<br>
警衛機器人 2：以下哪一個是你最喜歡的？A：一只小狗，B：來自你心上人的漂亮花朵，或C：一個大的、格式正確的資料文件？<br>
警衛機器人 1：選擇！<br>
《飛出個未來》第一季第5集”Fear of a Bot Planet”台詞(1999~2003的美國情境喜劇；台灣無代理商引進播映)</p>
</blockquote>
<p>有一天，我在觀看一部動畫紀錄片，研究<em>Chapek 9</em>星球上當地人的古怪風俗。顯然，要進入他們的首府，訪客必須證明他們是機器人而不是人類。為了確定訪客是否是人類，當地人會詢問訪客是喜歡小狗、花還是大型、格式正確的資料文件。我心想：“相當聰明，但如果人類和機器人有相同的喜好呢？那可能不是一個很好的測試了，對吧？”事實上，我得到了<em>Chapek 9</em>市民當局用來檢查這個問題的測試資料。他們所做的非常簡單。他們找了一堆機器人和一堆人，問他們喜歡什麼。我把他們的資料保存在一個名為<em>chapek9.omv</em>的文件中，現在我們可以將其加載到jamovi中。除了識別個人的ID變項外，還有兩個名義文本變項，species和choice。總共有180個條目在資料集中，每個人（將機器人和人類都算作“人”）被要求做出選擇。具體而言，有93個人類和87個機器人，絕大多數人選擇了資料文件。你可以通過在’探索’-‘描述統計’按鈕下詢問jamovi的頻率表來自己檢查這一點。然而，這個總結並沒有解決我們感興趣的問題。要做到這一點，我們需要對資料進行更詳細的描述。我們想要做的是查看按<em>物種</em>劃分的選擇。也就是說，我們需要對資料進行交叉分類（見@sec-Tabulating-and-cross-tabulating-data）。在jamovi中，我們使用’頻率’-‘列聯表’-’獨立樣本’分析來完成這個操作，我們應該得到一個類似@tbl-tab14-7的表格。</p>

<!---
> GUARDBOT 1: Halt! \
> GUARDBOT 2: Be you robot or human? \
> LEELA: Robot...we be. \
> FRY: Uh, yup! Just two robots out roboting it up! Eh? \
> GUARDBOT 1: Administer the test. \
> GUARDBOT 2: Which of the following would you most prefer? A: A puppy, B: A pretty flower from your sweetie, or C: A large properly-formatted data file? \
> GUARDBOT 1: Choose! \
> *Futurama, "Fear of a Bot Planet"*

The other day I was watching an animated documentary examining the quaint customs of the natives of the planet *Chapek 9*. Apparently, in order to gain access to their capital city a visitor must prove that they're a robot, not a human. In order to determine whether or not a visitor is human, the natives ask whether the visitor prefers puppies, flowers, or large, properly formatted data files. "Pretty clever," I thought to myself "but what if humans and robots have the same preferences? That probably wouldn't be a very good test then, would it?" As it happens, I got my hands on the testing data that the civil authorities of *Chapek 9* used to check this. It turns out that what they did was very simple. They found a bunch of robots and a bunch of humans and asked them what they preferred. I saved their data in a file called *chapek9.omv*, which we can now load into jamovi. As well as the ID variable that identifies individual people, there are two nominal text variables, species and choice. In total there are 180 entries in the data set, one for each person (counting both robots and humans as "people") who was asked to make a choice. Specifically, there are 93 humans and 87 robots, and overwhelmingly the preferred choice is the data file. You can check this yourself by asking jamovi for Frequency Tables, under the 'Exploration' - 'Descriptives' button. However, this summary does not address the question we're interested in. To do that, we need a more detailed description of the data. What we want to do is look at the choices broken down *by species*. That is, we need to cross-tabulate the data (see @sec-Tabulating-and-cross-tabulating-data). In jamovi we do this using the 'Frequencies' - 'Contingency Tables' - 'Independent Samples' analysis, and we should get a table something like @tbl-tab14-7. --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab14-7" class="anchored">
<table id="tab:tbl-tab14-7" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表&nbsp;10.7: 交叉分類資料</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;"></td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">Robot</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">Human</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">Total</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Puppy</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">13</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">15</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">28</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Flower</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">30</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">13</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">43</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Data</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">44</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">65</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">109</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Total</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">87</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">93</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">180</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>從這個表格中，我們可以很清楚地看到，絕大多數人類選擇了資料文件，而機器人在他們的選擇中則相對更均衡。撇開為什麼人類可能更喜歡選擇資料文件的問題（這確實看起來有點奇怪，承認吧），我們首要任務是確定資料集中人類選擇和機器人選擇之間的差異是否具有統計顯著性。</p>
<!--- From this, it's quite clear that the vast majority of the humans chose the data file, whereas the robots tended to be a lot more even in their preferences. Leaving aside the question of why the humans might be more likely to choose the data file for the moment (which does seem quite odd, admittedly), our first order of business is to determine if the discrepancy between human choices and robot choices in the data set is statistically significant. --->
<section id="sec-Constructing-independence-test" class="level3" data-number="10.2.1">
<h3 data-number="10.2.1" class="anchored" data-anchor-id="sec-Constructing-independence-test"><span class="header-section-number">10.2.1</span> 建立獨立性的假設檢定</h3>
<p>我們如何分析這些資料？具體來說，由於我的研究假設是”人類和機器人回答問題的方式不同”，我該如何構建對虛無假設的檢驗，即”人類和機器人以相同的方式回答問題”？與以前一樣，我們首先建立一些符號來描述資料（<a href="#tbl-tab14-8">表&nbsp;<span>10.8</span></a>）。</p>
<!--- How do we analyse this data? Specifically, since my research hypothesis is that "humans and robots answer the question in different ways", how can I construct a test of the null hypothesis that "humans and robots answer the question the same way"? As before, we begin by establishing some notation to describe the data (@tbl-tab14-8). --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab14-8" class="anchored">
<table id="tab:tbl-tab14-8" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表&nbsp;10.8: 描述資料的符號</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;"></td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">Robot</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">Human</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">Total</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Puppy</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(O_{11}\)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(O_{12}\)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(R_{1}\)</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Flower</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(O_{21}\)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(O_{22}\)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(R_{2}\)</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Data</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(O_{31}\)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(O_{32}\)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(R_{3}\)</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Total</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(C_{1}\)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(C_{2}\)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">N</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>在這個符號中，我們用 <span class="math inline">\(O_{ij}\)</span> 表示被調查者在物種 j（機器人或人類）中選擇 i（小狗，花或資料）的計數（觀察頻率）。總觀察數通常表示為 <span class="math inline">\(N\)</span>。最後，我用 <span class="math inline">\(R_i\)</span> 表示行總數（例如，<span class="math inline">\(R_1\)</span> 是選擇花的人的總數），用 <span class="math inline">\(C_j\)</span> 表示列總數（例如，<span class="math inline">\(C_1\)</span> 是機器人的總數）。<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a></p>
<p>那麼，現在讓我們考慮一下虛無假設是什麼。如果機器人和人類對這個問題的回答方式相同，那麼“機器人說小狗”的機率與“人類說小狗”的機率相同，對其他兩種可能性也是如此。所以，如果我們用 <span class="math inline">\(P_{ij}\)</span> 表示“物種 j 的成員給出回應 i 的機率”，那麼我們的虛無假設是：</p>
<p><span class="math display">\[
\begin{aligned}
H_0 &amp;: \text{以下全部成立：} \\
&amp;P_{11} = P_{12}\text{ （選擇“小狗”的機率相同），} \\
&amp;P_{21} = P_{22}\text{ （選擇“花”的機率相同），以及} \\
&amp;P_{31} = P_{32}\text{ （選擇“資料”的機率相同）}
\end{aligned}
\]</span></p>
<p>事實上，由於虛無假設聲稱真實的選擇機率不取決於做出選擇的人的物種，我們可以讓 Pi 代表這個機率，例如，P1 是選擇小狗的真實機率。</p>
<p>接下來，就像我們在適配度檢驗中所做的那樣，我們需要計算期望頻率。也就是說，對於每個觀察到的計數 <span class="math inline">\(O_{ij}\)</span>，我們需要弄清楚虛無假設告訴我們期望什麼。我們用 <span class="math inline">\(E_{ij}\)</span> 表示這個期望頻率。這次，情況有點棘手。如果物種 <span class="math inline">\(j\)</span> 中有 <span class="math inline">\(C_j\)</span> 人，而無論物種如何選擇選項 <span class="math inline">\(i\)</span> 的真實機率為 <span class="math inline">\(P_i\)</span>，那麼期望頻率只是：</p>
<p><span class="math display">\[E_{ij}=C_j \times P_i\]</span></p>
<p>現在，這固然很好，但我們遇到了一個問題。與適配度檢驗的情況不同，虛無假設實際上並未指定 Pi 的特定值。</p>
<p>這是我們必須估計（見 <a href="08-Estimating-unknown-quantities-from-a-sample.html"><span>單元&nbsp;8</span></a>）的資料！幸運的是，這非常容易做到。如果有 28 位擇一的人選擇了花朵，那麼選擇花朵的機率的自然估計就是 <span class="math inline">\(\frac{28}{180}\)</span>，大約是 <span class="math inline">\(0.16\)</span>。如果我們用數學語言來表示，我們所說的是，選擇選項 i 的機率估計只是行總數除以總樣本量：</p>
<p><span class="math display">\[\hat{P}_{i}= \frac{R_i}{N}\]</span></p>
<p>因此，我們的期望頻率可以寫成行總數和列總數的乘積（即相乘），除以總觀察次數：<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a></p>
<p><span class="math display">\[\hat{E}_{ij}= \frac{R_i \times C_j}{N}\]</span></p>
<!--- 現在我們已經了解了如何從虛無假設中計算期望頻率，接下來的步驟與適配度檢驗相似。首先，對於每個 $O_{ij}$ 和 $E_{ij}$，我們計算 $(O_{ij} - E_{ij})^2 / E_{ij}$ 的值。然後，我們將這些值相加，得到一個名為卡方的統計量（$\chi^2$）。這個統計量也遵循卡方分布，因此我們可以將其用於計算 p 值，並進行檢驗。實際上，與適配度檢驗相似，卡方獨立性檢驗的自由度是由資料中的類別數量決定的，而不是預先知道的。

總之，我們可以通過將卡方獨立性檢驗應用於類別資料來檢驗虛無假設，即人類和機器人對問題的回答方式相同。這種方法允許我們計算期望頻率、卡方統計量以及對應的 p 值，從而幫助我們判斷是否拒絕虛無假設。--->
<p>[額外的技術細節<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a>]</p>
<p>與以前一樣，<span class="math inline">\(X^2\)</span> 的大值表示虛無假設對資料的描述效果不佳，而 <span class="math inline">\(X^2\)</span> 的小值則表示虛無假設對資料的解釋效果很好。因此，就像上次一樣，如果 <span class="math inline">\(X^2\)</span> 太大，我們希望拒絕虛無假設。</p>
<p>不出所料，這個統計量遵循 <span class="math inline">\(\chi^2\)</span> 分布。我們需要做的就是弄清楚有多少自由度，實際上這並不困難。如我之前提到的，你可以（通常）將自由度視為等於你正在分析的資料點數量，減去約束的數量。具有 r 行和 c 列的列聯表包含總共 <span class="math inline">\(r^{c}\)</span> 個觀察到的頻率，所以這是觀察到的總數量。約束呢？在這裡，情況稍微複雜一些。答案始終是相同的</p>
<p><span class="math display">\[df=(r-1)(c-1)\]</span></p>
<p>但是根據實驗設計，解釋為什麼自由度具有此值的原因是不同的。為了便於說明，假設我們確實打算調查 87 台機器人和 93 人（實驗者固定列總數），但讓行總數自由變化（行總數是隨機變項）。讓我們考慮在這裡適用的約束。好吧，因為我們故意通過實驗者的行為固定了列總數，所以在這裡就有 c 個約束。但實際上，還有更多的約束。記住我們的虛無假設中有一些自由參數（即，我們不得不估計 Pi 值）？這些也很重要。在這本書中，我不會解釋為什麼，但虛無假設中的每個自由參數都像是一個額外的約束。那麼，這些參數有多少呢？好吧，由於這些機率必須加起來等於 1，所以只有 <span class="math inline">\(r - 1\)</span> 個。因此，我們的自由度總數是：</p>
<p><span class="math display">\[ \begin{split} df &amp; = \text{(number of
observations) - (number of constraints)} \\\\ &amp; = (r \times c) - (c +
(r - 1)) \\\\ &amp; = rc - c - r + 1 \\\\ &amp; = (r - 1)(c - 1) \end{split}\]</span></p>
<p>另一種假設，假設實驗者確定的唯一事物是總樣本量 N。也就是說，我們對見到的前 180 人進行了問卷調查，結果發現 87 人是機器人，93 人是人類。這一次，我們的推理會有所不同，但仍然會得到相同的答案。我們的虛無假設仍然有 <span class="math inline">\(r - 1\)</span> 個自由參數，對應於選擇機率，但現在還有 <span class="math inline">\(c - 1\)</span> 個自由參數，對應於種類機率，因為我們還必須估計隨機抽樣的人類確實是機器人的機率。<a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a> 最後，由於我們確實確定了觀察數量的總數 N，所以這是另一個約束。因此，現在我們有 rc 次觀察，並且有 <span class="math inline">\((c-1)+(r-1)+1\)</span> 約束。這會給出什麼呢？</p>
<p><span class="math display">\[\begin{split} df &amp; = \text{(number of
observations) - (number of constraints)} \\\\ &amp; = (r \times c) -
((c-1) + (r - 1)+1) \\\\ &amp; = (r- 1)(c - 1) \end{split}
\]</span></p>
<p>真是令人驚奇。</p>

<!--- In this notation we say that $O_{ij}$ is a count (observed frequency) of the number of respondents that are of species j (robots or human) who gave answer i (puppy, flower or data) when asked to make a choice. The total number of observations is written $N$, as usual. Finally, I've used $R_i$ to denote the row totals (e.g., $R_1$ is the total number of people who chose the flower), and $C_j$ to denote the column totals (e.g., $C_1$ is the total number of robots).[^10-categorical-data-analysis-10]

[^10-categorical-data-analysis-10]: A technical note. The way I've described the test pretends that the column totals are fixed (i.e., the researcher intended to survey 87 robots and 93 humans) and the row totals are random (i.e., it just turned out that 28 people chose the puppy). To use the terminology from my mathematical statistics textbook [@Hogg2005] I should technically refer to this situation as a chi-square test of homogeneity and reserve the term chi-square test of independence for the situation where both the row and column totals are random outcomes of the experiment. In the initial drafts of this book that's exactly what I did. However, it turns out that these two tests are identical, and so I've collapsed them together.

So now let's think about what the null hypothesis says. If robots and humans are responding in the same way to the question, it means that the probability that "a robot says puppy" is the same as the probability that "a human says puppy", and so on for the other two possibilities. So, if we use $P_{ij}$ to denote "the probability that a member of species j gives response i" then our null hypothesis is that:

$$
\begin{aligned}
H_0 &: \text{All of the following are true:} \\
&P_{11} = P_{12}\text{ (same probability of saying “puppy”),} \\
&P_{21} = P_{22}\text{ (same probability of saying “flower”), and} \\
&P_{31} = P_{32}\text{ (same probability of saying “data”).}
\end{aligned}
$$

And actually, since the null hypothesis is claiming that the true choice probabilities don't depend on the species of the person making the choice, we can let Pi refer to this probability, e.g., P1 is the true probability of choosing the puppy.

Next, in much the same way that we did with the goodness-of-fit test, what we need to do is calculate the expected frequencies. That is, for each of the observed counts $O_{ij}$ , we need to figure out what the null hypothesis would tell us to expect. Let's denote this expected frequency by $E_{ij}$. This time, it's a little bit trickier. If there are a total of $C_j$ people that belong to species $j$, and the true probability of anyone (regardless of species) choosing option $i$ is $P_i$ , then the expected frequency is just:

$$E_{ij}=C_j \times P_i$$

Now, this is all very well and good, but we have a problem. Unlike the situation we had with the goodness-of-fit test, the null hypothesis doesn't actually specify a particular value for Pi .

It's something we have to estimate (see @sec-Estimating-unknown-quantities-from-a-sample) from the data! Fortunately, this is pretty easy to do. If 28 out of 180 people selected the flowers, then a natural estimate for the probability of choosing flowers is $\frac{28}{180}$, which is approximately $.16$. If we phrase this in mathematical terms, what we're saying is that our estimate for the probability of choosing option i is just the row total divided by the total sample size:

$$\hat{P}_{i}= \frac{R_i}{N}$$

Therefore, our expected frequency can be written as the product (i.e. multiplication) of the row total and the column total, divided by the total number of observations:[^10-categorical-data-analysis-11]

[^10-categorical-data-analysis-11]: Technically, $E_{ij}$ here is an estimate, so I should probably write it $\hat{E_{ij}}$ . But since no-one else does, I won't either.

$$\hat{E}_{ij}= \frac{R_i \times C_j}{N}$$

[Additional technical detail [^10-categorical-data-analysis-12]]

[^10-categorical-data-analysis-12]: Now that we've figured out how to calculate the expected frequencies, it's straightforward to define a test statistic, following the exact same strategy that we used in the goodness-of-fit test. In fact, it's pretty much the same statistic. For a contingency table with r rows and c columns, the equation that defines our $X^2$ statistic is $$X^2=\sum_{i=1}^{r}\sum_{j=1}^{c} \frac{(E_{ij}-O_{ij})^2}{E_{ij}}$$ The only difference is that I have to include two summation signs (i.e., $\sum$ ) to indicate that we're summing over both rows and columns.

As before, large values of $X^2$ indicate that the null hypothesis provides a poor description of the data, whereas small values of $X^2$ suggest that it does a good job of accounting for the data. Therefore, just like last time, we want to reject the null hypothesis if $X^2$ is too large.

Not surprisingly, this statistic is $\chi^2$ distributed. All we need to do is figure out how many degrees of freedom are involved, which actually isn't too hard. As I mentioned before, you can (usually) think of the degrees of freedom as being equal to the number of data points that you're analysing, minus the number of constraints. A contingency table with r rows and c columns contains a total of $r^{c}$ observed frequencies, so that's the total number of observations. What about the constraints? Here, it's slightly trickier. The answer is always the same

$$df=(r-1)(c-1)$$

but the explanation for why the degrees of freedom takes this value is different depending on the experimental design. For the sake of argument, let's suppose that we had honestly intended to survey exactly 87 robots and 93 humans (column totals fixed by the experimenter), but left the row totals free to vary (row totals are random variables). Let's think about the constraints that apply here. Well, since we deliberately fixed the column totals by Act of Experimenter, we have $c$ constraints right there. But, there's actually more to it than that. Remember how our null hypothesis had some free parameters (i.e., we had to estimate the Pi values)? Those matter too. I won't explain why in this book, but every free parameter in the null hypothesis is rather like an additional constraint. So, how many of those are there? Well, since these probabilities have to sum to 1, there's only $r - 1$ of these. So our total degrees of freedom is:

$$ \begin{split} df & = \text{(number of
observations) - (number of constraints)} \\\\ & = (r \times c) - (c +
(r - 1)) \\\\ & = rc - c - r + 1 \\\\ & = (r - 1)(c - 1) \end{split}$$

Alternatively, suppose that the only thing that the experimenter fixed was the total sample size N. That is, we quizzed the first 180 people that we saw and it just turned out that 87 were robots and 93 were humans. This time around our reasoning would be slightly different, but would still lead us to the same answer. Our null hypothesis still has $r - 1$ free parameters corresponding to the choice probabilities, but it now also has $c - 1$ free parameters corresponding to the species probabilities, because we'd also have to estimate the probability that a randomly sampled person turns out to be a robot.[^10-categorical-data-analysis-13] Finally, since we did actually fix the total number of observations N, that's one more constraint. So, now we have rc observations, and $(c-1)+(r-1)+1$ constraints. What does that give?

[^10-categorical-data-analysis-13]: A problem many of us worry about in real life.

$$\begin{split} df & = \text{(number of
observations) - (number of constraints)} \\\\ & = (r \times c) -
((c-1) + (r - 1)+1) \\\\ & = (r - 1)(c - 1) \end{split}
$$ Amazing.

--->
</section>
<section id="sec-doing-independence-test" class="level3" data-number="10.2.2">
<h3 data-number="10.2.2" class="anchored" data-anchor-id="sec-doing-independence-test"><span class="header-section-number">10.2.2</span> 獨立性檢定實作</h3>
<p>好吧，既然我們知道了檢驗是如何進行的，讓我們看看如何在 jamovi 中完成它。雖然讓您長時間地經歷繁瑣的計算以便被迫學習可能很有吸引力，但我認為這是沒有意義的。在上一節中，我已經向您展示了如何針對適合度檢驗進行長時間的操作，而且由於獨立性檢驗在概念上沒有任何不同，所以您不會通過長時間的操作學到任何新的東西。因此，我將直接向您展示簡單的方法。在 jamovi 中運行檢驗（“頻率” - “列聯表” - “獨立樣本”）之後，您只需查看 jamovi 結果窗口中列聯表下方，那裡就是 <span class="math inline">\(\chi^2\)</span> 統計量。這顯示了一個 <span class="math inline">\(\chi^2\)</span> 統計值為 10.72，2 d.f.，p-value = 0.005。</p>
<p>那很簡單，不是嗎？您還可以要求 jamovi 顯示預期計數 - 只需單擊“Cells”選項中的“Counts” - “Expected”複選框，預期計數將出現在列聯表中。同時，在此操作中，效果大小度量會有所幫助。我們將選擇 Cramér’s <span class="math inline">\(V\)</span>，您可以在“Statistics”選項中的複選框中指定它，它會給出 Cramér’s <span class="math inline">\(V\)</span> 的值為 <span class="math inline">\(0.24\)</span>。參見 <a href="#fig-fig14-6">圖&nbsp;<span>10.6</span></a>。我們稍後會再談論這個問題。</p>

<!--- Okay, now that we know how the test works let's have a look at how it's done in jamovi. As tempting as it is to lead you through the tedious calculations so that you're forced to learn it the long way, I figure there's no point. I already showed you how to do it the long way for the goodness-of-fit test in the last section, and since the test of independence isn't conceptually any different, you won't learn anything new by doing it the long way. So instead I'll go straight to showing you the easy way. After you have run the test in jamovi ('Frequencies' - 'Contingency Tables' - 'Independent Samples'), all you have to do is look underneath the contingency table in the jamovi results window and there is the $\chi^2$ statistic for you. This shows a $\chi^2$ statistic value of 10.72, with 2 d.f. and p-value = 0.005.

That was easy, wasn't it! You can also ask jamovi to show you the expected counts - just click on the check box for 'Counts' - 'Expected' in the 'Cells' options and the expected counts will appear in the contingency table. And whilst you are doing that, an effect size measure would be helpful. We'll choose Cramér's $V$, and you can specify this from a check box in the 'Statistics' options, and it gives a value for Cramér's $V$ of $0.24$. See @fig-fig14-6. We will talk about this some more in just a moment. --->
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-6" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig10-6.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">圖&nbsp;10.6: 在 jamovi 中使用 <em>Chapek 9</em> 資料進行獨立樣本 <span class="math inline">\(\chi^2\)</span> 檢驗</figcaption>
</figure>
</div>
</div>
</div>
<p>這個輸出為我們提供了足夠的信息來寫出結果：</p>
<blockquote class="blockquote">
<p><em>Pearson</em> 的 <span class="math inline">\(\chi^2\)</span> 顯示了物種和選擇之間存在顯著關聯（<span class="math inline">\(\chi^2(2) = 10.7, p&lt; .01\)</span>）。機器人似乎更傾向於說他們喜歡花，而人類更傾向於說他們喜歡資料。</p>
</blockquote>
<p>注意，再次，我提供了一些解釋，以幫助人類讀者理解資料發生的情況。稍後在我的討論部分，我會提供更多的上下文。舉例來說，這是我可能會在之後說的：</p>
<blockquote class="blockquote">
<p>人類似乎比機器人更喜歡原始資料文件，這有點反直覺。但在某種程度上，它是有道理的，因為 Chapek 9 上的民事當局往往在發現人類時會將其殺死並解剖。因此，最有可能的是，人類參與者並未如實回答問題，以避免可能產生不良後果。這應該被認為是一個嚴重的方法論缺陷。</p>
</blockquote>
<p>我想，這可以被歸類為反應效應的一個極端例子。顯然，在這種情況下，問題嚴重到研究幾乎毫無價值，作為理解人類和機器人之間的差異偏好的工具。然而，我希望這能夠說明在獲得統計顯著結果（我們拒絕虛無假設，轉而接受替代假設）和找到具有科學價值的東西（由於嚴重的方法論缺陷，資料對我們研究假設的興趣一無所知）之間的區別。</p>
<!--- This output gives us enough information to write up the result:

> *Pearson's* $\chi^2$ revealed a significant association between species and choice ($\chi^2(2) = 10.7, p< .01)$. Robots appeared to be more likely to say that they prefer flowers, but the humans were more likely to say they prefer data.

Notice that, once again, I provided a little bit of interpretation to help the human reader understand what's going on with the data. Later on in my discussion section I'd provide a bit more context. To illustrate the difference, here's what I'd probably say later on:

> The fact that humans appeared to have a stronger preference for raw data files than robots is somewhat counter-intuitive. However, in context it makes some sense, as the civil authority on Chapek 9 has an unfortunate tendency to kill and dissect humans when they are identified. As such it seems most likely that the human participants did not respond honestly to the question, so as to avoid potentially undesirable consequences. This should be considered to be a substantial methodological weakness.

This could be classified as a rather extreme example of a reactivity effect, I suppose. Obviously, in this case the problem is severe enough that the study is more or less worthless as a tool for understanding the difference preferences among humans and robots. However, I hope this illustrates the difference between getting a statistically significant result (our null hypothesis is rejected in favour of the alternative), and finding something of scientific value (the data tell us nothing of interest about our research hypothesis due to a big methodological flaw). --->
</section>
</section>
<section id="卡方檢定的校正" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="卡方檢定的校正"><span class="header-section-number">10.3</span> 卡方檢定的校正</h2>
<p>好吧，是時候稍作偏離了。到目前為止，我對您有點不誠實。當您只有 1 個自由度時，需要對計算稍作改變。這被稱為 “連續性修正”，或者有時稱為<strong>葉氏修正</strong>。請記住我之前指出的：<span class="math inline">\(\chi^2\)</span> 檢定是基於一個近似值，具體來說，是假設當 <span class="math inline">\(N\)</span> 較大時，二項分佈開始類似於正態分佈。這樣做的一個問題是，它通常並不完全奏效，尤其是當你只有 1 個自由度時（例如，當你對一個 <span class="math inline">\(2 \times 2\)</span> 的列聯表進行獨立性檢定時）。造成這一現象的主要原因是，<span class="math inline">\(X^{2}\)</span> 統計量的真實抽樣分佈實際上是離散的（因為您在處理分類資料！），但 <span class="math inline">\(\chi^2\)</span> 分佈是連續的。這可能引入系統性問題。具體來說，當 N 很小且 <span class="math inline">\(df = 1\)</span> 時，適合度統計量往往 “太大”，這意味著您實際上的α值比您想象的要大（或者等效地說，p值稍微太小）。</p>
<p>根據我從閱讀葉氏論文<a href="#fn14" class="footnote-ref" id="fnref14" role="doc-noteref"><sup>14</sup></a>中獲得的了解，修正基本上是一個突破。它不是源於任何原則性的理論。相反，它是基於對檢定行為的觀察，並發現經過修正的版本似乎效果更好。您可以在 jamovi 的 ‘Statistics’ 選項中的復選框中指定這個修正，其中它被稱為 ‘<span class="math inline">\(\chi^2\)</span> 連續性修正’。</p>

<!--- Okay, time for a little bit of a digression. I've been lying to you a little bit so far. There's a tiny change that you need to make to your calculations whenever you only have 1 degree of freedom. It's called the "continuity correction", or sometimes the **Yates correction**. Remember what I pointed out earlier: the $\chi^2$ test is based on an approximation, specifically on the assumption that the binomial distribution starts to look like a normal distribution for large $N$. One problem with this is that it often doesn't quite work, especially when you've only got 1 degree of freedom (e.g., when you're doing a test of independence on a $2 \times 2$ contingency table). The main reason for this is that the true sampling distribution for the $X^{2}$ statistic is actually discrete (because you're dealing with categorical data!) but the $\chi^2$ distribution is continuous. This can introduce systematic problems. Specifically, when N is small and when $df = 1$, the goodness-of-fit statistic tends to be "too big", meaning that you actually have a bigger α value than you think (or, equivalently, the p values are a bit too small).

As far as I can tell from reading Yates' paper[^10-categorical-data-analysis-14], the correction is basically a hack. It's not derived from any principled theory. Rather, it's based on an examination of the behaviour of the test, and observing that the corrected version seems to work better. You can specify this correction in jamovi from a check box in the 'Statistics' options, where it is called '$\chi^2$ continuity correction'.

[^10-categorical-data-analysis-14]: [Yates (1934)](https://www.jstor.org/stable/2983604) suggested a simple fix, in which you redefine the goodness-of-fit statistic as: $$\chi^{2}=\sum_{i}\frac{(|E_i-O_i|-0.5)^2}{E_i}$$ Basically, he just subtracts off 0.5 everywhere. --->
</section>
<section id="卡方檢定的效果量" class="level2" data-number="10.4">
<h2 data-number="10.4" class="anchored" data-anchor-id="卡方檢定的效果量"><span class="header-section-number">10.4</span> 卡方檢定的效果量</h2>
<p>正如我們在 <a href="09-Hypothesis-testing.html#sec-Effect-size-sample-size-and-power"><span>小單元&nbsp;9.8</span></a> 中早先討論的，要求研究人員報告某種效應量測的情況越來越普遍。因此，假設您已經進行了卡方檢定，結果顯示具有顯著性。所以您現在知道您的變項之間存在某種關聯（獨立性檢定）或與指定機率的某種偏差（適合度檢定）。現在，您想報告一個效應量測。也就是說，假設存在關聯或偏差，其強度如何？</p>
<p>您可以選擇報告幾種不同的測量值，並使用幾種不同的工具來計算它們。我不會討論所有這些測量值，而是將重點放在最常報告的效應大小測量值上。</p>
<p>默認情況下，人們最常報告的兩個度量是 <span class="math inline">\(\phi\)</span> 統計量，以及稍稍優越的版本，稱為克拉默的 <span class="math inline">\(V\)</span> 。</p>
<p>[額外的技術細節<a href="#fn15" class="footnote-ref" id="fnref15" role="doc-noteref"><sup>15</sup></a>]</p>
<p>完成後，這似乎是一個相當受歡迎的度量標準，可能是因為它易於計算，並且給出的答案並不是完全愚蠢的。有了克拉默的 <span class="math inline">\(V\)</span>，您知道這個值確實在 0（完全無關聯）和 1（完全關聯）之間變化。</p>

<!--- As we discussed earlier in @sec-Effect-size-sample-size-and-power, it's becoming commonplace to ask researchers to report some measure of effect size. So, let's suppose that you've run your chi-square test, which turns out to be significant. So you now know that there is some association between your variables (independence test) or some deviation from the specified probabilities (goodness-of-fit test). Now you want to report a measure of effect size. That is, given that there is an association or deviation, how strong is it?

There are several different measures that you can choose to report, and several different tools that you can use to calculate them. I won't discuss all of them but will instead focus on the most commonly reported measures of effect size.

By default, the two measures that people tend to report most frequently are the $\phi$ statistic and the somewhat superior version, known as Cramér's $V$ .

[Additional technical detail [^10-categorical-data-analysis-15]]

[^10-categorical-data-analysis-15]: Mathematically, they're very simple. To calculate the $\phi$ statistic, you just divide your $X^2$ value by the sample size, and take the square root: $$\phi=\sqrt{\frac{X^2}{N}}$$ The idea here is that the $\phi$ statistic is supposed to range between 0 (no association at all) and 1 (perfect association), but it doesn't always do this when your contingency table is bigger than $2 \times 2$ , which is a total pain. For bigger tables it's actually possible to obtain $\phi > 1$, which is pretty unsatisfactory. So, to correct for this, people usually prefer to report the $V$ statistic proposed by @Cramer1946. It's a pretty simple adjustment to $\phi$. If you've got a contingency table with r rows and c columns, then define $k = min(r, c)$ to be the smaller of the two values. If so, then Cramér's $V$ statistic is $$V=\sqrt{\frac{X^2}{N(k-1)}}$$

And you're done. This seems to be a fairly popular measure, presumably because it's easy to calculate, and it gives answers that aren't completely silly. With Cramér's $V$, you know that the value really does range from 0 (no association at all) to 1 (perfect association). --->
</section>
<section id="卡方檢定的適用條件" class="level2" data-number="10.5">
<h2 data-number="10.5" class="anchored" data-anchor-id="卡方檢定的適用條件"><span class="header-section-number">10.5</span> 卡方檢定的適用條件</h2>
<p>所有統計檢驗都有一定的假設，通常檢查這些假設是否符合是一個好主意。對於本章迄今為止討論的卡方檢驗，其假設包括：</p>
<ul>
<li><em>期望頻率足夠大</em>。還記得我們在上一節看到的 <span class="math inline">\(\chi^2\)</span> 抽樣分佈是如何產生的嗎？因為二項分佈非常類似於正態分佈，正如我們在 <a href="07-Introduction-to-probability.html"><span>單元&nbsp;7</span></a> 中討論的那樣，這只有在觀察次數足夠多的情況下才成立。實際上，這意味著所有的期望頻率都需要相對較大。什麼是合理的大小？意見不一，但默認的假設似乎是你通常希望看到所有的期望頻率都大於大約5，儘管對於更大的表格，如果至少80%的期望頻率在5以上，並且沒有一個低於1，那可能還可以。然而，從我所能發現的資料（例如， <span class="citation" data-cites="Cochran1954">Cochran (<a href="References.html#ref-Cochran1954" role="doc-biblioref">1954</a>)</span> ）來看，這些似乎是作為粗略指導原則提出的，而不是硬性規定，而且它們似乎有些保守 <span class="citation" data-cites="Larntz1978">(<a href="References.html#ref-Larntz1978" role="doc-biblioref">Larntz, 1978</a>)</span>。</li>
<li><em>資料彼此獨立</em>。卡方檢驗的一個稍微隱藏的假設是，你必須真正相信觀察結果是獨立的。我舉個例子。假設我對在某個特定醫院出生的男嬰的比例感興趣。我在產科病房走來走去，觀察到20個女孩和只有10個男孩。看起來是相當明顯的差異，對吧？但稍後，原來我實際上走進了同一個病房10次，事實上我只看到了2個女孩和1個男孩。現在不那麼令人信服了，是吧？我的原始30個觀察結果大量地不獨立，實際上只相當於3個獨立的觀察結果。顯然這是一個極端（而且非常愚蠢）的例子，但它說明了基本問題。非獨立性會“搞砸事情”。有時它會導致你錯誤地拒絕虛無假設，就像愚蠢的醫院例子那樣，但它也可能朝相反的方向發展。為了給出一個稍微不那麼愚蠢的例子，讓我們考慮一下如果我對卡片實驗做了一些不同的嘗試會怎麼樣。假設我不是要求200個人嘗試想像隨機抽取一張卡片，而是要求50個人選擇4張卡片。其中一種可能是<em>每個人</em>都選擇一張紅心、一張梅花、一張方塊和一張黑桃（符合“代表性啟發法則”<span class="citation" data-cites="Tversky1974">(<a href="References.html#ref-Tversky1974" role="doc-biblioref">Tversky &amp; Kahneman, 1974</a>)</span>）。這是人們的高度非隨機行為，但在這種情況下，我對四種花色都會得到50的觀察頻率。對於這個例子，觀察結果非獨立性（因為你選擇的四張卡片之間將彼此關聯）實際上導致了相反的效果，即錯誤地保留了虛無假設。</li>
</ul>
<p>如果你碰巧處於獨立性受到違反的情況，你可以使用 McNemar 檢驗（我們將討論）或 Cochran 檢驗（我們不會討論）。同樣，如果你的預期單元計數太小，可以查看 Fisher 確切檢驗。我們現在將轉向這些主題。</p>

<!--- All statistical tests make assumptions, and it's usually a good idea to check that those assumptions are met. For the chi-square tests discussed so far in this chapter, the assumptions are:

-   *Expected frequencies are sufficiently large*. Remember how in the previous section we saw that the $\chi^2$ sampling distribution emerges because the binomial distribution is pretty similar to a normal distribution? Well, like we discussed in @sec-Introduction-to-probability this is only true when the number of observations is sufficiently large. What that means in practice is that all of the expected frequencies need to be reasonably big. How big is reasonably big? Opinions differ, but the default assumption seems to be that you generally would like to see all your expected frequencies larger than about 5, though for larger tables you would probably be okay if at least 80% of the the expected frequencies are above 5 and none of them are below 1. However, from what I've been able to discover (e.g., @Cochran1954) these seem to have been proposed as rough guidelines, not hard and fast rules, and they seem to be somewhat conservative [@Larntz1978].
-   *Data are independent of one another*. One somewhat hidden assumption of the chi-square test is that you have to genuinely believe that the observations are independent. Here's what I mean. Suppose I'm interested in proportion of babies born at a particular hospital that are boys. I walk around the maternity wards and observe 20 girls and only 10 boys. Seems like a pretty convincing difference, right? But later on, it turns out that I'd actually walked into the same ward 10 times and in fact I'd only seen 2 girls and 1 boy. Not as convincing, is it? My original 30 observations were massively non-independent, and were only in fact equivalent to 3 independent observations. Obviously this is an extreme (and extremely silly) example, but it illustrates the basic issue. Non-independence "stuffs things up". Sometimes it causes you to falsely reject the null, as the silly hospital example illustrates, but it can go the other way too. To give a slightly less stupid example, let's consider what would happen if I'd done the cards experiment slightly differently Instead of asking 200 people to try to imagine sampling one card at random, suppose I asked 50 people to select 4 cards. One possibility would be that *everyone* selects one heart, one club, one diamond and one spade (in keeping with the "representativeness heuristic" [@Tversky1974]. This is highly non-random behaviour from people, but in this case I would get an observed frequency of 50 for all four suits. For this example the fact that the observations are non-independent (because the four cards that you pick will be related to each other) actually leads to the opposite effect, falsely retaining the null.

If you happen to find yourself in a situation where independence is violated, it may be possible to use the McNemar test (which we'll discuss) or the Cochran test (which we won't). Similarly, if your expected cell counts are too small, check out the Fisher exact test. It is to these topics that we now turn. --->
</section>
<section id="sec-The-Fisher-test" class="level2" data-number="10.6">
<h2 data-number="10.6" class="anchored" data-anchor-id="sec-The-Fisher-test"><span class="header-section-number">10.6</span> 費雪精確檢定</h2>
<p>如果你的單元計數太小，但你仍然想檢驗兩個變項是否獨立的虛無假設，該怎麼辦？一個答案是“收集更多資料”，但這太輕浮了。有很多情況下，進行此操作要么不可行，要么不道德。如果是這樣，統計學家有一種道德責任，為科學家提供更好的檢驗方法。在這個例子中， <span class="citation" data-cites="Fisher1922a">Fisher (<a href="References.html#ref-Fisher1922a" role="doc-biblioref">1922</a>)</span> 恰好提供了問題的正確答案。為了說明這個基本概念，假設我們正在分析一個田野實驗的資料，研究被指控為巫術的人的情感狀況，其中一些人正在被燒死。<a href="#fn16" class="footnote-ref" id="fnref16" role="doc-noteref"><sup>16</sup></a> 不幸的是，對於科學家來說（但對普通大眾來說相當幸運），實際上很難找到正在被點火的人，所以在某些情況下，單元計數非常小。<em>salem.csv</em> 資料的列聯表說明了這一點（<a href="#tbl-tab14-9">表&nbsp;<span>10.9</span></a>）。</p>

<!-- What should you do if your cell counts are too small, but you'd still like to test the null hypothesis that the two variables are independent? One answer would be "collect more data", but that's far too glib There are a lot of situations in which it would be either infeasible or unethical do that. If so, statisticians have a kind of moral obligation to provide scientists with better tests. In this instance, @Fisher1922a kindly provided the right answer to the question. To illustrate the basic idea let's suppose that we're analysing data from a field experiment looking at the emotional status of people who have been accused of Witchcraft, some of whom are currently being burned at the stake.[^10-categorical-data-analysis-16] Unfortunately for the scientist (but rather fortunately for the general populace), it's actually quite hard to find people in the process of being set on fire, so the cell counts are awfully small in some cases. A contingency table of the *salem.csv* data illustrates the point (@tbl-tab14-9).

[^10-categorical-data-analysis-16]: This example is based on a joke article published in the *Journal of Irreproducible Results* --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab14-9" class="anchored">
<table id="tab:tbl-tab14-9" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表&nbsp;10.9: salem.csv 資料的列聯表</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;"></td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">happy</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">FALSE</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">on.fire</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">FALSE</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">3</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">10</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;"></td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">TRUE</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">3</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>查看這些資料，你會很難不懷疑沒有被點火的人比正在被點火的人更可能感到快樂。然而，由於樣本量很小，卡方檢驗使得這一點很難檢驗。所以，作為一個不想被點火的人，我<em>非常</em>希望能得到比這更好的答案。這就是<strong>費雪精確檢定（Fisher’s exact test）</strong><span class="citation" data-cites="Fisher1922a">(<a href="References.html#ref-Fisher1922a" role="doc-biblioref">Fisher, 1922</a>)</span> 派上用場的地方。</p>
<p>費雪精確檢定的運作方式與卡方檢定（事實上，在本書中我談論的任何其他假設檢定）有所不同，因為它沒有檢定統計量，而是“直接”計算 p 值。我將解釋該檢定在 <span class="math inline">\(2 \times 2\)</span> 列聯表中的運作基本原理。與以前一樣，讓我們使用一些符號（<a href="#tbl-tab14-10">表&nbsp;<span>10.10</span></a>）。</p>

<!--- Looking at this data, you'd be hard pressed not to suspect that people not on fire are more likely to be happy than people on fire. However, the chi-square test makes this very hard to test because of the small sample size. So, speaking as someone who doesn't want to be set on fire, I'd *really* like to be able to get a better answer than this. This is where **費雪精確檢定(Fisher's exact test)** [@Fisher1922a] comes in very handy.

The Fisher exact test works somewhat differently to the chi-square test (or in fact any of the other hypothesis tests that I talk about in this book) insofar as it doesn't have a test statistic, but it calculates the p-value "directly". I'll explain the basics of how the test works for a $2 \times 2$ contingency table. As before, let's have some notation (@tbl-tab14-10). --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab14-10" class="anchored">
<table id="tab:tbl-tab14-10" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表&nbsp;10.10: 費雪精確檢定的符號</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;"></td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">Happy</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">Sad</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">Total</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Set on fire</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(O_{11}\)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(O_{12}\)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(R_{1}\)</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Not set on fire</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(O_{21}\)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(O_{22}\)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(R_{2}\)</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Total</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(C_{1}\)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(C_{2}\)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(N\)</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>為了構建檢定，費雪將行和列總數（<span class="math inline">\(R_1, R_2, C_1\)</span> 和 <span class="math inline">\(C_2\)</span>）都視為已知的固定量，然後計算在給定這些總數的情況下，我們會得到我們所觀察到的頻率（<span class="math inline">\(O_{11}, O_{12}, O_{21}\)</span> 和 <span class="math inline">\(O_{22}\)</span>）的機率。在我們在 <a href="07-Introduction-to-probability.html"><span>單元&nbsp;7</span></a> 中開發的表示法中，這是寫作：</p>
<p><span class="math display">\[P(O_{11}, O_{12}, O_{21}, O_{22} \text{ | } R_1, R_2, C_1, C_2)\]</span> 並且如您所料，弄清楚這個機率是什麼有點困難。但事實證明，這個機率是由一個稱為超幾何分佈的分佈描述的。要計算我們的 p 值，我們必須計算觀察到這個特定表格或者一個更“極端”的表格的機率。<a href="#fn17" class="footnote-ref" id="fnref17" role="doc-noteref"><sup>17</sup></a> 在 20 世紀 20 年代，即使在最簡單的情況下，計算這個和也是令人生畏的，但如今只要表格不是太大，樣本量不是太大，這就相當容易了。概念上棘手的問題是弄清楚一個列聯表比另一個列聯表更“極端”的含義。最簡單的解決方案是說，機率最低的表格是最極端的。這將給我們 p 值。</p>
<p>您可以在 jamovi 中的“列聯表”分析中的“統計”選項中的復選框中指定此檢定。當您使用 <em>salem.csv</em> 文件中的資料執行此操作時，費雪精確檢定統計量將顯示在結果中。我們在這里感興趣的主要是 p 值，這個例子中 p 值足夠小（p = .036），足以證明拒絕那些正在燃燒的人和沒有燃燒的人一樣快樂的虛無假設。參見 <a href="#fig-fig14-7">圖&nbsp;<span>10.7</span></a>。</p>
<!---在這個例子中，我們使用了費雪精確檢定，該檢定使我們能夠在樣本量較小的情況下仍然對資料進行檢驗。通過這種方法，我們發現了正在燃燒的人和沒有燃燒的人之間的快樂程度存在顯著差異。--->

<!--- In order to construct the test Fisher treats both the row and column totals $(R_1, R_2, C_1 \text{ and } C_2)$ as known, fixed quantities and then calculates the probability that we would have obtained the observed frequencies that we did $(O_{11}, O_{12}, O_{21} \text{ and } O_{22})$ given those totals. In the notation that we developed in @sec-Introduction-to-probability this is written:

$$P(O_{11}, O_{12}, O_{21}, O_{22}  \text{ | } R_1, R_2, C_1, C_2)$$ and as you might imagine, it's a slightly tricky exercise to figure out what this probability is. But it turns out that this probability is described by a distribution known as the hypergeometric distribution. What we have to do to calculate our p-value is calculate the probability of observing this particular table or a table that is *"more extreme"*. [^10-categorical-data-analysis-17] Back in the 1920s, computing this sum was daunting even in the simplest of situations, but these days it's pretty easy as long as the tables aren't too big and the sample size isn't too large. The conceptually tricky issue is to figure out what it means to say that one contingency table is more "extreme" than another. The easiest solution is to say that the table with the lowest probability is the most extreme. This then gives us the p-value.

[^10-categorical-data-analysis-17]: Not surprisingly, the Fisher exact test is motivated by Fisher's interpretation of a p-value, not Neyman's! See @sec-The-p-value-of-a-test.

You can specify this test in jamovi from a check box in the 'Statistics' options of the 'Contingency Tables' analysis. When you do this with the data from the *salem.csv* file, the Fisher exact test statistic is shown in the results. The main thing we're interested in here is the p-value, which in this case is small enough (p = .036) to justify rejecting the null hypothesis that people on fire are just as happy as people not on fire. See @fig-fig14-7. --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-7" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig10-7.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption class="figure-caption">圖&nbsp;10.7: jamovi 中的費雪精確檢定分析</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-The-McNemar-test" class="level2" data-number="10.7">
<h2 data-number="10.7" class="anchored" data-anchor-id="sec-The-McNemar-test"><span class="header-section-number">10.7</span> 麥內瑪檢定</h2>
<p>假設您被聘請為<em>澳大利亞通用政治黨</em>(AGPP)工作<a href="#fn18" class="footnote-ref" id="fnref18" role="doc-noteref"><sup>18</sup></a>，您的工作的一部分是了解AGPP政治廣告的有效性。因此，您決定組織一個包含<span class="math inline">\(N = 100\)</span>人的樣本，讓他們觀看AGPP的廣告。在他們看到任何內容之前，您問他們是否打算投票支持AGPP，然後在播放廣告之後再問他們一遍，看看有沒有人改變主意。顯然，如果你擅長你的工作，你還會做很多其他事情，但讓我們考慮一下這個簡單的實驗。描述資料的一種方法是通過 <a href="#tbl-tab14-11">表&nbsp;<span>10.11</span></a> 中顯示的列聯表。</p>

<!--- Suppose you've been hired to work for the *Australian Generic Political Party* (AGPP), and part of your job is to find out how effective the AGPP political advertisements are. So you decide to put together a sample of $N = 100$ people and ask them to watch the AGPP ads. Before they see anything, you ask them if they intend to vote for the AGPP, and then after showing the ads you ask them again to see if anyone has changed their minds. Obviously, if you're any good at your job, you'd also do a whole lot of other things too, but let's consider just this one simple experiment. One way to describe your data is via the contingency table shown in @tbl-tab14-11. --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab14-11" class="anchored">
<table id="tab:tbl-tab14-11" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表&nbsp;10.11: 帶有AGPP政治廣告資料的列聯表</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;"></td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">Before</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">After</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">Total</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Yes</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">30</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">10</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">40</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">No</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">70</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">90</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">160</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Total</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">100</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">100</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">200</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>首先，您可能會認為這種情況適合用皮爾森<span class="math inline">\(\chi^2\)</span>檢驗獨立性（如[獨立性（或關聯性）的<span class="math inline">\(\chi^2\)</span>檢驗]）。然而，稍加思考就會發現我們遇到了一個問題。我們有100名參與者，但卻有200個觀察值。這是因為每個人在”之前”的列和”之後”的列中都給出了答案。這意味著這200個觀察值彼此之間並不獨立。如果選民A第一次說“是”，選民B說“否”，那麼您就可以預期選民A第二次比選民B更可能說“是”！由於獨立性假設的違反，這意味著通常的<span class="math inline">\(\chi^2\)</span>檢驗不會給出可靠的答案。現在，如果這是一個非常不常見的情況，我不會浪費你的時間來討論它。但它並不罕見。這是一個標準的重複測量設計，而到目前為止，我們考慮的所有測試都無法處理它。哎呀。</p>
<p>問題的解決方案是麥內瑪（McNemar，1947）發表的。訣竅是先用稍微不同的方式整理資料（<a href="#tbl-tab14-12">表&nbsp;<span>10.12</span></a>）。</p>
<!--- At first pass, you might think that this situation lends itself to the Pearson $\chi^2$ test of independence (as per [The $\chi^2$ test of independence (or association)]). However, a little bit of thought reveals that we've got a problem. We have 100 participants but 200 observations. This is because each person has provided us with an answer in both the before column and the after column. What this means is that the 200 observations aren't independent of each other. If voter A says "yes" the first time and voter B says "no", then you'd expect that voter A is more likely to say "yes" the second time than voter B! The consequence of this is that the usual $\chi^2$ test won't give trustworthy answers due to the violation of the independence assumption. Now, if this were a really uncommon situation, I wouldn't be bothering to waste your time talking about it. But it's not uncommon at all. This is a standard repeated measures design, and none of the tests we've considered so far can handle it. Eek.

The solution to the problem was published by McNemar (1947). The trick is to start by tabulating your data in a slightly different way (@tbl-tab14-12). --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab14-12" class="anchored">
<table id="tab:tbl-tab14-12" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表&nbsp;10.12: 當你有重複測量資料時，以不同的方式整理資料</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;"></td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">Before: Yes</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">Before: No</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">Total</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">After: Yes</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">5</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">5</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">10</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">After: No</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">25</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">65</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">90</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Total</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">30</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">70</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">100</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>接下來，讓我們思考一下我們的虛無假設是什麼：它是“之前”測試和“之後”測試中有相同比例的人說：“是的，我會投票支持AGPP。” 由於我們已經重新整理了資料，這意味著我們現在正在測試行總數和列總數來自相同分佈的假設。因此，麥內瑪檢驗中的虛無假設是邊際同質性。也就是說，行總數和列總數具有相同的分佈：<span class="math inline">\(P_a + P_b = P_a + P_c\)</span>，同樣地，<span class="math inline">\(P_c + P_d = P_b + P_d\)</span>。注意，這意味著虛無假設實際上簡化為Pb = Pc。換句話說，就麥內瑪檢驗而言，只有這個表格中的對角線條目（即b和c）才是重要的！注意到這一點後，<strong>麥內瑪邊際同質性檢定(McNemar test of marginal homogeneity)</strong>與通常的<span class="math inline">\(\chi^2\)</span>檢驗沒有什麼不同。在應用Yates修正後，我們的檢驗統計量變為：</p>
<p><span class="math display">\[\chi^2=\frac{(|b-c|-0.5)^2}{b+c}\]</span> 或者，恢復到我們在本章前面使用的表示法：</p>
<p><span class="math display">\[\chi^2=\frac{(|O_{12}-O_{21}|-0.5)^2}{O_{12}+O_{21}}\]</span> 這個統計量具有<span class="math inline">\(\chi^2\)</span>分佈（近似），自由度df = 1。然而，請記住，就像其他<span class="math inline">\(\chi^2\)</span>檢驗一樣，它只是一個近似值，因此您需要預期較大的單元格計數才能使其正常工作。</p>

<!--- Next, let's think about what our null hypothesis is: it's that the "before" test and the "after" test have the same proportion of people saying "Yes, I will vote for AGPP". Because of the way that we have rewritten the data, it means that we're now testing the hypothesis that the row totals and column totals come from the same distribution. Thus, the null hypothesis in McNemar's test is that we have "marginal homogeneity". That is, the row totals and column totals have the same distribution: $P_a + P_b = P_a + P_c$ and similarly that $P_c + P_d = P_b + P_d$. Notice that this means that the null hypothesis actually simplifies to Pb = Pc. In other words, as far as the McNemar test is concerned, it's only the off-diagonal entries in this table (i.e., b and c) that matter! After noticing this, the **麥內瑪邊際同質性檢定(McNemar test of marginal homogeneity)** is no different to a usual $\chi^2$ test. After applying the Yates correction, our test statistic becomes:

$$\chi^2=\frac{(|b-c|-0.5)^2}{b+c}$$ or, to revert to the notation that we used earlier in this chapter:

$$\chi^2=\frac{(|O_{12}-O_{21}|-0.5)^2}{O_{12}+O_{21}}$$ and this statistic has a $\chi^2$ distribution (approximately) with df = 1. However, remember that just like the other $\chi^2$ tests it's only an approximation, so you need to have reasonably large expected cell counts for it to work. --->
<section id="sec-doing-The-McNemar-test" class="level3" data-number="10.7.1">
<h3 data-number="10.7.1" class="anchored" data-anchor-id="sec-doing-The-McNemar-test"><span class="header-section-number">10.7.1</span> 實作麥內瑪檢定</h3>
<p>現在您已經了解麥內瑪檢驗的所有內容，讓我們實際運行一個。<em>agpp.csv</em> 文件包含了我之前討論過的原始資料。<em>agpp</em> 資料集包含三個變項，一個id變項標記資料集中的每個參與者（我們將在片刻之後看到這有什麼用），一個<strong>response_before</strong> 變項記錄了當他們第一次被問到這個問題時的答案，以及一個response_after變項顯示他們在第二次被問到同樣問題時給出的答案。注意每個參與者在這個資料集中只出現一次。在jamovi中，轉到 ‘Analyses’ - ‘Frequencies’ - ‘Contingency Tables’ - ‘Paired Samples’ 分析，並將<strong>response_before</strong> 放入 ‘Rows’ 框，將<strong>response_after</strong> 放入 ‘Columns’ 框。然後，您將在結果窗口中獲得一個列聯表，麥內瑪檢驗的統計資料就在它下面，參見 <a href="#fig-fig14-8">圖&nbsp;<span>10.8</span></a> 。</p>

<!--- Now that you know what the McNemar test is all about, lets actually run one. The *agpp.csv* file contains the raw data that I discussed previously. The *agpp* data set contains three variables, an id variable that labels each participant in the data set (we'll see why that's useful in a moment), a **response_before** variable that records the person's answer when they were asked the question the first time, and a response_after variable that shows the answer that they gave when asked the same question a second time. Notice that each participant appears only once in this data set. Go to the 'Analyses' - 'Frequencies' - 'Contingency Tables' - 'Paired Samples' analysis in jamovi, and move **response_before** into the 'Rows' box, and **response_after** into the 'Columns' box. You will then get a contingency table in the results window, with the statistic for the McNemar test just below it, see @fig-fig14-8. --->
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-8" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig10-8.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">圖&nbsp;10.8: jamovi中的麥內瑪檢驗輸出</figcaption>
</figure>
</div>
</div>
</div>
<p>我們完成了。我們剛剛運行了一個麥內瑪檢驗，以確定人們在廣告後是否和廣告前一樣有可能投票支持AGPP。檢驗是顯著的（<span class="math inline">\(\chi^2(1)= 12.03, p&lt; .001\)</span>），表明他們並非如此。事實上，看起來廣告產生了負面影響：人們在看過廣告後，投票支持AGPP的可能性更低。考慮到典型政治廣告的質量，這是很合理的。</p>
<!--- And we're done. We've just run a McNemar's test to determine if people were just as likely to vote AGPP after the ads as they were before hand. The test was significant ($\chi^2(1)= 12.03, p< .001)$, suggesting that they were not. And, in fact it looks like the ads had a negative effect: people were less likely to vote AGPP after seeing the ads. Which makes a lot of sense when you consider the quality of a typical political advertisement. --->
</section>
<section id="sec-difference-McNemar-independence" class="level3" data-number="10.7.2">
<h3 data-number="10.7.2" class="anchored" data-anchor-id="sec-difference-McNemar-independence"><span class="header-section-number">10.7.2</span> 與獨立性檢定有可分別?</h3>
<p>讓我們回到本章的開頭，再次查看卡片資料集。如果您回憶一下，我描述的實際實驗設計涉及人們進行兩次選擇。因為我們有關於每個人第一次選擇和第二次選擇的信息，我們可以構建以下列聯表，用於將第一次選擇與第二次選擇交叉列聯（<a href="#tbl-tab14-13">表&nbsp;<span>10.13</span></a>）。</p>

<!--- Let's go all the way back to the beginning of the chapter and look at the cards data set again. If you recall, the actual experimental design that I described involved people making two choices. Because we have information about the first choice and the second choice that everyone made, we can construct the following contingency table that cross-tabulates the first choice against the second choice (@tbl-tab14-13). --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab14-13" class="anchored">
<table id="tab:tbl-tab14-13" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表&nbsp;10.13: 用<em>Randomness.omv</em>（卡片）資料交叉列聯第一次與第二次選擇</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;"></td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">Before: Yes</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">Before: No</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">Total</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">After: Yes</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(a \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(b \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(a + b \)</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">After: No</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(c \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(d \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(c + d \)</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Total</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(a+c \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(b+d \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(n \)</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>假設我想知道第二次選擇是否取決於第一次選擇。這是獨立性檢驗有用的地方，我們試圖做的是看看這個表格的行和列之間是否存在某種關係。</p>
<p>另外，假設我想知道平均而言，第二次選擇的花色頻率是否與第一次選擇不同。在這種情況下，我真正想做的是看看行總數是否不同於列總數。這就是您使用麥內瑪檢驗的時候。</p>
<p>這些不同分析產生的不同統計資料顯示在 <a href="#fig-fig14-9">圖&nbsp;<span>10.9</span></a> 中。注意結果是不同的！這些檢驗並不相同。</p>

<!--- Suppose I wanted to know whether the choice you make the second time is dependent on the choice you made the first time. This is where a test of independence is useful, and what we're trying to do is see if there's some relationship between the rows and columns of this table.

Alternatively, suppose I wanted to know if on average, the frequencies of suit choices were different the second time than the first time. In that situation, what I'm really trying to see is if the row totals are different from the column totals. That's when you use the McNemar test.

The different statistics produced by these different analyses are shown in @fig-fig14-9. Notice that the results are different! These aren't the same test. --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig14-9" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig10-9.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption class="figure-caption">圖&nbsp;10.9: Randomness.omv（卡片）資料中的獨立與成對（麥內瑪）</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="本章小結" class="level2" data-number="10.8">
<h2 data-number="10.8" class="anchored" data-anchor-id="本章小結"><span class="header-section-number">10.8</span> 本章小結</h2>
<p>本章的學習重點有：</p>
<ul>
<li><a href="10-Categorical-data-analysis.html#卡方適合度檢定">卡方適合度檢定</a>用於你的表列資料是來自不同類別的觀察次數，虛無假設是可相互比較的已知機率。</li>
<li><a href="10-Categorical-data-analysis.html#卡方獨立性檢定">卡方獨立性或關聯性檢定</a>用於你的資料是能化為列聯表的觀察次數。虛無假設是兩種變項之間沒有關聯性。</li>
<li>列聯表的<a href="10-Categorical-data-analysis.html#卡方檢定的效果量">效果量</a>有多種測量方法。在此介紹最常見的Cramér’s V。</li>
<li>上述的卡方檢定法有兩種<a href="10-Categorical-data-analysis.html#卡方檢定的適用條件">適用條件</a>：期望值次數夠大，觀察值彼此獨立。如果期望值次數不夠大，可以使用<a href="10-Categorical-data-analysis.html#sec-The-Fisher-test">費雪精確檢定</a>；如果觀察值並非彼此獨立，可以使用<a href="10-Categorical-data-analysis.html#sec-The-McNemar-test">麥內瑪檢定</a>。</li>
</ul>
<p>如果想學習更多類別資料分析方法，推薦閱讀 <span class="citation" data-cites="Agresti1996">Agresti (<a href="References.html#ref-Agresti1996" role="doc-biblioref">1996</a>)</span> 的專書”類別資料分析導論”。如果基礎教科書無法滿足你的需要，或者未提供解決手上問題的方法，可以參考 <span class="citation" data-cites="Agresti2002">Agresti (<a href="References.html#ref-Agresti2002" role="doc-biblioref">2002</a>)</span> 的進階書藉。因為是進階書，建議先充分理解導論再來學習進階教科書。</p>

<!---
The key ideas discussed in this chapter are:

- [The $\chi^2$ (chi-square) goodness-of-fit test] is used when you have a table of observed frequencies of different categories, and the null hypothesis gives you a set of "known" probabilities to compare them to.
- [The $\chi^2$ test of independence (or association)] is used when you have a contingency table (cross-tabulation) of two categorical variables. The null hypothesis is that there is no relationship or association between the variables.
- [Effect size] for a contingency table can be measured in several ways. In particular we noted the Cramér's $V$ statistic.
- Both versions of the Pearson test rely on two assumptions: that the expected frequencies are sufficiently large, and that the observations are independent ([Assumptions of the test(s)]. [The Fisher exact test] can be used when the expected frequencies are small. [The McNemar test] can be used for some kinds of violations of independence.

If you're interested in learning more about categorical data analysis a good first choice would be @Agresti1996 which, as the title suggests, provides an Introduction to Categorical Data Analysis. If the introductory book isn't enough for you (or can't solve the problem you're working on) you could consider @Agresti2002, Categorical Data Analysis. The latter is a more advanced text, so it's probably not wise to jump straight from this book to that one. --->


<div id="refs" class="references csl-bib-body hanging-indent" data-line-spacing="2" role="list" style="display: none">
<div id="ref-Agresti1996" class="csl-entry" role="listitem">
Agresti, A. (1996). <em>An introduction to categorical data analysis</em>. Wiley.
</div>
<div id="ref-Agresti2002" class="csl-entry" role="listitem">
Agresti, A. (2002). <em>Categorical data analysis</em> (2nd ed.). Wiley.
</div>
<div id="ref-Cochran1954" class="csl-entry" role="listitem">
Cochran, W. G. (1954). The <span class="math inline">\(\chi^2\)</span> test of goodness of fit. <em>The Annals of Mathematical Statistics</em>, <em>23</em>, 315–345.
</div>
<div id="ref-Cramer1946" class="csl-entry" role="listitem">
Cramer, H. (1946). <em>Mathematical methods of statistics</em>. Princeton University Press.
</div>
<div id="ref-Fisher1922a" class="csl-entry" role="listitem">
Fisher, R. A. (1922). On the interpretation of <span class="math inline">\(\chi^2\)</span> from contingency tables, and the calculation of <span class="math inline">\(p\)</span>. <em>Journal of the Royal Statistical Society</em>, <em>84</em>, 87–94.
</div>
<div id="ref-Hogg2005" class="csl-entry" role="listitem">
Hogg, R. V., McKean, J. V., &amp; Craig, A. T. (2005). <em>Introduction to mathematical statistics</em> (6th ed.). Pearson.
</div>
<div id="ref-Larntz1978" class="csl-entry" role="listitem">
Larntz, K. (1978). Small-sample comparisons of exact levels for chi-squared goodness-of-fit statistics. <em>Journal of the American Statistical Association</em>, <em>73</em>, 253–263.
</div>
<div id="ref-Pearson1900" class="csl-entry" role="listitem">
Pearson, K. (1900). On the criterion that a given system of deviations from the probable in the case of a correlated system of variables is such that it can be reasonably supposed to have arisen from random sampling. <em>Philosophical Magazine</em>, <em>50</em>, 157–175.
</div>
<div id="ref-Sokal1994" class="csl-entry" role="listitem">
Sokal, R. R., &amp; Rohlf, F. J. (1994). <em>Biometry: The principles and practice of statistics in biological research</em> (3rd ed.). Freeman.
</div>
<div id="ref-Tversky1974" class="csl-entry" role="listitem">
Tversky, A., &amp; Kahneman, D. (1974). Judgment under uncertainty: Heuristics and biases. <em>Science</em>, <em>185</em>(4157), 1124–1131.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>繁體中文報告常直接稱呼“卡方”。<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>向量是由相同測量尺度的資料值所構成的序列。<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>如果我們讓 k 指的是總類別數（即，對於我們的卡片資料，k = 4），則 <span class="math inline">\(\chi^2\)</span> 統計量由以下公式給出：<span class="math display">\[\chi^2 = \sum_{i=1}^{k} \frac{(O_i-E_i)^2}{E_i}\]</span> 直觀地說，如果 <span class="math inline">\(chi^2\)</span> 很小，那麼觀察到的資料 Oi 與虛無假設預測的 <span class="math inline">\(E_i\)</span> 非常接近，因此我們需要一個很大的 <span class="math inline">\(\chi^2\)</span> 統計量來拒絕虛無假設。<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>如果將適合度統計量的方程式重寫為 k - 1 個獨立東西之和，您將得到“正確的”抽樣分佈，即具有 k - 1 自由度的卡方分佈。在這本入門書中，展示這麼多細節的數學超出了範疇。我只想給您一個為什麼適合度統計量與卡方分佈相關的感覺。<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>我有責任指出，這是一個過於簡化的說法。它適用於很多情況，但偶爾我們會遇到自由度值不是整數的情況。不要讓這個問題過於困擾您；遇到這個問題時，只需提醒自己“自由度”實際上是一個有點混亂的概念，而且我在這裡告訴您的簡單故事並不是全部故事。對於一個入門課程，通常最好堅持簡單的故事，但我認為最好警告您期望這個簡單的故事會崩潰。如果我沒有給您這個警告，您可能會在看到 <span class="math inline">\(df = 3.4\)</span> 或類似的東西時開始困惑（錯誤地）認為您理解錯了我教給您的東西，而不是（正確地）意識到有些事情是我沒有告訴您的。<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>實際上，樣本大小並不總是固定的。例如，我們可能在固定時間內運行實驗，參與人數取決於有多少人出現。對於當前的目的，這並不重要<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>嗯，有點。如何報告統計資料的慣例在不同的學科之間有所不同。我傾向於堅持心理學的做法，因為這就是我的工作。但是，我認為向讀者提供足夠的信息，以便他們可以檢查你的結果的一般原則是相當普遍的。<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>對有些人來說，這個建議可能聽起來有點奇怪，或者至少與編寫技術報告的“通常”建議相衝突。通常，學生們被告知報告的“結果”部分是用來描述資料並報告統計分析，而“討論”部分是提供解釋的。這在某種程度上是對的，但我認為人們經常過於照字面解釋它。我通常的做法是在結果部分提供對資料的快速而簡單的解釋，以便我的讀者理解資料告訴我們什麼。然後，在討論中，我嘗試講述一個關於我的結果如何與其他科學文獻相適應的更大的故事。簡而言之，不要讓“解釋屬於討論”這個建議使你的結果部分變得難以理解。讓讀者明白你的意思更重要。<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>如果你一直在仔細閱讀，並且像我一樣是一個數學苛刻的人，那麼上一節中我寫卡方檢驗的方式可能會讓你有點困擾。你可能會想，用 “<span class="math inline">\(\chi^2(3) = 8.44\)</span>” 這樣寫感覺有點不對勁。畢竟，是適合度統計數等於8.44，所以我不應該寫 <span class="math inline">\(X^2 = 8.44\)</span> 或者 <span class="math inline">\(GOF = 8.44\)</span> 嗎？這似乎混淆了抽樣分布（即<span class="math inline">\(\chi^2\)</span>與df=3）與檢驗統計量（即<span class="math inline">\(X^2\)</span>）。可能性是你認為這是錯字，因為<span class="math inline">\(\chi\)</span>和X看起來非常相似。奇怪的是，這並非如此。寫 <span class="math inline">\(\chi^2\)</span>(3)= 8.44 本質上是一種高度縮略的寫法，表示“檢驗統計量的抽樣分布為<span class="math inline">\(\chi^2\)</span>(3)，檢驗統計量的值為8.44”。從某種意義上說，這有點愚蠢。有很多不同的檢驗統計量最終具有卡方抽樣分布。我們用於適合度檢驗的<span class="math inline">\(X^2\)</span>統計量只是眾多統計量中的一種（儘管是最常見的一種）。在一個明智、完全組織的世界裡，我們總是為檢驗統計量和抽樣分布分配一個單獨的名字。這樣，統計塊本身就可以告訴你研究者究竟計算了什麼。有時這確實是可能的。例如，Pearson適合度檢驗中使用的檢驗統計量寫作<span class="math inline">\(X^2\)</span>，但還有一種與G-test<span class="math inline">\(^a\)</span> <span class="citation" data-cites="Sokal1994">(<a href="References.html#ref-Sokal1994" role="doc-biblioref">Sokal &amp; Rohlf, 1994</a>)</span>關係密切的檢驗稱為G-test，其中檢驗統計量寫作<span class="math inline">\(G\)</span>。事實上，Pearson適合度檢驗和G-test都檢驗相同的虛無假設，抽樣分布完全相同（即，具有<span class="math inline">\(k-1\)</span>自由度的卡方分布）。如果我對卡片資料進行G-test而不是適合度檢驗，那麼我最終會得到一個檢驗統計量<span class="math inline">\(G = 8.65\)</span>，它略有不同於我之前得到的<span class="math inline">\(X^2 = 8.44\)</span>值，並產生稍微小一點的p值<span class="math inline">\(p = .034\)</span>。假設約定俗成地報告檢驗統計量，然後是抽樣分布，然後是p值。如果是這樣的話，這兩種情況將產生不同的統計塊：我原來的結果將寫成<span class="math inline">\(X^2 = 8.44\)</span>，<span class="math inline">\(\chi^2(3)\)</span>，<span class="math inline">\(p = .038\)</span>，而使用G-test的新版本將寫成<span class="math inline">\(G = 8.65\)</span>，<span class="math inline">\(\chi^2(3)\)</span>，<span class="math inline">\(p = .034\)</span>。然而，使用縮略報告標準，原始結果寫作<span class="math inline">\(\chi^2(3) = 8.44, p =.038\)</span>，新結果寫作<span class="math inline">\(\chi^2(3) = 8.65, p = .034\)</span>，所以實際上不清楚我實際上運行了哪個檢驗。那麼為什麼我們不生活在一個統計塊的內容能唯一確定哪些檢驗被執行的世界呢？根本原因是生活是混亂的。我們（作為統計工具的用戶）希望它整齊、有序並且有組織。我們希望它像產品一樣被設計，但這不是生活的運作方式。統計是一門與其他任何學科一樣的智力學科，因此它是一個大規模的分布式、部分協作和部分競爭的項目，沒有人真正完全了解它。你和我作為資料分析工具的東西並非由統計之神的行為創造的。它們是由很多不同的人發明的，作為學術期刊中的論文發表，由很多其他人實施、糾正和修改，然後由其他人在教科書中向學生解釋。因此，有很多檢驗統計量甚至沒有名字，因此它們只是被賦予與相應抽樣分布相同的名字。稍後我們將看到，任何遵循<span class="math inline">\(\chi^2\)</span>分布的檢驗統計量通常被稱為“卡方統計量”，遵循<span class="math inline">\(t\)</span>分布的任何統計量被稱為“t統計量”，等等。但是，正如<span class="math inline">\(\chi^2\)</span>與<span class="math inline">\(G\)</span>的例子所說明的，具有相同抽樣分布的兩個不同事物仍然是不同的。因此，有時候明確表明你實際上運行的檢驗是很好的主意，特別是如果你在做一些不尋常的事情。如果你只說“卡方檢驗”，實際上並不清楚你在談論哪種檢驗。儘管如此，由於兩個最常見的卡方檢驗是適合度檢驗和獨立性檢驗，大多數具有統計培訓的讀者可能都能猜到。儘管如此，這仍然是需要注意的事情。—<span class="math inline">\(^a\)</span> 讓事情變得複雜的是，G-test是一整類被稱為似然比檢驗的檢驗的特例。我在這本書中沒有介紹LRT，但它們確實是值得了解的好東西。<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>技術說明。在我描述的測試方法中，假設列總數是固定的（即研究者打算調查87個機器人和93個人類），行總數是隨機的（即碰巧有28個人選擇了小狗）。根據我的數理統計教科書<span class="citation" data-cites="Hogg2005">(<a href="References.html#ref-Hogg2005" role="doc-biblioref">Hogg et al., 2005</a>)</span>的術語，我應該將這種情況稱為卡方同質性檢驗，並保留卡方獨立性檢驗一詞用於行總數和列總數都是實驗隨機結果的情況。在這本書的初稿中，我確實是這樣做的。然而，事實證明，這兩種測試是相同的，所以我將它們合併在一起。<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p>從技術上講，<span class="math inline">\(E_{ij}\)</span> 這裡是一個估計值，所以我應該寫成 <span class="math inline">\(\hat{E_{ij}}\)</span>。但既然沒有其他人這麼做，我也不會這麼做。<a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12"><p>現在我們已經弄清楚了如何計算期望頻率，根據我們在適配度檢驗中使用的策略，定義一個檢驗統計量是很容易的。實際上，這幾乎是相同的統計量。對於有 r 行和 c 列的列聯表，定義我們的 <span class="math inline">\(X^2\)</span> 統計量的方程式是 <span class="math display">\[X^2=\sum_{i=1}^{r}\sum_{j=1}^{c} \frac{(E_{ij}-O_{ij})^2}{E_{ij}}\]</span> 唯一的區別是我必須包含兩個求和符號（即 <span class="math inline">\(\sum\)</span> ）以表示我們要對行和列進行求和。<a href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn13"><p>現實生活中很多人都在擔心的問題。<a href="#fnref13" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn14"><p><a href="https://www.jstor.org/stable/2983604">葉氏（1934）</a> 提出了一個簡單的修正，將適合度統計量重新定義為：<span class="math display">\[\chi^{2}=\sum_{i}\frac{(|E_i-O_i|-0.5)^2}{E_i}\]</span> 基本上，他在所有地方都減去了 0.5。<a href="#fnref14" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn15"><p>從數學角度來看，它們非常簡單。要計算 <span class="math inline">\(\phi\)</span> 統計量，只需將您的 <span class="math inline">\(X^2\)</span> 值除以樣本大小，然後取平方根：<span class="math display">\[\phi=\sqrt{\frac{X^2}{N}}\]</span> 這裡的想法是，<span class="math inline">\(\phi\)</span> 統計量應該在 0（完全無關聯）和 1（完全關聯）之間變化，但是當您的列聯表大於 <span class="math inline">\(2 \times 2\)</span> 時，它並不總是這樣做，這非常麻煩。對於更大的表，實際上有可能獲得 <span class="math inline">\(\phi &gt; 1\)</span>，這是相當令人不滿意的。所以，為了糾正這個問題，人們通常更喜歡報告由 <span class="citation" data-cites="Cramer1946">Cramer (<a href="References.html#ref-Cramer1946" role="doc-biblioref">1946</a>)</span> 提出的 <span class="math inline">\(V\)</span> 統計量。它對 <span class="math inline">\(\phi\)</span> 的調整非常簡單。如果您有一個具有 r 行和 c 列的列聯表，那麼定義 <span class="math inline">\(k = min(r, c)\)</span> 為兩個值中較小的那個。如果是這樣，那麼克拉默的 <span class="math inline">\(V\)</span> 統計量為 <span class="math display">\[V=\sqrt{\frac{X^2}{N(k-1)}}\]</span><a href="#fnref15" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn16"><p>這個例子是基於在<em>Journal of Irreproducible Results</em>上發表的一篇玩笑文章。<a href="#fnref16" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn17"><p>毫不意外，費雪精確檢定是根據費雪對 p 值的解釋，而不是奈曼的！請參見 <a href="09-Hypothesis-testing.html#sec-The-p-value-of-a-test"><span>小單元&nbsp;9.5</span></a> 。<a href="#fnref17" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn18"><p>譯註~這是原作者虛構的政黨，現實中無此政黨或團體。詳見<a href="https://en.wikipedia.org/w/index.php?title=List_of_political_parties_in_Australia&amp;oldid=1149812960">維基百科條目</a>。<a href="#fnref18" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "已複製");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "已複製");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp("https:\/\/scgeeker\.github\.io\/lsj-book-zh_tw\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Prelude-Part-V.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">線性模型的學習取向</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./11-Comparing-two-means.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">比較單一與兩組平均值</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left"><a href="https://learnstatswithjamovi.com">用jamovi上手統計學</a></div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">電子書使用 <a href="https://quarto.org/">Quarto套件</a>創建</div>
  </div>
</footer>



</body></html>