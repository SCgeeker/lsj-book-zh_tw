<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-Hans" xml:lang="zh-Hans"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.427">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>用jamovi上手統計學 - 14&nbsp; 多因子變異數分析</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./15-Factor-Analysis.html" rel="next">
<link href="./13-Comparing-several-means-one-way-ANOVA.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "没有结果",
    "search-matching-documents-text": "匹配的文档",
    "search-copy-link-title": "复制搜索链接",
    "search-hide-matches-text": "隐藏其它匹配结果",
    "search-more-match-text": "更多匹配结果",
    "search-more-matches-text": "更多匹配结果",
    "search-clear-button-title": "清除",
    "search-detached-cancel-button-title": "取消",
    "search-submit-button-title": "提交",
    "search-label": "搜索"
  }
}</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['S$','S$'], ["\\[","\\]"] ]
      processEscapes: true
    }
  });
</script>
    

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="用jamovi上手統計學 - 14&nbsp; 多因子變異數分析">
<meta property="og:description" content="">
<meta property="og:image" content="https://scgeeker.github.io/lsj-book-zh_tw/images/fig14-1.png">
<meta property="og:site-name" content="用jamovi上手統計學">
<meta property="og:image:height" content="553">
<meta property="og:image:width" content="819">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="切换侧边栏导航" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Prelude-Part-V.html">統計方法</a></li><li class="breadcrumb-item"><a href="./14-Factorial-ANOVA.html"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">多因子變異數分析</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="切换侧边栏导航" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">用jamovi上手統計學</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/SCgeeker/lsj-book-zh_tw/" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./用jamovi上手統計學.pdf" rel="" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="切换深色模式"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="切换阅读器模式">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="搜索"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">&nbsp;</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">前言</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
 <span class="menu-text">新手須知</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false" aria-label="切換部分">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-Why-do-we-learn-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">為什麼要學習統計</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-A-brief-introduction-to-research-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">研究設計入門</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
 <span class="menu-text">jamovi初體驗</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="切換部分">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-Getting-started-with-jamovi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">與jamovi的第一次接觸</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">資料處理</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="切換部分">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-Descriptive-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">描述統計</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-Drawing-graphs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">繪製統計圖</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-Pragmatic-matters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">實務課題</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
 <span class="menu-text">統計理論</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="切換部分">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Prelude-Part-IV.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">中場故事</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-Introduction-to-probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">機率入門</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-Estimating-unknown-quantities-from-a-sample.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">運用樣本估計未知量數</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-Hypothesis-testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">假設檢定</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">統計方法</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="切換部分">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Prelude-Part-V.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">線性模型的學習取向</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-Categorical-data-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">類別資料分析</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-Comparing-two-means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">比較單一與兩組平均值</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-Correlation-and-linear-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">相關與線性迴歸</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-Comparing-several-means-one-way-ANOVA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">比較多組平均值(單因子變異數分析)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-Factorial-ANOVA.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">多因子變異數分析</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-Factor-Analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">因素分析</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
 <span class="menu-text">貝氏統計</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false" aria-label="切換部分">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-Bayesian-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">貝氏統計</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Epilogue.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">後記</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./References.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">參考資料</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">目录</h2>
   
  <ul>
  <li><a href="#平衡且無交互作用的因子設計分析" id="toc-平衡且無交互作用的因子設計分析" class="nav-link active" data-scroll-target="#平衡且無交互作用的因子設計分析"><span class="header-section-number">14.1</span> 平衡且無交互作用的因子設計分析</a>
  <ul class="collapse">
  <li><a href="#sec-What-hypotheses-are-we-testing" id="toc-sec-What-hypotheses-are-we-testing" class="nav-link" data-scroll-target="#sec-What-hypotheses-are-we-testing"><span class="header-section-number">14.1.1</span> 多因子設計是因應什麼樣的假設？</a></li>
  <li><a href="#使用jamovi完成多因子變異數分析" id="toc-使用jamovi完成多因子變異數分析" class="nav-link" data-scroll-target="#使用jamovi完成多因子變異數分析"><span class="header-section-number">14.1.2</span> 使用jamovi完成多因子變異數分析</a></li>
  <li><a href="#計算多因子變異數分析的平方差總和" id="toc-計算多因子變異數分析的平方差總和" class="nav-link" data-scroll-target="#計算多因子變異數分析的平方差總和"><span class="header-section-number">14.1.3</span> 計算多因子變異數分析的平方差總和</a></li>
  <li><a href="#計算自由度的規則" id="toc-計算自由度的規則" class="nav-link" data-scroll-target="#計算自由度的規則"><span class="header-section-number">14.1.4</span> 計算自由度的規則</a></li>
  <li><a href="#多因子與單因子變異數分析" id="toc-多因子與單因子變異數分析" class="nav-link" data-scroll-target="#多因子與單因子變異數分析"><span class="header-section-number">14.1.5</span> 多因子與單因子變異數分析</a></li>
  <li><a href="#解讀多因子變異數分析的結果" id="toc-解讀多因子變異數分析的結果" class="nav-link" data-scroll-target="#解讀多因子變異數分析的結果"><span class="header-section-number">14.1.6</span> 解讀多因子變異數分析的結果</a></li>
  </ul></li>
  <li><a href="#平衡且有交互作用的因子設計分析" id="toc-平衡且有交互作用的因子設計分析" class="nav-link" data-scroll-target="#平衡且有交互作用的因子設計分析"><span class="header-section-number">14.2</span> 平衡且有交互作用的因子設計分析</a>
  <ul class="collapse">
  <li><a href="#交互作用代表什麼" id="toc-交互作用代表什麼" class="nav-link" data-scroll-target="#交互作用代表什麼"><span class="header-section-number">14.2.1</span> 交互作用代表什麼？</a></li>
  <li><a href="#交互作用的自由度" id="toc-交互作用的自由度" class="nav-link" data-scroll-target="#交互作用的自由度"><span class="header-section-number">14.2.2</span> 交互作用的自由度</a></li>
  <li><a href="#使用jamovi完成多因子變異數分析-1" id="toc-使用jamovi完成多因子變異數分析-1" class="nav-link" data-scroll-target="#使用jamovi完成多因子變異數分析-1"><span class="header-section-number">14.2.3</span> 使用jamovi完成多因子變異數分析</a></li>
  <li><a href="#解讀分析結果" id="toc-解讀分析結果" class="nav-link" data-scroll-target="#解讀分析結果"><span class="header-section-number">14.2.4</span> 解讀分析結果</a></li>
  </ul></li>
  <li><a href="#變異數分析的效果量" id="toc-變異數分析的效果量" class="nav-link" data-scroll-target="#變異數分析的效果量"><span class="header-section-number">14.3</span> 變異數分析的效果量</a>
  <ul class="collapse">
  <li><a href="#估計組間平均" id="toc-估計組間平均" class="nav-link" data-scroll-target="#估計組間平均"><span class="header-section-number">14.3.1</span> 估計組間平均</a></li>
  </ul></li>
  <li><a href="#檢核變異數分析的執行條件" id="toc-檢核變異數分析的執行條件" class="nav-link" data-scroll-target="#檢核變異數分析的執行條件"><span class="header-section-number">14.4</span> 檢核變異數分析的執行條件</a>
  <ul class="collapse">
  <li><a href="#變異數的同質性" id="toc-變異數的同質性" class="nav-link" data-scroll-target="#變異數的同質性"><span class="header-section-number">14.4.1</span> 變異數的同質性</a></li>
  <li><a href="#殘差的常態性" id="toc-殘差的常態性" class="nav-link" data-scroll-target="#殘差的常態性"><span class="header-section-number">14.4.2</span> 殘差的常態性</a></li>
  </ul></li>
  <li><a href="#sec-analysis-of-covariance-ancova" id="toc-sec-analysis-of-covariance-ancova" class="nav-link" data-scroll-target="#sec-analysis-of-covariance-ancova"><span class="header-section-number">14.5</span> 共變數分析 (ANCOVA)</a>
  <ul class="collapse">
  <li><a href="#使用jamovi完成共變數分析" id="toc-使用jamovi完成共變數分析" class="nav-link" data-scroll-target="#使用jamovi完成共變數分析"><span class="header-section-number">14.5.1</span> 使用jamovi完成共變數分析</a></li>
  </ul></li>
  <li><a href="#sec-ANOVA-as-a-linear-model" id="toc-sec-ANOVA-as-a-linear-model" class="nav-link" data-scroll-target="#sec-ANOVA-as-a-linear-model"><span class="header-section-number">14.6</span> 變異數分析就是線性模型</a>
  <ul class="collapse">
  <li><a href="#示範資料" id="toc-示範資料" class="nav-link" data-scroll-target="#示範資料"><span class="header-section-number">14.6.1</span> 示範資料</a></li>
  <li><a href="#以迴歸模型處理非連續因子" id="toc-以迴歸模型處理非連續因子" class="nav-link" data-scroll-target="#以迴歸模型處理非連續因子"><span class="header-section-number">14.6.2</span> 以迴歸模型處理非連續因子</a></li>
  <li><a href="#比較因子間平均值的編碼" id="toc-比較因子間平均值的編碼" class="nav-link" data-scroll-target="#比較因子間平均值的編碼"><span class="header-section-number">14.6.3</span> 比較因子間平均值的編碼</a></li>
  <li><a href="#變異數分析與非二元因子迴歸分析的等價性" id="toc-變異數分析與非二元因子迴歸分析的等價性" class="nav-link" data-scroll-target="#變異數分析與非二元因子迴歸分析的等價性"><span class="header-section-number">14.6.4</span> 變異數分析與非二元因子迴歸分析的等價性</a></li>
  <li><a href="#自由度就是計算有多少參數" id="toc-自由度就是計算有多少參數" class="nav-link" data-scroll-target="#自由度就是計算有多少參數"><span class="header-section-number">14.6.5</span> 自由度就是計算有多少參數</a></li>
  </ul></li>
  <li><a href="#各種多重比較方案" id="toc-各種多重比較方案" class="nav-link" data-scroll-target="#各種多重比較方案"><span class="header-section-number">14.7</span> 各種多重比較方案</a>
  <ul class="collapse">
  <li><a href="#比較操作效果" id="toc-比較操作效果" class="nav-link" data-scroll-target="#比較操作效果"><span class="header-section-number">14.7.1</span> 比較操作效果</a></li>
  <li><a href="#helmert-比較法" id="toc-helmert-比較法" class="nav-link" data-scroll-target="#helmert-比較法"><span class="header-section-number">14.7.2</span> Helmert 比較法</a></li>
  <li><a href="#簡單比較" id="toc-簡單比較" class="nav-link" data-scroll-target="#簡單比較"><span class="header-section-number">14.7.3</span> 簡單比較</a></li>
  <li><a href="#jamovi的各種比較選項" id="toc-jamovi的各種比較選項" class="nav-link" data-scroll-target="#jamovi的各種比較選項"><span class="header-section-number">14.7.4</span> jamovi的各種比較選項</a></li>
  </ul></li>
  <li><a href="#sec-Post-hoc-tests" id="toc-sec-Post-hoc-tests" class="nav-link" data-scroll-target="#sec-Post-hoc-tests"><span class="header-section-number">14.8</span> 事後檢定</a></li>
  <li><a href="#sec-The-method-of-planned-comparisons" id="toc-sec-The-method-of-planned-comparisons" class="nav-link" data-scroll-target="#sec-The-method-of-planned-comparisons"><span class="header-section-number">14.9</span> 事前檢定方法</a></li>
  <li><a href="#不平衡的因子設計分析" id="toc-不平衡的因子設計分析" class="nav-link" data-scroll-target="#不平衡的因子設計分析"><span class="header-section-number">14.10</span> 不平衡的因子設計分析</a>
  <ul class="collapse">
  <li><a href="#咖啡飲用資料" id="toc-咖啡飲用資料" class="nav-link" data-scroll-target="#咖啡飲用資料"><span class="header-section-number">14.10.1</span> 咖啡飲用資料</a></li>
  <li><a href="#不平衡設計不適用標準變異數分析" id="toc-不平衡設計不適用標準變異數分析" class="nav-link" data-scroll-target="#不平衡設計不適用標準變異數分析"><span class="header-section-number">14.10.2</span> 不平衡設計不適用「標準變異數分析」</a></li>
  <li><a href="#第一型平方差總和" id="toc-第一型平方差總和" class="nav-link" data-scroll-target="#第一型平方差總和"><span class="header-section-number">14.10.3</span> 第一型平方差總和</a></li>
  <li><a href="#第三型平方差總和" id="toc-第三型平方差總和" class="nav-link" data-scroll-target="#第三型平方差總和"><span class="header-section-number">14.10.4</span> 第三型平方差總和</a></li>
  <li><a href="#第二型平方差總和" id="toc-第二型平方差總和" class="nav-link" data-scroll-target="#第二型平方差總和"><span class="header-section-number">14.10.5</span> 第二型平方差總和</a></li>
  <li><a href="#效果量還有非加成性平方差總和" id="toc-效果量還有非加成性平方差總和" class="nav-link" data-scroll-target="#效果量還有非加成性平方差總和"><span class="header-section-number">14.10.6</span> 效果量(還有非加成性平方差總和)</a></li>
  </ul></li>
  <li><a href="#本章小結" id="toc-本章小結" class="nav-link" data-scroll-target="#本章小結"><span class="header-section-number">14.11</span> 本章小結</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/SCgeeker/lsj-book-zh_tw/edit/main/14-Factorial-ANOVA.qmd" class="toc-action">编辑该页面</a></p><p><a href="https://github.com/SCgeeker/lsj-book-zh_tw/issues/new" class="toc-action">报告问题</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header">
<h1 class="title display-7"><span id="sec-Factorial-ANOVA" class="quarto-section-identifier"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">多因子變異數分析</span></span></h1>

</header>

<blockquote class="blockquote">
<p><strong>譯者註</strong> 20230417初步以ChatGPT-4完成翻譯，內容待編修。</p>
</blockquote>
<p>在過去的幾章中，我們已經做了很多事情。我們研究了當你有一個具有兩組的名義預測變量（例如，在 <a href="11-Comparing-two-means.html"><span>章节&nbsp;11</span></a> 中的t檢驗）或者具有三個或更多組時可以使用的統計檢驗（<a href="13-Comparing-several-means-one-way-ANOVA.html"><span>章节&nbsp;13</span></a>）。<a href="12-Correlation-and-linear-regression.html"><span>章节&nbsp;12</span></a> 介紹了一個強大的新概念，即使用多個連續預測變量建立統計模型，以解釋單個結果變量。例如，回歸模型可以用來預測學生在閱讀理解測驗中犯錯的次數，基於他們為測驗學習的時間和他們在標準化智商測驗中的分數。</p>
<p>本章的目標是將使用多個預測因子的概念擴展到ANOVA框架中。例如，假設我們有興趣使用閱讀理解測驗來衡量三所不同學校的學生成就，並且我們懷疑男孩和女孩的發展速度不同（因此，平均而言，預期表現會有所不同）。每個學生以兩種不同方式分類：根據他們的性別和根據他們所在的學校。我們想做的是根據這兩個分組變量分析閱讀理解成績。進行此操作的工具通常稱為<strong>因子ANOVA</strong>。但是，由於我們有兩個分組變量，我們有時將分析稱為雙因素ANOVA，與我們在 <a href="13-Comparing-several-means-one-way-ANOVA.html"><span>章节&nbsp;13</span></a> 中運行的單因素ANOVA相對。</p>
<!--- Over the course of the last few chapters we have done quite a lot. We have looked at statistical tests you can use when you have one nominal predictor variable with two groups (e.g. the t-test in @sec-Comparing-two-means) or with three or more groups (@sec-Comparing-several-means-one-way-ANOVA). @sec-Correlation-and-linear-regression introduced a powerful new idea, that is building statistical models with multiple continuous predictor variables used to explain a single outcome variable. For instance, a regression model could be used to predict the number of errors a student makes in a reading comprehension test based on the number of hours they studied for the test and their score on a standardised $IQ$ test.

The goal in this chapter is to extend the idea of using multiple predictors into the ANOVA framework. For instance, suppose we were interested in using the reading comprehension test to measure student achievements in three different schools, and we suspect that girls and boys are developing at different rates (and so would be expected to have different performance on average). Each student is classified in two different ways: on the basis of their gender and on the basis of their school. What we'd like to do is analyse the reading comprehension scores in terms of both of these grouping variables. The tool for doing so is generically referred to as **factorial ANOVA**. However, since we have two grouping variables, we sometimes refer to the analysis as a two-way ANOVA, in contrast to the one-way ANOVAs that we ran in @sec-Comparing-several-means-one-way-ANOVA. --->
<section id="平衡且無交互作用的因子設計分析" class="level2" data-number="14.1">
<h2 data-number="14.1" class="anchored" data-anchor-id="平衡且無交互作用的因子設計分析"><span class="header-section-number">14.1</span> 平衡且無交互作用的因子設計分析</h2>
<p>當我們在 <a href="13-Comparing-several-means-one-way-ANOVA.html"><span>章节&nbsp;13</span></a> 中討論變異數分析時，我們假設了一個相對簡單的實驗設計。每個人都在幾個小組中，我們想知道這些小組在某些結果變量上的平均分數是否有所不同。在本節中，我將討論一個更廣泛的實驗設計類別，稱為<strong>因子設計</strong>，其中我們有多個分組變量。在上面給出了這種設計可能產生的一個例子。另一個例子出現在 <a href="13-Comparing-several-means-one-way-ANOVA.html"><span>章节&nbsp;13</span></a> 中，我們在其中研究了不同藥物對每個人的情緒增益的影響。在那一章中，我們確實發現了藥物的顯著影響，但在章節的最後，我們還進行了一個分析，以查看治療是否有影響。我們沒有找到，但是在試圖預測相同結果的兩個單獨分析中有點令人擔憂。也許治療對情緒增益確實有影響，但我們找不到它，因為它被藥物的影響“隱藏”了？換句話說，我們將要進行一個包括藥物和治療作為預測因子的單一分析。對於這種分析，每個人都按照他們給定的藥物（具有3個水平的因子）和接受的治療（具有2個水平的因子）進行交叉分類。我們將此稱為<span class="math inline">\(3 \times 2\)</span>因子設計。</p>
<p>如果我們用jamovi（見 <a href="06-Pragmatic-matters.html#sec-Tabulating-and-cross-tabulating-data"><span>章节&nbsp;6.1</span></a> ）中的“頻率” - “應急表”分析交叉制表藥物和治療，我們將獲得在 <a href="#fig-fig13-1">图&nbsp;<span>14.1</span></a> 中顯示的表格。</p>

<!--- When we discussed analysis of variance in @sec-Comparing-several-means-one-way-ANOVA, we assumed a fairly simple experimental design. Each person is in one of several groups and we want to know whether these groups have different mean scores on some outcome variable. In this section, I'll discuss a broader class of experimental designs known as **factorial designs**, in which we have more than one grouping variable. I gave one example of how this kind of design might arise above. Another example appears in @sec-Comparing-several-means-one-way-ANOVA in which we were looking at the effect of different drugs on the mood.gain experienced by each person. In that chapter we did find a significant effect of drug, but at the end of the chapter we also ran an analysis to see if there was an effect of therapy. We didn't find one, but there's something a bit worrying about trying to run two separate analyses trying to predict the same outcome. Maybe there actually is an effect of therapy on mood gain, but we couldn't find it because it was being "hidden" by the effect of drug? In other words, we're going to want to run a single analysis that includes both drug and therapy as predictors. For this analysis each person is cross-classified by the drug they were given (a factor with 3 levels) and what therapy they received (a factor with 2 levels). We refer to this as a $3 \times 2$ factorial design.

If we cross-tabulate drug by therapy, using the 'Frequencies' - 'Contingency Tables' analysis in jamovi (see @sec-Tabulating-and-cross-tabulating-data), we get the table shown in @fig-fig13-1. --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-1" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">图&nbsp;14.1: jamovi藥物與治療的應急表</figcaption>
</figure>
</div>
</div>
</div>
<p>如您所見，我們不僅有與兩個因子的所有可能組合相對應的參與者，表明我們的設計是<strong>完全交叉</strong>，而且事實上每個組中都有相等數量的人。換句話說，我們擁有一個平衡設計。在本節中，我將談論如何分析來自<strong>平衡</strong>設計的數據，因為這是最簡單的情況。對於不平衡設計的情況相當繁瑣，所以我們暫時將其擱置。</p>
<!--- As you can see, not only do we have participants corresponding to all possible combinations of the two factors, indicating that our design is **completely crossed**, it turns out that there are an equal number of people in each group. In other words, we have a balanced design. In this section I'll talk about how to analyse data from **balanced** designs, since this is the simplest case. The story for unbalanced designs is quite tedious, so we'll put it to one side for the moment. --->
<section id="sec-What-hypotheses-are-we-testing" class="level3" data-number="14.1.1">
<h3 data-number="14.1.1" class="anchored" data-anchor-id="sec-What-hypotheses-are-we-testing"><span class="header-section-number">14.1.1</span> 多因子設計是因應什麼樣的假設？</h3>
<p>就像單因子變異數分析一樣，因子變異數分析是一個用於測試關於母體均值的某些類型假設的工具。因此，一個明智的開始方式是明確我們的假設實際上是什麼。然而，在我們甚至到達這一點之前，有一個簡單清晰的表示法來描述母體均值是非常有用的。由於觀察是根據兩個不同因子進行交叉分類的事實，可能有很多不同的均值會引起我們的興趣。為了理解這一點，讓我們首先考慮在這種設計中可以計算出所有不同樣本均值。首先，很明顯，我們可能對此類組均值感興趣（ <a href="#tbl-tab13-1">表格&nbsp;<span>14.1</span></a> ）。</p>
<!--- Like one-way ANOVA, factorial ANOVA is a tool for testing certain types of hypotheses about population means. So a sensible place to start would be to be explicit about what our hypotheses actually are. However, before we can even get to that point, it's really useful to have some clean and simple notation to describe the population means. Because of the fact that observations are cross-classified in terms of two different factors, there are quite a lot of different means that one might be interested in. To see this, let's start by thinking about all the different sample means that we can calculate for this kind of design. Firstly, there's the obvious idea that we might be interested in this list of group means (@tbl-tab13-1). --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-1" class="anchored">
<table id="tab:tbl-tab13-1" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表格&nbsp;14.1: 藥物和治療組的組均值在* clinicaltrial.csv *數據中</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;">drug</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">therapy</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">mood.gain</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">placebo</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">no.therapy</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.30</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">anxifree</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">no.therapy</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.40</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">joyzepam</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">no.therapy</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">1.47</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">placebo</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">CBT</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.60</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">anxifree</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">CBT</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">1.03</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">joyzepam</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">CBT</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">1.50</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>接下來，下表（ <a href="#tbl-tab13-2">表格&nbsp;<span>14.2</span></a> ）顯示了兩個因子所有可能組合的組均值列表（例如，接受安慰劑且未接受治療的人、接受安慰劑並接受CBT的人等）。將所有這些數字，以及邊際和總體均值，整合到一個單一的表格中是非常有幫助的，這個表格看起來是這樣的：</p>

<!--- Now, the next Table (@tbl-tab13-2) shows a list of the group means for all possible combinations of the two factors (e.g., people who received the placebo and no therapy, people who received the placebo while getting CBT, etc.). It is helpful to organise all these numbers, plus the marginal and grand means, into a single table which looks like this: --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-2" class="anchored">
<table id="tab:tbl-tab13-2" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表格&nbsp;14.2: 藥物和治療組的組和總體均值在clintrial.csv數據中</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;"></td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">no therapy</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">CBT</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">total</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">placebo</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.30</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.60</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.45</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">anxifree</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.40</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1.03</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.72</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">joyzepam</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1.47</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1.50</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">1.48</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">total</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.72</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1.04</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.88</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>現在，這些不同的均值當然是樣本統計量。它是一個與我們在研究過程中所做的具體觀察相關的數量。我們想要對應的母體參數進行推斷。也就是說，真實的均值是在某個更廣泛的母體內存在的。這些母體均值也可以整理成一個類似的表格，但是我們需要一些數學符號來表示（<a href="#tbl-tab13-3">表格&nbsp;<span>14.3</span></a>）。像往常一樣，我將使用符號<span class="math inline">\(\mu\)</span>來表示母體均值。然而，由於有很多不同的均值，我需要使用下標來區分它們。</p>
<p>這裡是符號如何運作的。我們的表格是根據兩個因子定義的。每行對應於因子A（在本例中為藥物）的不同水平，每列對應於因子B（在本例中為治療）的不同水平。如果我們讓R表示表格中的行數，並讓<span class="math inline">\(C\)</span>表示列數，我們可以將其稱為<span class="math inline">\(R \times C\)</span>因子變異數分析。在這種情況下<span class="math inline">\(R = 3\)</span>和<span class="math inline">\(C = 2\)</span>。我們將使用小寫字母來表示特定的行和列，因此<span class="math inline">\(\mu_{rc}\)</span>表示與因子<span class="math inline">\(A\)</span>的第<span class="math inline">\(r\)</span>級（即第<span class="math inline">\(r\)</span>行）和因子B的第<span class="math inline">\(c\)</span>級（第c列）相關的母體均值。<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> 所以現在母體的均值是寫成@tbl-tab13-1的形式：</p>

<!--- Now, each of these different means is of course a sample statistic. It's a quantity that pertains to the specific observations that we've made during our study. What we want to make inferences about are the corresponding population parameters. That is, the true means as they exist within some broader population. Those population means can also be organised into a similar table, but we'll need a little mathematical notation to do so (@tbl-tab13-3). As usual, I'll use the symbol $\mu$ to denote a population mean. However, because there are lots of different means, I'll need to use subscripts to distinguish between them.

Here's how the notation works. Our table is defined in terms of two factors. Each row corresponds to a different level of Factor A (in this case drug), and each column corresponds to a different level of Factor B (in this case therapy). If we let R denote the number of rows in the table, and $C$ denote the number of columns, we can refer to this as an $R \times C$ factorial ANOVA. In this case $R = 3$ and $C = 2$. We'll use lowercase letters to refer to specific rows and columns, so $\mu_{rc}$ refers to the population mean associated with the $r$-th level of Factor $A$ (i.e. row number $r$) and the $c$-th level of Factor B (column number c).[^factorial-anova-1] So the population means are now written like in @tbl-tab13-1:

[^factorial-anova-1]: The nice thing about the subscript notation is that it generalises nicely. If our experiment had involved a third factor, then we could just add a third subscript. In principle, the notation extends to as many factors as you might care to include, but in this book we'll rarely consider analyses involving more than two factors, and never more than three. --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-3" class="anchored">
<table id="tab:tbl-tab13-3" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表格&nbsp;14.3: 因子表中母體均值的符號表示法</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;"></td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">no therapy</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">CBT</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">total</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">placebo</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \mu_{11} \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \mu_{12} \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;"></td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">anxifree</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \mu_{21} \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \mu_{22} \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;"></td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">joyzepam</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \mu_{31} \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \mu_{32} \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;"></td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">total</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;"></td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;"></td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;"></td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>好的，那剩下的項目呢？例如，我們應該如何描述在這樣一個實驗中可能被給予Joyzepam的整個（假設的）人群的平均情緒提升，而不管他們是否接受了CBT治療？我們使用“點”符號來表示這一點。在Joyzepam的例子中，注意到我們正在討論表中第三行相關的均值。也就是說，我們將兩個單元格的均值（即<span class="math inline">\(\mu_{31}\)</span>和<span class="math inline">\(\mu_{32}\)</span>）求平均。這個求平均的結果被稱為邊際均值，並在這種情況下表示為<span class="math inline">\(\mu_3.\)</span>。CBT的<strong>邊際均值</strong>對應於表中第二列相關的母體均值，因此我們使用表示法，因為它是通過平均（邊際化<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>）兩者而得到的均值。因此，我們的整個母體均值表格可以寫成@tbl-tab13-4。</p>

<!--- Okay, what about the remaining entries? For instance, how should we describe the average mood gain across the entire (hypothetical) population of people who might be given Joyzepam in an experiment like this, regardless of whether they were in CBT? We use the "dot" notation to express this. In the case of Joyzepam, notice that we're talking about the mean associated with the third row in the table. That is, we're averaging across two cell means (i.e., $\mu_{31}$ and $\mu_{32}$). The result of this averaging is referred to as a marginal mean, and would be denoted $\mu_3.$ in this case. The **marginal mean** for CBT corresponds to the population mean associated with the second column in the table, so we use the notation because it is the mean obtained by averaging (marginalising[^factorial-anova-2]) over both. So our full table of population means can be written down like in @tbl-tab13-4.

[^factorial-anova-2]: Technically, marginalising isn't quite identical to a regular mean. It's a weighted average where you take into account the frequency of the different events that you're averaging over. However, in a balanced design, all of our cell frequencies are equal by definition so the two are equivalent. We'll discuss unbalanced designs later, and when we do so you'll see that all of our calculations become a real headache. But let's ignore this for now. --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-4" class="anchored">
<table id="tab:tbl-tab13-4" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表格&nbsp;14.4: 因子表中母體和總體均值的符號表示法</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;"></td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">no therapy</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">CBT</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">total</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">placebo</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \mu_{11} \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \mu_{12} \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\( \mu_{1.} \)</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">anxifree</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \mu_{21} \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \mu_{22} \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\( \mu_{2.} \)</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">joyzepam</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \mu_{31} \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \mu_{32} \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\( \mu_{3.} \)</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">total</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \mu_{.1} \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \mu_{.2} \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\( \mu_{..} \)</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>現在我們有了這個表示法，很容易就可以形成和表達一些假設。假設目標是找出兩件事。首先，藥物的選擇是否對情緒有影響？其次，CBT 是否對情緒有影響？當然，這些不是我們可以制定的唯一假設，並且我們將在[因子 ANOVA 2：平衡設計，允許交互作用]一節中看到一個不同類型假設的非常重要示例，但這兩個假設是最簡單的檢驗，所以我們從這裡開始。考慮第一個檢驗。如果藥物沒有影響，那麼我們應該期望所有行均值相同，對吧？所以那就是我們的虛無假設。另一方面，如果藥物確實有關，那麼我們應該期望這些行均值不同。形式上，我們將虛無假設和替代假設表示為邊際均值的相等性：</p>
<p><span class="math display">\[\text{虛無假設, } H_0 \text{: 行均值相同，即 } \mu_{1. } = \mu_{2. } = \mu_{3. }\]</span></p>
<p><span class="math display">\[\text{替代假設, } H_1 \text{: 至少有一個行均值不同}\]</span></p>
<p>值得注意的是，這些與我們在 <a href="13-Comparing-several-means-one-way-ANOVA.html"><span>章节&nbsp;13</span></a> 中對這些數據進行單因素 ANOVA 時形成的統計假設完全相同。當時我使用符號 <span class="math inline">\(\mu_{P}\)</span> 來表示安慰劑組的平均情緒增益，<span class="math inline">\(\mu_{A}\)</span> 和 <span class="math inline">\(\mu_{J}\)</span> 分別對應兩種藥物的組均值，並且虛無假設是 <span class="math inline">\(\mu_{P} = \mu_{A} = \mu_{J}\)</span>。所以我們實際上在談論相同的假設，只不過由於存在多個分組變量，更複雜的 ANOVA 需要更仔細的表示法，因此我們現在將此假設表示為 <span class="math inline">\(\mu_{ 1.} = \mu_{ 2.} = \mu_{ 3.}\)</span>。然而，正如我們將很快看到的那樣，儘管假設相同，但由於我們現在承認了第二個分組變量的存在，對該假設的檢驗存在微妙的不同。</p>
<p>談到其他分組變量，你可能不會感到驚訝地發現，我們的第二個假設檢驗也以相同的方式制定。然而，由於我們談論的是心理治療而不是藥物，我們的虛無假設現在對應於列均值的相等：</p>
<p><span class="math display">\[\text{虛無假設, } H_0 \text{: 列均值相同，即， } \mu_{ .1} = \mu_{ .2} \]</span> <span class="math display">\[\text{替代假設, } H_1 \text{: 列均值不同，即， } \mu_{ .1} \neq \mu_{ .2}\]</span></p>
<!--- Now that we have this notation, it is straightforward to formulate and express some hypotheses. Let's suppose that the goal is to find out two things. First, does the choice of drug have any effect on mood? And second, does CBT have any effect on mood? These aren't the only hypotheses that we could formulate of course, and we'll see a really important example of a different kind of hypothesis in the section [Factorial ANOVA 2: balanced designs, interactions allowed], but these are the two simplest hypotheses to test, and so we'll start there. Consider the first test. If the drug has no effect then we would expect all of the row means to be identical, right? So that's our null hypothesis. On the other hand, if the drug does matter then we should expect these row means to be different. Formally, we write down our null and alternative hypotheses in terms of the equality of marginal means:

$$\text{Null hypothesis, } H_0 \text{: row means are the same, i.e., } \mu_{1. } = \mu_{2. } = \mu_{3. }$$

$$\text{Alternative hypothesis, } H_1 \text{: at least one row mean is different}$$

It's worth noting that these are exactly the same statistical hypotheses that we formed when we ran a one-way ANOVA on these data in @sec-Comparing-several-means-one-way-ANOVA. Back then I used the notation $\mu \times {P}$ to refer to the mean mood gain for the placebo group, with $\mu{A}$ and $\mu \times {J}$ corresponding to the group means for the two drugs, and the null hypothesis was $\mu{P} = \mu{A} = \mu{J}$ . So we're actually talking about the same hypothesis, it's just that the more complicated ANOVA requires more careful notation due to the presence of multiple grouping variables, so we're now referring to this hypothesis as $\mu_{ 1.} = \mu_{ 2.} = \mu_{ 3.}$ . However, as we'll see shortly, although the hypothesis is identical the test of that hypothesis is subtly different due to the fact that we're now acknowledging the existence of the second grouping variable.

Speaking of the other grouping variable, you won't be surprised to discover that our second hypothesis test is formulated the same way. However, since we're talking about the psychological therapy rather than drugs our null hypothesis now corresponds to the equality of the column means:

$$\text{Null hypothesis, } H_0 \text{: column means are the same, i.e., } \mu_{ .1} = \mu_{ .2} $$
$$\text{Alternative hypothesis, } H_1 \text{: column means are different, i.e., } \mu_{ .1} \neq \mu_{ .2}$$
--->
</section>
<section id="使用jamovi完成多因子變異數分析" class="level3" data-number="14.1.2">
<h3 data-number="14.1.2" class="anchored" data-anchor-id="使用jamovi完成多因子變異數分析"><span class="header-section-number">14.1.2</span> 使用jamovi完成多因子變異數分析</h3>
<p>我在上一節中描述的虛無假設和替代假設應該讓你感到非常熟悉。它們基本上與我們在 <a href="13-Comparing-several-means-one-way-ANOVA.html"><span>章节&nbsp;13</span></a> 中執行的更簡單的單因素ANOVA檢驗相同。所以你可能期望因子ANOVA中使用的假設檢驗本質上與 <a href="13-Comparing-several-means-one-way-ANOVA.html"><span>章节&nbsp;13</span></a> 中的F檢驗相同。您期望看到對平方和（SS）、平均平方（MS）、自由度（df）以及最終可以將之轉換為p值的F統計量的引用，對吧？好吧，你絕對是對的。 這麼多，以至於我要改變我的常規方法。在本書中，我通常採用先描述特定分析的基礎邏輯（在某程度上還有數學），然後再介紹jamovi中的分析的方法。這次我要相反地做，先告訴你如何在jamovi中執行它。這樣做的原因是我想強調 <a href="13-Comparing-several-means-one-way-ANOVA.html"><span>章节&nbsp;13</span></a> 中討論的簡單的單因素ANOVA工具，以及我們將在本章中使用的更複雜的方法之間的相似之處。</p>
<p>如果您試圖分析的數據對應於平衡的因子設計，那麼執行方差分析就很容易。要了解它有多容易，讓我們先重現 <a href="13-Comparing-several-means-one-way-ANOVA.html"><span>章节&nbsp;13</span></a> 中的原始分析。以防你忘了，對於那個分析，我們只使用一個因素（即藥物）來預測我們的結果變量（即mood.gain），並且得到了 <a href="#fig-fig13-2">图&nbsp;<span>14.2</span></a> 中顯示的結果。</p>
<!--- The null and alternative hypotheses that I described in the last section should seem awfully familiar. They're basically the same as the hypotheses that we were testing in our simpler oneway ANOVAs in @sec-Comparing-several-means-one-way-ANOVA. So you're probably expecting that the hypothesis tests that are used in factorial ANOVA will be essentially the same as the F-test from @sec-Comparing-several-means-one-way-ANOVA. You're expecting to see references to sums of squares (SS), mean squares (MS), degrees of freedom (df), and finally an F-statistic that we can convert into a p-value, right? Well, you're absolutely and completely right. So much so that I'm going to depart from my usual approach. Throughout this book, I've generally taken the approach of describing the logic (and to an extent the mathematics) that underpins a particular analysis first and only then introducing the analysis in jamovi. This time I'm going to do it the other way around and show you how to do it in jamovi first. The reason for doing this is that I want to highlight the similarities between the simple one-way ANOVA tool that we discussed in @sec-Comparing-several-means-one-way-ANOVA, and the more complicated approach that we're going to use in this chapter.

If the data you're trying to analyse correspond to a balanced factorial design then running your analysis of variance is easy. To see how easy it is, let's start by reproducing the original analysis from @sec-Comparing-several-means-one-way-ANOVA. In case you've forgotten, for that analysis we were using only a single factor (i.e., drug) to predict our outcome variable (i.e., mood.gain), and we got the results shown in @fig-fig13-2. --->
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-2" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-2.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">图&nbsp;14.2: 藥物對 mood.gain 的單因子變異分析</figcaption>
</figure>
</div>
</div>
</div>
<p>現在，假設我也好奇心理治療是否與mood.gain有關。根據我們在 <a href="12-Correlation-and-linear-regression.html"><span>章节&nbsp;12</span></a> 中對多元回歸的討論，你可能不會感到意外，我們所要做的就是在分析中將治療作為第二個”固定因素”，如 <a href="#fig-fig13-3">图&nbsp;<span>14.3</span></a> 所示。 <!--- Now, suppose I'm also curious to find out if therapy has a relationship to mood.gain. In light of what we've seen from our discussion of multiple regression in @sec-Correlation-and-linear-regression, you probably won't be surprised that all we have to do is add therapy as a second 'Fixed Factor' in the analysis, see @fig-fig13-3. ---></p>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-3" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-3.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">图&nbsp;14.3: 藥物和心理治療對 mood.gain 的雙因子變異數分析</figcaption>
</figure>
</div>
</div>
</div>
<p>這個輸出也很容易閱讀。表格的第一行報告了與藥物因素相關的組間平方和（SS）值，以及相應的組間 df 值。它還計算了平均平方（MS）、F統計量和p值。還有一行對應於心理治療因素和一行對應於殘差（即組內變異）。</p>
<p>所有的單個量都非常熟悉，這些不同量之間的關係也保持不變，就像我們在原始單因素ANOVA中看到的一樣。注意，平均平方值是通過將<span class="math inline">\(SS\)</span>除以相應的<span class="math inline">\(df\)</span>來計算的。也就是說，無論我們談論的是藥物、治療還是殘差，都還是</p>
<p><span class="math display">\[MS=\frac{SS}{df}\]</span></p>
<p>為了看到這一點，讓我們不要擔心平方和值是如何計算的。相反，讓我們相信 jamovi 已經正確計算了 <span class="math inline">\(SS\)</span> 值，並嘗試驗證所有其他數字是否合理。首先，注意對於藥物因素，我們將 <span class="math inline">\(3.45\)</span> 除以 <span class="math inline">\(2\)</span>，得到平均平方值為 <span class="math inline">\(1.73\)</span>。對於心理治療因素，只有1個自由度，所以我們的計算更簡單：將 <span class="math inline">\(0.47\)</span>（<span class="math inline">\(SS\)</span> 值）除以1，得到答案為 <span class="math inline">\(0.47\)</span>（<span class="math inline">\(MS\)</span> 值）。</p>
<p>轉向 F 統計量和 p 值，注意我們有兩個；一個對應藥物因素，另一個對應心理治療因素。無論我們談論的是哪一個，F 統計量都是將與因素相關的平均平方值除以與殘差相關的平均平方值。如果我們用 “A” 作為簡寫符號來指代第一個因素（因素 A；在本例中是藥物），用 “R” 作為簡寫符號來指代殘差，那麼與因素 A 相關的 F 統計量表示為 <span class="math inline">\(F_A\)</span>，並按如下方式計算：</p>
<p><span class="math display">\[F_A=\frac{MS_A}{MS_R}\]</span></p>
<p>因素 B（即心理治療）也有等效公式。注意，這裡使用 “R” 來指代殘差有點尷尬，因為我們也用字母 R 來指代表格中的行數，但我只會在 SSR 和 MSR 的上下文中用 “R” 表示殘差，所以希望這不會令人困惑。無論如何，將這個公式應用於藥物因素，我們將平均平方值 1.73 除以殘差平均平方值 <span class="math inline">\(0.07\)</span>，得到 F 統計量為 26.15。對於心理治療變量的相應計算將是將 <span class="math inline">\(0.47\)</span> 除以 <span class="math inline">\(0.07\)</span>，得到 <span class="math inline">\(7.08\)</span> 作為 F 統計量。當然，這些值與 jamovi 在上面的 ANOVA 表中報告的值相同。</p>
<p>同樣在 ANOVA 表中的是 p 值的計算。再次，這裡沒有什麼新鮮事物。對於我們的兩個因素，我們試圖做的是測試關於因素與結果變量之間沒有關係的虛無假設（稍後我將更加明確）。為此，我們（顯然）遵循了類似於單因素 ANOVA 的策略，為每個假設計算了一個 F 統計量。要將這些轉換為 p 值，我們只需要注意，在虛無假設下（即所謂因素無關）的 F 統計量的抽樣分佈是一個 F 分佈。還要注意，兩個自由度值分別對應於因素和殘差。對於藥物因素，我們談論的是具有 2 和 14 自由度的 F 分佈（稍後我將更詳細地討論自由度）。相反，對於心理治療因素，抽樣分佈是具有 1 和 14 自由度的 F 分佈。</p>
<p>在這一點上，我希望您能看到，這個更複雜的因子分析的 ANOVA 表應該以與較簡單的單因素分析的 ANOVA 表相同的方式進行閱讀。簡而言之，它告訴我們，我們的 <span class="math inline">\(3 \times 2\)</span> 設計的因子 ANOVA 發現藥物的顯著效應（<span class="math inline">\(F_{2,14} = 26.15, p &lt; .001\)</span>）以及心理治療的顯著效應（<span class="math inline">\(F_{1,14} = 7.08, p = .02\)</span>）。或者，使用更技術正確的術語，我們會說藥物和心理治療有兩個<strong>主要效果</strong>。此刻，將這些稱為“主要”效果似乎有點多餘，但實際上是有道理的。稍後，我們將討論兩個因素之間可能存在的“交互作用”，因此我們通常區分主要效果和交互作用。</p>

<!--- This output is pretty simple to read too. The first row of the table reports a between-group sum of squares (SS) value associated with the drug factor, along with a corresponding between-group df value. It also calculates a mean square value (MS), an F-statistic and a p-value. is also a row corresponding to the therapy factor and a row corresponding to the residuals (i.e., the within groups variation).

Not only are all of the individual quantities pretty familiar, the relationships between these different quantities has remained unchanged, just like we saw with the original one-way ANOVA. Note that the mean square value is calculated by dividing $SS$ by the corresponding $df$. That is, it's still true that

$$MS=\frac{SS}{df}$$

regardless of whether we're talking about drug, therapy or the residuals. To see this, let's not worry about how the sums of squares values are calculated. Instead, let's take it on faith that jamovi has calculated the $SS$ values correctly, and try to verify that all the rest of the numbers make sense. First, note that for the drug factor, we divide $3.45$ by $2$ and end up with a mean square value of $1.73$. For the therapy factor, there's only 1 degree of freedom, so our calculations are even simpler: dividing $0.47$ (the $SS$ value) by 1 gives us an answer of $0.47$ (the $MS$ value).

Turning to the F statistics and the p values, notice that we have two of each; one corresponding to the drug factor and the other corresponding to the therapy factor. Regardless of which one we're talking about, the F statistic is calculated by dividing the mean square value associated with the factor by the mean square value associated with the residuals. If we use "A" as shorthand notation to refer to the first factor (factor A; in this case drug) and "R" as shorthand notation to refer to the residuals, then the F statistic associated with factor A is denoted $F_A$, and is calculated as follows:

$$F_A=\frac{MS_A}{MS_R}$$

and an equivalent formula exists for factor B (i.e., therapy). Note that this use of "R" to refer to residuals is a bit awkward, since we also used the letter R to refer to the number of rows in the table, but I'm only going to use "R" to mean residuals in the context of SSR and MSR, so hopefully this shouldn't be confusing. Anyway, to apply this formula to the drugs factor we take the mean square of 1.73 and divide it by the residual mean square value of $0.07$, which gives us an F-statistic of 26.15. The corresponding calculation for the therapy variable would be to divide $0.47$ by $0.07$ which gives $7.08$ as the F-statistic. Not surprisingly, of course, these are the same values that jamovi has reported in the ANOVA table above.

Also in the ANOVA table is the calculation of the p values. Once again, there is nothing new here. For each of our two factors what we're trying to do is test the null hypothesis that there is no relationship between the factor and the outcome variable (I'll be a bit more precise about this later on). To that end, we've (apparently) followed a similar strategy to what we did in the one way ANOVA and have calculated an F-statistic for each of these hypotheses. To convert these to p values, all we need to do is note that the sampling distribution for the F statistic under the null hypothesis (that the factor in question is irrelevant) is an F distribution. Also note that the two degrees of freedom values are those corresponding to the factor and those corresponding to the residuals. For the drug factor we're talking about an F distribution with 2 and 14 degrees of freedom (I'll discuss degrees of freedom in more detail later). In contrast, for the therapy factor the sampling distribution is F with 1 and 14 degrees of freedom.

At this point, I hope you can see that the ANOVA table for this more complicated factorial analysis should be read in much the same way as the ANOVA table for the simpler one way analysis. In short, it's telling us that the factorial ANOVA for our $3 \times 2$ design found a significant effect of drug ($F_{2,14} = 26.15, p < .001$) as well as a significant effect of therapy ($F_{1,14} = 7.08, p = .02$). Or, to use the more technically correct terminology, we would say that there are two **main effects** of drug and therapy. At the moment, it probably seems a bit redundant to refer to these as "main" effects, but it actually does make sense. Later on, we're going to want to talk about the possibility of "interactions" between the two factors, and so we generally make a distinction between main effects and interaction effects. --->
</section>
<section id="計算多因子變異數分析的平方差總和" class="level3" data-number="14.1.3">
<h3 data-number="14.1.3" class="anchored" data-anchor-id="計算多因子變異數分析的平方差總和"><span class="header-section-number">14.1.3</span> 計算多因子變異數分析的平方差總和</h3>
<p>在上一節中，我有兩個目標。首先，向您顯示執行因子 ANOVA 所需的 jamovi 方法與我們用於單因素 ANOVA 的方法幾乎相同。唯一的區別是添加了第二個因素。其次，我想向您展示在這種情況下 ANOVA 表的樣子，以便您從一開始就可以看到因子 ANOVA 背後的基本邏輯和結構與支撐單因素 ANOVA 的那些相同。試著抱著這種感覺。這是真實的，因為因子 ANOVA 的建立方式與更簡單的單因素 ANOVA 模型大致相同。只是一旦您開始挖掘細節，這種熟悉的感覺就會消失。傳統上，這種令人欣慰的感覺會被向統計教科書作者傾訴怒氣的衝動所替代。</p>
<p>好的，讓我們先看看其中一些細節。上一節中的解釋表明了主效應（本例中為藥物和心理治療）的假設檢驗是 F 檢驗，但它沒有顯示如何計算平方和（SS）值。也沒有明確告訴您如何計算自由度（df 值），儘管相比之下這是一個簡單的事情。現在讓我們假設我們只有兩個預測變量，因子 A 和因子 B。如果我們用 Y 來表示結果變量，那麼我們可以用 Yrci 來表示與 rc 組的第 i 位成員相關的結果（即因子 A 的第 r 級/行和因子 B 的第 c 級/列）。因此，如果我們用 <span class="math inline">\(\bar{Y}\)</span> 表示樣本均值，我們可以使用與之前相同的表示法來表示組均值、邊際均值和總均值。也就是說，<span class="math inline">\(\bar{Y}_{rc}\)</span> 是與因子 A 的第 r 級和因子 B 的第 c 級相關的樣本均值：<span class="math inline">\(\bar{Y}_{r.}\)</span> 將是因子 A 的第 r 級的邊際均值，<span class="math inline">\(\bar{Y}_{.c}\)</span> 將是因子 B 的第 c 級的邊際均值，<span class="math inline">\(\bar{Y}_{..}\)</span> 是總體均值。換句話說，我們的樣本均值可以按照與母體均值相同的表格進行組織。對於我們的臨床試驗數據，該表格如@tbl-tab13-5所示。</p>

<!--- In the previous section I had two goals. Firstly, to show you that the jamovi method needed to do factorial ANOVA is pretty much the same as what we used for a one way ANOVA. The only difference is the addition of a second factor. Secondly, I wanted to show you what the ANOVA table looks like in this case, so that you can see from the outset that the basic logic and structure behind factorial ANOVA is the same as that which underpins one way ANOVA. Try to hold onto that feeling. It's genuinely true, insofar as factorial ANOVA is built in more or less the same way as the simpler one-way ANOVA model. It's just that this feeling of familiarity starts to evaporate once you start digging into the details. Traditionally, this comforting sensation is replaced by an urge to hurl abuse at the authors of statistics textbooks.

Okay, let's start by looking at some of those details. The explanation that I gave in the last section illustrates the fact that the hypothesis tests for the main effects (of drug and therapy in this case) are F-tests, but what it doesn't do is show you how the sum of squares (SS) values are calculated. Nor does it tell you explicitly how to calculate degrees of freedom (df values) though that's a simple thing by comparison. Let's assume for now that we have only two predictor variables, Factor A and Factor B. If we use Y to refer to the outcome variable, then we would use Yrci to refer to the outcome associated with the i-th member of group rc (i.e., level/row r for Factor A and level/column c for Factor B). Thus, if we use $\bar{Y}$ to refer to a sample mean, we can use the same notation as before to refer to group means, marginal means and grand means. That is, $\bar{Y}_{rc}$ is the sample mean associated with the rth level of Factor A and the cth level of Factor: $\bar{Y}_{r.}$ would be the marginal mean for the rth level of Factor A, $\bar{Y}_{.c}$ would be the marginal mean for the cth level of Factor B, and $\bar{Y}_{..}$ is the grand mean. In other words, our sample means can be organised into the same table as the population means. For our clinical trial data, that table is shown in @tbl-tab13-5. --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-5" class="anchored">
<table id="tab:tbl-tab13-5" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表格&nbsp;14.5: 臨床試驗數據的樣本均值表示法</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;"></td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">no therapy</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">CBT</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">total</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">placebo</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \bar{Y}_{11} \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \bar{Y}_{12} \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\( \bar{Y}_{1.} \)</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">anxifree</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \bar{Y}_{21} \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \bar{Y}_{22} \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\( \bar{Y}_{2.} \)</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">joyzepam</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \bar{Y}_{31} \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \bar{Y}_{32} \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\( \bar{Y}_{3.} \)</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">total</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \bar{Y}_{.1} \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \bar{Y}_{.2} \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\( \bar{Y}_{..} \)</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>如果我們查看之前顯示的樣本均值，我們有 <span class="math inline">\(\bar{Y}_{11} = 0.30\)</span>，<span class="math inline">\(\bar{Y}_{12} = 0.60\)</span> 等。在我們的臨床試驗示例中，藥物因子有 3 個水平，治療因子有 2 個水平，因此我們試圖執行的是一個 <span class="math inline">\(3 \times 2\)</span> 因子方差分析。然而，我們將更一般地說，因子 A（行因子）有 R 個水平，因子 B（列因子）有 C 個水平，因此我們在這裡執行的是一個 <span class="math inline">\(R \times C\)</span> 因子方差分析。</p>
<p>[額外的技術細節<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>]</p>

<!--- And if we look at the sample means that I showed earlier, we have $\bar{Y}_{11} = 0.30$, $\bar{Y}_{12} = 0.60$ etc. In our clinical trial example, the drugs factor has 3 levels and the therapy factor has 2 levels, and so what we're trying to run is a $3 \times 2$ factorial ANOVA. However, we'll be a little more general and say that Factor A (the row factor) has R levels and Factor B (the column factor) has C levels, and so what we're running here is an $R \times C$ factorial ANOVA.

[Additional technical detail [^factorial-anova-3]]

[^factorial-anova-3]: Now that we've got our notation straight, we can compute the sum of squares values for each of the two factors in a relatively familiar way. For Factor A, our between group sum of squares is calculated by assessing the extent to which the (row) marginal means $\bar{Y}_{1.} , \bar{Y}_{2.}$ etc, are different from the grand mean $\bar{Y}_{..}$ We do this in the same way that we did for one-way ANOVA: calculate the sum of squared difference between the $\bar{Y}_{i.}$ values and the $\bar{Y}_{..}$ values. Specifically, if there are N people in each group, then we calculate this $$SS_A=(N \times C)\sum_{r=1}^R (\bar{Y}_{r.}-\bar{Y}_{..})^2$$ As with one-way ANOVA, the most interesting $^a$ part of this formula is the bit, which corresponds to the squared deviation associated with level r. All that this formula does is calculate this squared deviation for all R levels of the factor, add them up, and then multiply the result by $N \times C$. The reason for this last part is that there are multiple cells in our design that have level $r$ on Factor A. In fact, there are C of them, one corresponding to each possible level of Factor B. For instance, in our example there are two different cells in the design corresponding to the anxifree drug: one for people with no.therapy and one for the CBT group. Not only that, within each of these cells there are N observations. So, if we want to convert our SS value into a quantity that calculates the between-groups sum of squares on a "per observation" basis, we have to multiply by $N \times C$. The formula for factor $B$ is of course the same thing, just with some subscripts shuffled around $$SS_B=(N \times R)\sum_{c=1}^C (\bar{Y}_{.c}-\bar{Y}_{..})^2$$ Now that we have these formulas we can check them against the jamovi output from the earlier section. Once again, a dedicated spreadsheet programme is helpful for these sorts of calculations, so please have a go yourself. You can also take a look at the version I did in Excel in the file *clinicaltrial_factorialanova.xls*. First, let's calculate the sum of squares associated with the main effect of drug. There are a total of $N = 3$ people in each group and $C = 2$ different types of therapy. Or, to put it another way, there are $3 \times 2 = 6$ people who received any particular drug. When we do these calculations in a spreadsheet programme, we get a value of 3.45 for the sum of squares associated with the main effect of drug. Not surprisingly, this is the same number that you get when you look up the SS value for the drugs factor in the ANOVA table that I presented earlier, in @fig-fig13-3. <br /> We can repeat the same kind of calculation for the effect of therapy. Again there are $N = 3$ people in each group, but since there are $R = 3$ different drugs, this time around we note that there are $3 \times 3 = 9$ people who received CBT and an additional 9 people who received the placebo. So our calculation in this case gives us a value of $0.47$ for the sum of squares associated with the main effect of therapy. Once again, we are not surprised to see that our calculations are identical to the ANOVA output in @fig-fig13-3. <br /> So that's how you calculate the SS values for the two main effects. These SS values are analogous to the between-group sum of squares values that we calculated when doing one-way ANOVA in @sec-Comparing-several-means-one-way-ANOVA. However, it's not a good idea to think of them as between-groups SS values anymore, just because we have two different grouping variables and it's easy to get confused. In order to construct an $F$ test, however, we also need to calculate the within-groups sum of squares. In keeping with the terminology that we used in @sec-Correlation-and-linear-regression and the terminology that jamovi uses when printing out the ANOVA table, I'll start referring to the within-groups SS value as the residual sum of squares $SS_R$. <br /> The easiest way to think about the residual SS values in this context, I think, is to think of it as the leftover variation in the outcome variable after you take into account the differences in the marginal means (i.e., after you remove $SS_A$ and $SS_B$). What I mean by that is we can start by calculating the total sum of squares, which I'll label $SS_T$ . The formula for this is pretty much the same as it was for one-way ANOVA. We take the difference between each observation Yrci and the grand mean $\hat{Y}_{..}$, square the differences, and add them all $$SS_T=\sum_{r=1}^R \sum_{c=1}^C \sum_{i=1}^N (Y_{rci}-\bar{Y}_{..})^2$$ The "triple summation" here looks more complicated than it is. In the first two summations, we're summing across all levels of Factor $A$ (i.e., over all possible rows r in our table) and across all levels of Factor $B$ (i.e., all possible columns $c$). Each rc combination corresponds to a single group and each group contains $N$ people, so we have to sum across all those people (i.e., all $i$ values) too. In other words, all we're doing here is summing across all observations in the data set (i.e., all possible rci combinations). At this point, we know the total variability of the outcome variable SST , and we know how much of that variability can be attributed to Factor A ($SS_A$) and how much of it can be attributed to Factor B ($SS_B$). The residual sum of squares is thus defined to be the variability in $Y$ that can't be attributed to either of our two factors. In other words $$SS_R=SS_T-(SS_A+SS_B)$$ Of course, there is a formula that you can use to calculate the residual SS directly, but I think that it makes more conceptual sense to think of it like this. The whole point of calling it a residual is that it's the leftover variation, and the formula above makes that clear. I should also note that, in keeping with the terminology used in the regression chapter, it is commonplace to refer to $SS_A + SS_B$ as the variance attributable to the "ANOVA model", denoted SSM, and so we often say that the total sum of squares is equal to the model sum of squares plus the residual sum of squares. Later on in this chapter we'll see that this isn't just a surface similarity: ANOVA and regression are actually the same thing under the hood. In any case, it's probably worth taking a moment to check that we can calculate $SS_R$ using this formula and verify that we do obtain the same answer that jamovi produces in its ANOVA table. The calculations are pretty straightforward when done in a spreadsheet (see the clinicaltrial_factorialanova.xls file). We can calculate the total SS using the formulas above (getting an answer of total $SS = 4.85$) and then the residual SS ( = 0.92). Yet again, we get the same answer. <br /> --- <br /> $^a$English translation: "least tedious". --->
</section>
<section id="計算自由度的規則" class="level3" data-number="14.1.4">
<h3 data-number="14.1.4" class="anchored" data-anchor-id="計算自由度的規則"><span class="header-section-number">14.1.4</span> 計算自由度的規則</h3>
<p>自由度的計算方式與單因素變異數分析非常相似。對於任何給定因子，自由度等於級別數減 1（即，行變量因子 A 的 <span class="math inline">\(R - 1\)</span>，列變量因子 B 的 <span class="math inline">\(C - 1\)</span>）。因此，對於藥物因子，我們得到 <span class="math inline">\(df = 2\)</span>，對於療法因子，我們得到 <span class="math inline">\(df = 1\)</span>。稍後，在我們討論將 ANOVA 解釋為回歸模型時（參見 <a href="#sec-ANOVA-as-a-linear-model"><span>章节&nbsp;14.6</span></a>），我將更清楚地說明我們如何得出此數字。但就目前而言，我們可以使用自由度的簡單定義，即自由度等於觀察到的數量數目減去約束數目。因此，對於藥物因子，我們觀察到 3 個單獨的組平均值，但這些受到 1 個總平均值的約束，因此自由度為 2。對於殘差，邏輯相似但不完全相同。我們實驗中的總觀察次數是 18。約束對應於 1 個總平均值，藥物因子引入的 2 個額外組平均值，以及療法因子引入的 1 個額外組平均值，因此我們的自由度為 14。作為公式，這是 <span class="math inline">\(N - 1 - (R - 1) - (C - 1)\)</span>，簡化後是 <span class="math inline">\(N - R - C + 1\)</span>。</p>
<!--- The degrees of freedom are calculated in much the same way as for one-way ANOVA. For any given factor, the degrees of freedom is equal to the number of levels minus 1 (i.e., $R - 1$ for the row variable Factor A, and $C - 1$ for the column variable Factor B). So, for the drugs factor we obtain $df = 2$, and for the therapy factor we obtain $df = 1$. Later on, when we discuss the interpretation of ANOVA as a regression model (see @sec-ANOVA-as-a-linear-model), I'll give a clearer statement of how we arrive at this number. But for the moment we can use the simple definition of degrees of freedom, namely that the degrees of freedom equals the number of quantities that are observed, minus the number of constraints. So, for the drugs factor, we observe 3 separate group means, but these are constrained by 1 grand mean, and therefore the degrees of freedom is 2. For the residuals, the logic is similar, but not quite the same. The total number of observations in our experiment is 18. The constraints correspond to 1 grand mean, the 2 additional group means that the drug factor introduces, and the 1 additional group mean that the the therapy factor introduces, and so our degrees of freedom is 14. As a formula, this is $N - 1 - (R - 1) - (C - 1)$, which simplifies to $N - R - C + 1$. --->
</section>
<section id="多因子與單因子變異數分析" class="level3" data-number="14.1.5">
<h3 data-number="14.1.5" class="anchored" data-anchor-id="多因子與單因子變異數分析"><span class="header-section-number">14.1.5</span> 多因子與單因子變異數分析</h3>
<p>既然我們已經了解了因子變異數分析（factorial ANOVA）的運作方式，那麼花一點時間將其與單因素分析的結果進行比較是值得的，因為這將讓我們真正理解為什麼進行因子變異數分析是個好主意。在 <a href="13-Comparing-several-means-one-way-ANOVA.html"><span>章节&nbsp;13</span></a> 中，我進行了一個單因素變異數分析，以查看藥物之間是否存在差異，並進行了第二個單因素變異數分析，以查看療法之間是否存在差異。正如我們在 <a href="#sec-What-hypotheses-are-we-testing"><span>章节&nbsp;14.1.1</span></a> 節中看到的，單因素變異數分析所檢驗的零假設和對立假設實際上與因子變異數分析所檢驗的假設相同。更仔細地查看變異數分析表，我們可以看到，在兩種不同的分析中，與因子相關的平方和是相同的（藥物為 3.45，療法為 0.92），自由度也是相同的（藥物為 2，療法為 1）。但它們的答案並不相同！最值得注意的是，當我們在 <a href="13-Comparing-several-means-one-way-ANOVA.html#sec-On-the-relationship-between-ANOVA-and-the-Student-t-test"><span>章节&nbsp;13.9</span></a> 中對療法進行單因素變異數分析時，我們沒有發現顯著效應（p 值為 .21）。然而，當我們在兩因素變異數分析的背景下查看療法的主效應時，我們確實得到了顯著效應（p = .019）。這兩種分析顯然不同。</p>
<p>為什麼會發生這種情況？答案在於理解殘差是如何計算的。回想一下 F 檢驗背後的整個概念是將可以歸因於特定因子的變異性與無法解釋的變異性（殘差）進行比較。如果您對療法進行單因素變異數分析，因此忽略了藥物的影響，那麼變異數分析將把所有藥物引起的變異性放入殘差中！這會使數據看起來比實際情況更加嘈雜，而在兩因素變異數分析中被正確認為顯著的療法效果現在變得不顯著。如果我們在試圖評估其他事物（例如，療法）的貢獻時忽略了實際上有意義的事物（例如，藥物），那麼我們的分析將受到扭曲。當然，如果我們記錄了墻壁的顏色，並且在三因素變異數分析中發現這是一個無關緊要的因素，那麼完全可以忽略它，僅報告不包括這個無關因素的更簡單的兩因素變異數分析。您不應該放棄那些確實有所作為的變數！</p>
<blockquote class="blockquote">
<p>總之，比較因子變異數分析與單因素變異數分析的結果可以使我們更好地理解為什麼進行因子變異數分析是一個好主意。當我們忽略了真正重要的變數時，分析將受到扭曲。因此，為了確保我們的分析更加準確，我們應該在分析中包括所有具有重要影響的變數。</p>
</blockquote>

<!--- Now that we've seen how a factorial ANOVA works, it's worth taking a moment to compare it to the results of the one way analyses, because this will give us a really good sense of why it's a good idea to run the factorial ANOVA. In @sec-Comparing-several-means-one-way-ANOVA I ran a one-way ANOVA that looked to see if there are any differences between drugs, and a second one-way ANOVA to see if there were any differences between therapies. As we saw in the section @sec-What-hypotheses-are-we-testing, the null and alternative hypotheses tested by the one-way ANOVAs are in fact identical to the hypotheses tested by the factorial ANOVA. Looking even more carefully at the ANOVA tables, we can see that the sum of squares associated with the factors are identical in the two different analyses (3.45 for drug and 0.92 for therapy), as are the degrees of freedom (2 for drug, 1 for therapy). But they don't give the same answers! Most notably, when we ran the one-way ANOVA for therapy in @sec-On-the-relationship-between-ANOVA-and-the-Student-t-test we didn't find a significant effect (the p-value was .21). However, when we look at the main effect of therapy within the context of the two-way ANOVA, we do get a significant effect (p = .019). The two analyses are clearly not the same.

Why does that happen? The answer lies in understanding how the residuals are calculated. Recall that the whole idea behind an F-test is to compare the variability that can be attributed to a particular factor with the variability that cannot be accounted for (the residuals). If you run a one-way ANOVA for therapy, and therefore ignore the effect of drug, the ANOVA will end up dumping all of the drug-induced variability into the residuals! This has the effect of making the data look more noisy than they really are, and the effect of therapy which is correctly found to be significant in the two-way ANOVA now becomes non-significant. If we ignore something that actually matters (e.g., drug) when trying to assess the contribution of something else (e.g., therapy) then our analysis will be distorted. Of course, it's perfectly okay to ignore variables that are genuinely irrelevant to the phenomenon of interest. If we had recorded the colour of the walls, and that turned out to be a non-significant factor in a three-way ANOVA, it would be perfectly okay to disregard it and just report the simpler two-way ANOVA that doesn't include this irrelevant factor. What you shouldn't do is drop variables that actually make a difference! --->
</section>
<section id="解讀多因子變異數分析的結果" class="level3" data-number="14.1.6">
<h3 data-number="14.1.6" class="anchored" data-anchor-id="解讀多因子變異數分析的結果"><span class="header-section-number">14.1.6</span> 解讀多因子變異數分析的結果</h3>
<p>迄今為止我們討論的變異數分析模型涵蓋了我們可能在數據中觀察到的各種不同模式。例如，在兩因素變異數分析設計中有四種可能性：（a）只有因素A有意義，（b）只有因素B有意義，（c）A和B都有意義，（d）A和B都無意義。 <span class="quarto-unresolved-ref">?fig-fig13-4中繪製了這四種可能性的示例</span>。</p>
<!--- The ANOVA model that we've been talking about so far covers a range of different patterns that we might observe in our data. For instance, in a two-way ANOVA design there are four possibilities: (a) only Factor A matters, (b) only Factor B matters, (c) both A and B matter, and (d) neither A nor B matters. An example of each of these four possibilities is plotted in @fig-fig13-4. --->
</section>
</section>
<section id="平衡且有交互作用的因子設計分析" class="level2" data-number="14.2">
<h2 data-number="14.2" class="anchored" data-anchor-id="平衡且有交互作用的因子設計分析"><span class="header-section-number">14.2</span> 平衡且有交互作用的因子設計分析</h2>
<p><span class="quarto-unresolved-ref">?fig-fig13-4中顯示的四種數據模式都非常現實</span>。有很多數據集正好產生這些模式。然而，它們並非全部故事，到目前為止我們一直在談論的變異數分析模型並不足以充分解釋一個組均值表格。為什麼呢？嗯，到目前為止，我們可以討論藥物如何影響心情，以及治療如何影響心情，但無法談論兩者之間可能存在的<strong>交互作用</strong>。只有當因素<span class="math inline">\(A\)</span>的效果因為我們討論的因素<span class="math inline">\(B\)</span>的水平而有<em>差異</em>時，我們才說<span class="math inline">\(A\)</span>和<span class="math inline">\(B\)</span>之間存在交互作用。<span class="quarto-unresolved-ref">?fig-fig13-5中顯示了在$2</span> $ ANOVA環境下的幾個交互作用效果實例。舉一個更具體的例子，假設Anxifree和Joyzepam的運作受到完全不同的生理機制控制。這導致了一個結果，即儘管在接受治療的情況下，Joyzepam對心情的影響基本相同，但與CBT一起使用時，Anxifree實際上更有效。我們在上一節中開發的ANOVA無法捕捉到這個想法。要判斷此處是否確實存在交互作用，最好繪製各個組的均值。在jamovi中，這是通過ANOVA的“估計邊際均值”選項完成的——只需將藥物和治療移至“條款1”下的“邊際均值”框中。這應該看起來像@fig-fig13-6。我們的主要關注點與這兩條線不平行的事實有關。當藥物為Joyzepam（右側）時，CBT的效果（實線與虛線之間的差異）似乎接近零，甚至比使用安慰劑時（左側）的CBT效果還要小。然而，當給予Anxifree時，CBT的效果大於安慰劑（中間）。這種效果是真實的，還是僅僅由於機會引起的隨機變化？我們最初的ANOVA無法回答這個問題，因為我們根本不允許交互作用的存在！在本節中，我們將解決這個問題。</p>

<!--- The four patterns of data shown in @fig-fig13-4 are all quite realistic. There are a great many data sets that produce exactly those patterns. However, they are not the whole story and the ANOVA model that we have been talking about up to this point is not sufficient to fully account for a table of group means. Why not? Well, so far we have the ability to talk about the idea that drugs can influence mood, and therapy can influence mood, but no way of talking about the possibility of an **interaction** between the two. An interaction between $A$ and $B$ is said to occur whenever the effect of Factor $A$ is *different*, depending on which level of Factor $B$ we're talking about. Several examples of an interaction effect with the context of a $2 \times 2$ ANOVA are shown in @fig-fig13-5. To give a more concrete example, suppose that the operation of Anxifree and Joyzepam is governed by quite different physiological mechanisms. One consequence of this is that while Joyzepam has more or less the same effect on mood regardless of whether one is in therapy, Anxifree is actually much more effective when administered in conjunction with CBT. The ANOVA that we developed in the previous section does not capture this idea. To get some idea of whether an interaction is actually happening here, it helps to plot the various group means. In jamovi this is done via the ANOVA 'Estimated Marginal Means' option - just move drug and therapy across into the 'Marginal Means' box under 'Term 1'. This should look something like @fig-fig13-6. Our main concern relates to the fact that the two lines aren't parallel. The effect of CBT (difference between solid line and dotted line) when the drug is Joyzepam (right side) appears to be near zero, even smaller than the effect of CBT when a placebo is used (left side). However, when Anxifree is administered, the effect of CBT is larger than the placebo (middle). Is this effect real, or is this just random variation due to chance? Our original ANOVA cannot answer this question, because we make no allowances for the idea that interactions even exist! In this section, we'll fix this problem. --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-4" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="14-Factorial-ANOVA_files/figure-html/fig-fig13-4-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">图&nbsp;14.4: 在沒有交互作用的情況下，<span class="math inline">\(2 \times 2\)</span> ANOVA的四種不同結果。在面板（a）中，我們看到因子A的主要效應以及因子B的無效應。面板（b）顯示因子B的主要效應，但因子A沒有影響。面板（c）顯示因子A和因子B的主要影響。最後，面板（d）顯示兩個因子都沒有影響。</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-5" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="14-Factorial-ANOVA_files/figure-html/fig-fig13-5-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">图&nbsp;14.5: <span class="math inline">\(2 \times 2\)</span> ANOVA中質量上不同的交互作用</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-6" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-6.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">图&nbsp;14.6: 使用臨床試驗數據的ANOVA中，jamovi屏幕顯示如何生成描述性交互作用圖</figcaption>
</figure>
</div>
</div>
</div>
<section id="交互作用代表什麼" class="level3" data-number="14.2.1">
<h3 data-number="14.2.1" class="anchored" data-anchor-id="交互作用代表什麼"><span class="header-section-number">14.2.1</span> 交互作用代表什麼？</h3>
<p>本節我們要介紹的關鍵概念是交互作用效應。在我們迄今為止討論的ANOVA模型中，我們的模型中只有兩個因素（即藥物和治療）。但是，當我們添加交互作用時，我們在模型中添加了一個新的組件：藥物和治療的組合。直觀地說，交互作用效應的概念相當簡單。這只是意味著因子A的效應會因為我們談論的因子B的不同水平而有所不同。但是，在我們的數據方面，這實際上意味著什麼呢？ <span class="quarto-unresolved-ref">?fig-fig13-5中的圖表描述了幾種不同的模式</span>，儘管它們彼此相當不同，但它們都被視為交互作用效應。因此，將這個質的概念轉化為統計學家可以使用的數學概念並不完全簡單。</p>
<p>[附加技術細節<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>]</p>

<!--- The key idea that we're going to introduce in this section is that of an interaction effect. In the ANOVA model we have looked at so far there are only two factors involved in our model (i.e., drug and therapy). But when we add an interaction we add a new component to the model: the combination of drug and therapy. Intuitively, the idea behind an interaction effect is fairly simple. It just means that the effect of Factor A is different, depending on which level of Factor B we're talking about. But what does that actually mean in terms of our data? The plot in @fig-fig13-5 depicts several different patterns that, although quite different to each other, would all count as an interaction effect. So it's not entirely straightforward to translate this qualitative idea into something mathematical that a statistician can work with.

[Additional technical detail [^factorial-anova-4]]

[^factorial-anova-4]: As a consequence, the way that the idea of an interaction effect is formalised in terms of null and alternative hypotheses is slightly difficult, and I'm guessing that a lot of readers of this book probably won't be all that interested. Even so, I'll try to give the basic idea here. To start with, we need to be a little more explicit about our main effects. Consider the main effect of Factor $A$ (drug in our running example). We originally formulated this in terms of the null hypothesis that the two marginal means $\mu_r$. are all equal to each other. Obviously, if all of these are equal to each other, then they must also be equal to the grand mean $\mu_{..}$ as well, right? So what we can do is define the effect of Factor $A$ at level $r$ to be equal to the difference between the marginal mean $\mu_{r.}$ and the grand mean $\mu_{..}$. Let's denote this effect by $\alpha_r$, and note that $$\alpha_r=\mu_{r.}-\mu_{..}$$  Now, by definition all of the $\alpha_r$ values must sum to zero, for the same reason that the average of the marginal means $\mu_c$ must be the grand mean $\mu_{..}$. We can similarly define the effect of Factor B at level i to be the difference between the column marginal mean $\mu_{.c}$ and the grand mean $\mu_{..}$ $$\beta_c=\mu_{.c}-\mu_{..}$$ and once again, these $\beta_c$ values must sum to zero. The reason that statisticians sometimes like to talk about the main effects in terms of these $\alpha_r$ and $\beta_c$ values is that it allows them to be precise about what it means to say that there is no interaction effect. If there is no interaction at all, then these $\alpha_r$ and $\beta_c$ values will perfectly describe the group means $\mu_{rc}$. Specifically, it means that $$\mu_{rc}=\mu_{..}+\alpha_{r}+\beta_{c}$$ That is, there's nothing special about the group means that you couldn't predict perfectly by knowing all the marginal means. And that's our null hypothesis, right there. The alternative hypothesis is that $$\mu_{rc} \neq \mu_{..}+\alpha_{r}+\beta_{c}$$ for at least one group $rc$ in our table. However, statisticians often like to write this slightly differently. They'll usually define the specific interaction associated with group $rc$ to be some number, awkwardly referred to as $(\alpha \beta)_{rc}$, and then they will say that the alternative hypothesis is that $$\mu_{rc}=\mu_{..} +\alpha_{r} +\beta_{c} + (\alpha \beta )_{rc}$$ where $(\alpha \beta)_{rc}$ is non-zero for at least one group. This notation is kind of ugly to look at, but it is handy as we'll see when discussing how to calculate the sum of squares. How should we calculate the sum of squares for the interaction terms, $SS_{A:B}$? Well, first off, it helps to notice how we have just defined the interaction effect in terms of the extent to which the actual group means differ from what you'd expect by just looking at the marginal means. Of course, all of those formulas refer to population parameters rather than sample statistics, so we don't actually know what they are. However, we can estimate them by using sample means in place of population means. So for Factor $A$, a good way to estimate the main effect at level r is as the difference between the sample marginal mean $\bar{Y}_{rc}$ and the sample grand mean $\bar{Y}_{..}$. That is, we would use this as our estimate of the effect $$\hat{\alpha}_r = bar{Y}_{r.}-\bar{Y}_{..}$$ Similarly, our estimate of the main effect of Factor B at level c can be defined as follows $$\hat{\beta}_{c}=\hat{Y}_{.c}-\bar{Y}_{..}$$ Now, if you go back to the formulas that I used to describe the $SS$ values for the two main effects, you'll notice that these effect terms are exactly the quantities that we were squaring and summing! So, what's the analog of this for interaction terms? The answer to this can be found by first rearranging the formula for the group means $\mu_{rc}$ under the alternative hypothesis, so that we get this $$\begin{aligned} (\alpha \beta)_{rc} & = \mu_{rc} - \mu_{..} - \alpha_r - \beta_c \\ & = \mu_{rc} - \mu_{..} - (\mu_{r.}-\mu_{..})-(\mu_{.c}-\mu_{..}) \\ & = \mu_{rc} - \mu_{r.} - \mu_{.c} +\mu_{..} \end{aligned}$$ So, once again if we substitute our sample statistics in place of the population means, we get the following as our estimate of the interaction effect for group $rc$, which is $$(\hat{\alpha \beta})_{rc}=\bar{Y}_{rc}-\hat{Y}_{r.}-\bar{Y}_{.c}+\bar{Y}_{..}$$ Now all we have to do is sum all of these estimates across all $R$ levels of Factor $A$ and all $C$ levels of Factor $B$, and we obtain the following formula for the sum of squares associated with the interaction as a whole $$SS_{A:B}=N \sum_{r=1}^R \sum_{c=1}^C (\bar{Y}_{rc}-\bar{Y}_{r.}-\bar{Y}_{.c}+\bar{Y}_{..})^2$$ where we multiply by N because there are N observations in each of the groups, and we want our $SS$ values to reflect the variation among observations accounted for by the interaction, not the variation among groups. Now that we have a formula for calculating $SS_{A:B}$, it's important to recognise that the interaction term is part of the model (of course), so the total sum of squares associated with the model, SSM, is now equal to the sum of the three relevant SS values, $SS_A + SS_B + SS_{A:B}$. The residual sum of squares SSR is still defined as the leftover variation, namely $SS_T - SS_M$, but now that we have the interaction term this becomes $$SS_R=SS_T-(SS_A+SS_B+SS_{A:B})$$
As a consequence, the residual sum of squares $SS_R$ will be smaller than in our original ANOVA that didn't include interactions. --->
</section>
<section id="交互作用的自由度" class="level3" data-number="14.2.2">
<h3 data-number="14.2.2" class="anchored" data-anchor-id="交互作用的自由度"><span class="header-section-number">14.2.2</span> 交互作用的自由度</h3>
<p>將交互作用納入計算後，計算自由度變得稍微複雜一些。首先，讓我們考慮整個ANOVA模型。一旦我們在模型中包括交互效應，我們允許每個單獨組具有唯一的平均值，<span class="math inline">\(mu_{rc}\)</span>。對於一個<span class="math inline">\(R \times C\)</span>的因子ANOVA，這意味著模型中有<span class="math inline">\(R \times C\)</span>個感興趣的數量，並且只有一個約束：所有組均值需要平均為總體均值。因此，整個模型需要有(<span class="math inline">\(R \times C\)</span>) - 1個自由度。但是因子A的主效應具有<span class="math inline">\(R-1\)</span>個自由度，因子B的主效應具有<span class="math inline">\(C-1\)</span>個自由度。這意味著與交互作用相關的自由度為</p>
<p><span class="math display">\[
\begin{aligned}
df_{A:B} &amp; = (R \times C - 1) - (R - 1) - (C - 1) \\
&amp; = RC - R - C + 1 \\
&amp; = (R-1)(C-1)
\end{aligned}
\]</span></p>
<p>這只是與行因子和列因子相關的自由度之積。</p>
<p>那剩餘自由度呢？由於我們添加了吸收一些自由度的交互項，剩餘的自由度變得更少。具體來說，請注意，如果具有交互作用的模型總共有<span class="math inline">\((R \times C) - 1\)</span>，並且在數據集中有<span class="math inline">\(N\)</span>個受1個總體均值約束的觀察值，那麼您的剩餘自由度現在變為<span class="math inline">\(N-(R \times C)-1+1\)</span>，或者只是<span class="math inline">\(N-(R \times C)\)</span>。</p>
<!--- Calculating the degrees of freedom for the interaction is, once again, slightly trickier than the corresponding calculation for the main effects. To start with, let's think about the ANOVA model as a whole. Once we include interaction effects in the model we're allowing every single group to have a unique mean, $mu_{rc}$. For an $R \times C$ factorial ANOVA, this means that there are $R \times C$ quantities of interest in the model and only the one constraint: all of the group means need to average out to the grand mean. So the model as a whole needs to have ($R \times C$) - 1 degrees of freedom. But the main effect of Factor A has $R - 1$ degrees of freedom, and the main effect of Factor B has $C - 1$ degrees of freedom. This means that the degrees of freedom associated with the interaction is

$$
\begin{aligned}
df_{A:B} & = (R \times C - 1) - (R - 1) - (C - 1) \\
& = RC - R - C + 1 \\
& = (R-1)(C-1)
\end{aligned}
$$

which is just the product of the degrees of freedom associated with the row factor and the column factor.

What about the residual degrees of freedom? Because we've added interaction terms which absorb some degrees of freedom, there are fewer residual degrees of freedom left over. Specifically, note that if the model with interaction has a total of $(R \times C) - 1$, and there are $N$ observations in your data set that are constrained to satisfy 1 grand mean, your residual degrees of freedom now become $N - (R \times C) - 1 + 1$, or just $N - (R \times C)$. --->
</section>
<section id="使用jamovi完成多因子變異數分析-1" class="level3" data-number="14.2.3">
<h3 data-number="14.2.3" class="anchored" data-anchor-id="使用jamovi完成多因子變異數分析-1"><span class="header-section-number">14.2.3</span> 使用jamovi完成多因子變異數分析</h3>
<p>在jamovi中將交互項添加到ANOVA模型非常簡單。實際上，這不僅簡單，而且是ANOVA的默認選項。這意味著當您為ANOVA指定兩個因子時，例如藥物和療法，則交互組件 - 藥物<span class="math inline">\(\times\)</span>療法 - 會自動添加到模型中<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>。當我們將交互項納入ANOVA運行後，我們將得到@fig-fig13-7中顯示的結果。</p>
<!---Adding interaction terms to the ANOVA model in jamovi is straightforward. In fact it is more than straightforward because it is the default option for ANOVA. This means that when you specify an ANOVA with two factors, e.g. drug and therapy then the interaction component - drug $\times$ therapy - is added automatically to the model[^factorial-anova-5]. When we run the ANOVA with the interaction term included, then we get the results shown in @fig-fig13-7.

[^factorial-anova-5]: You may have spotted this already when looking at the main effects analysis in jamovi that we described earlier. For the purpose of the explanation in this book I removed the interaction component from the earlier model to keep things clean and simple--->
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-7" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-7.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">图&nbsp;14.7: 包括交互組件藥物<span class="math inline">\(\times\)</span>療法的完整因子模型結果</figcaption>
</figure>
</div>
</div>
</div>
<p>結果顯示，儘管我們確實對藥物有顯著的主效應（<span class="math inline">\(F_{2,12} = 31.7, p &lt; .001\)</span>）和療法類型（<span class="math inline">\(F_{1,12} = 8.6, p = .013\)</span>），但兩者之間沒有顯著的交互作用（<span class="math inline">\(F_{2,12} = 2.5, p = 0.125\)</span>）。</p>
<!---As it turns out, while we do have a significant main effect of drug ($F_{2,12} = 31.7, p < .001$) and therapy type ($F_{1,12} = 8.6, p = .013$), there is no significant interaction between the two ($F_{2,12} = 2.5, p = 0.125$). --->
</section>
<section id="解讀分析結果" class="level3" data-number="14.2.4">
<h3 data-number="14.2.4" class="anchored" data-anchor-id="解讀分析結果"><span class="header-section-number">14.2.4</span> 解讀分析結果</h3>
<p>在解釋因子ANOVA結果時，有幾個非常重要的事情需要考慮。首先，我們在單因子ANOVA中遇到的相同問題，即如果您獲得（例如）藥物的顯著主效應，它並不能告訴您哪些藥物彼此有差異。要找出這個答案，您需要進行額外的分析。稍後我們將討論可以在[指定對比方式的不同方法]和[事後檢驗]中運行的一些分析。對於交互作用效果也是如此。知道有顯著的交互作用並不能告訴您存在哪種類型的交互作用。同樣，您需要進行額外的分析。</p>
<p>其次，在獲得顯著的交互作用效果但沒有相應主效應的情況下，會出現非常奇特的解釋問題。有時候會發生這種情況。例如，在@fig-fig13-5 a中顯示的交叉互動中，這正是您會發現的情況。在這種情況下，主效應都不顯著，但交互作用效果顯著。這是一個難以解釋的情況，人們通常對此感到困惑。統計學家在這種情況下喜歡給出的一般建議是，當存在交互作用時，您不應該過多地關注主效應。他們這樣說的原因是，雖然從數學的角度看，主效應的檢驗完全有效，但是當存在顯著的交互作用效果時，主效應很少檢驗有趣的假設。回想一下@sec-What-hypotheses-are-we-testing，主效應的虛無假設是邊際均值彼此相等，邊際均值是由幾個不同組的平均值形成的。但是，如果您有一個顯著的交互作用效果，那麼您就知道組成邊際均值的組並不是同質的，所以真的不明顯為什麼您會關心那些邊際均值。</p>
<p>以下是我的意思。再次以臨床實例為例。假設我們有一個<span class="math inline">\(2 \times 2\)</span>設計，比較了兩種不同的恐懼症治療方法（例如，系統性緩解法和淹沒療法），以及兩種不同的減輕焦慮藥物（例如，Anxifree和Joyzepam）。現在，假設我們發現當緩解法是治療方法時，Anxifree無效；當淹沒療法是治療方法時，Joyzepam無效。但對於另一種治療方法，兩者都相當有效。這是一個典型的交叉互動，當我們運行ANOVA時，我們會發現沒有藥物的主要效果，但有顯著的互動。那麼，說沒有主效應究竟意味著什麼呢？那意味著，如果我們平均兩種不同的心理治療方法，那麼Anxifree和Joyzepam的平均效果是相同的。但是，有誰會在意這個呢？在治療恐懼症時，從來沒有一個人可以使用“平均”的淹沒療法和緩解法進行治療。這並不合理。您要么得到一個，要么得到另一個。對於一種治療方法，一種藥物是有效的，對於另一種治療方法，另一種藥物是有效的。交互作用是重要的，而主效應在某種程度上是無關緊要的。</p>
<p>這樣的事情經常發生。主效應是邊際均值的檢驗，當交互作用存在時，我們經常會發現自己對邊際均值不感興趣，因為它們意味著在交互作用告訴我們不應該取平均值的事物上取平均值！當然，並非總是在存在交互作用的情況下，主效應就毫無意義。經常出現的情況是，主效應很大，交互作用很小，這種情況下，您仍然可以說類似於“藥物A通常比藥物B更有效”（因為藥物效果很大），但您需要對其進行一些修改，添加“對於不同的心理治療，有效性差異有所不同。”無論如何，這裡的主要觀點是，每當您獲得顯著的交互作用時，您應該停下來思考主效應在這個語境中的真正意義。不要自動假設主效應是有趣的。</p>
<!--- There's a couple of very important things to consider when interpreting the results of factorial ANOVA. First, there's the same issue that we had with one-way ANOVA, which is that if you obtain a significant main effect of (say) drug, it doesn't tell you anything about which drugs are different to one another. To find that out, you need to run additional analyses. We'll talk about some analyses that you can run in later Sections: [Different ways to specify contrasts] and [Post hoc tests]. The same is true for interaction effects. Knowing that there's a significant interaction doesn't tell you anything about what kind of interaction exists. Again, you'll need to run additional analyses.

Secondly, there's a very peculiar interpretation issue that arises when you obtain a significant interaction effect but no corresponding main effect. This happens sometimes. For instance, in the crossover interaction shown in @fig-fig13-5 a, this is exactly what you'd find. In this case, neither of the main effects would be significant, but the interaction effect would be. This is a difficult situation to interpret, and people often get a bit confused about it. The general advice that statisticians like to give in this situation is that you shouldn't pay much attention to the main effects when an interaction is present. The reason they say this is that, although the tests of the main effects are perfectly valid from a mathematical point of view, when there is a significant interaction effect the main effects rarely test interesting hypotheses. Recall from @sec-What-hypotheses-are-we-testing that the null hypothesis for a main effect is that the marginal means are equal to each other, and that a marginal mean is formed by averaging across several different groups. But if you have a significant interaction effect then you know that the groups that comprise the marginal mean aren't homogeneous, so it's not really obvious why you would even care about those marginal means.

Here's what I mean. Again, let's stick with a clinical example. Suppose that we had a $2 \times 2$ design comparing two different treatments for phobias (e.g., systematic desensitisation vs flooding), and two different anxiety reducing drugs (e.g., Anxifree vs Joyzepam). Now, suppose what we found was that Anxifree had no effect when desensitisation was the treatment, and Joyzepam had no effect when flooding was the treatment. But both were pretty effective for the other treatment. This is a classic crossover interaction, and what we'd find when running the ANOVA is that there is no main effect of drug, but a significant interaction. Now, what does it actually mean to say that there's no main effect? Well, it means that if we average over the two different psychological treatments, then the average effect of Anxifree and Joyzepam is the same. But why would anyone care about that? When treating someone for phobias it is never the case that a person can be treated using an "average" of flooding and desensitisation. That doesn't make a lot of sense. You either get one or the other. For one treatment one drug is effective, and for the other treatment the other drug is effective. The interaction is the important thing and the main effect is kind of irrelevant.

This sort of thing happens a lot. The main effect are tests of marginal means, and when an interaction is present we often find ourselves not being terribly interested in marginal means because they imply averaging over things that the interaction tells us shouldn't be averaged! Of course, it's not always the case that a main effect is meaningless when an interaction is present. Often you can get a big main effect and a very small interaction, in which case you can still say things like "drug A is generally more effective than drug B" (because there was a big effect of drug), but you'd need to modify it a bit by adding that "the difference in effectiveness was different for different psychological treatments". In any case, the main point here is that whenever you get a significant interaction you should stop and think about what the main effect actually means in this context. Don't automatically assume that the main effect is interesting. --->
</section>
</section>
<section id="變異數分析的效果量" class="level2" data-number="14.3">
<h2 data-number="14.3" class="anchored" data-anchor-id="變異數分析的效果量"><span class="header-section-number">14.3</span> 變異數分析的效果量</h2>
<p>對於因子分析變異數分析（factorial ANOVA），效應量計算與單因素變異數分析中使用的非常相似（參見[效應量]部分）。具體來說，我們可以使用 <span class="math inline">\(\eta^2\)</span>（eta 平方）作為簡單衡量任何特定條款的整體效應大小的方法。與以前一樣，<span class="math inline">\(\eta^2\)</span>是通過將與該條款相關的平方和除以總平方和來定義的。例如，要確定因子A主效應的大小，我們將使用以下公式：</p>
<p><span class="math display">\[\eta_A^2=\frac{SS_A}{SS_T}\]</span></p>
<p>與以前一樣，這可以以與回歸中的 <span class="math inline">\(R^2\)</span> 類似的方式進行解釋。<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> 它告訴您由因子A的主效應解釋的結果變量變異的比例。因此，這是一個從0（完全沒有效果）到1（解釋結果變異的全部）的範圍內的數字。此外，所有<span class="math inline">\(\eta^2\)</span>值的總和，跨越模型中的所有條款，將總和為ANOVA模型的總<span class="math inline">\(R^2\)</span>。例如，如果ANOVA模型完美適合（即，根本沒有組內變異！），則<span class="math inline">\(\eta^2\)</span>值將總和為1。當然，這在現實生活中很少（如果有的話）發生。</p>
<p>然而，在進行因子分析變異數分析時，人們喜歡報告的效應量有第二種衡量方法，稱為部分 <span class="math inline">\(\eta^2\)</span>。部分 <span class="math inline">\(\eta^2\)</span>（有時表示為<span class="math inline">\(p^{\eta^2}\)</span> 或<span class="math inline">\(\eta_p^2\)</span>）背後的想法是，當衡量特定條款的效應量時（例如，因子A的主效應），您希望刻意忽略模型中的其他效應（例如，因子B的主效應）。也就是說，您想假設所有這些其他條款的效應都為零，然後計算<span class="math inline">\(\eta^2\)</span>值本來是什麼。這實際上很容易計算。您所要做的就是從分母中移除與其他條款相關的平方和。換句話說，如果您想要因子A主效應的部分<span class="math inline">\(\eta^2\)</span>，分母就是因子A和殘差的SS值之和。</p>
<p><span class="math display">\[\text{partial }\eta_A^2= \frac{SS_A}{SS_A+SS_R}\]</span></p>
<p>這將始終給您一個比<span class="math inline">\(\eta^2\)</span>更大的數字，這我猜想是部分<span class="math inline">\(\eta^2\)</span>受歡迎的原因。再次，您得到一個介於0和1之間的數字，其中0表示沒有影響。然而，解釋較大的部分<span class="math inline">\(\eta^2\)</span>值意味著什麼，這有點棘手。尤其是，您實際上無法比較不同條款的部分<span class="math inline">\(\eta^2\)</span>值！例如，假設根本沒有組內變異：如果是這樣，<span class="math inline">\(SS_R = 0\)</span>。這意味著每個條款的部分<span class="math inline">\(\eta^2\)</span>值都是1。但這並不意味著模型中的所有條款都同樣重要，或者它們的大小相同。這只是意味著模型中所有條款的效應量相對於殘差變化都很大。它無法跨條款進行比較。</p>
<p>要了解我的意思，查看具體示例非常有用。首先，讓我們看一下原始ANOVA（<a href="#tbl-tab13-6">表格&nbsp;<span>14.6</span></a>）中的效應量，無交互作用條款，來自@fig-fig13-3。</p>

<!--- The effect size calculation for a factorial ANOVA is pretty similar to those used in one way ANOVA (see [Effect size] section). Specifically, we can use $\eta^2$ (eta-squared) as a simple way to measure how big the overall effect is for any particular term. As before, $\eta^2$ is defined by dividing the sum of squares associated with that term by the total sum of squares. For instance, to determine the size of the main effect of Factor A, we would use the following formula:

$$\eta_A^2=\frac{SS_A}{SS_T}$$

As before, this can be interpreted in much the same way as $R^2$ in regression.[^factorial-anova-6] It tells you the proportion of variance in the outcome variable that can be accounted for by the main effect of Factor A. It is therefore a number that ranges from 0 (no effect at all) to 1 (accounts for all of the variability in the outcome). Moreover, the sum of all the $\eta^2$ values, taken across all the terms in the model, will sum to the the total $R^2$ for the ANOVA model. If, for instance, the ANOVA model fits perfectly (i.e., there is no within-groups variability at all!), the $\eta^2$ values will sum to 1. Of course, that rarely if ever happens in real life.

[^factorial-anova-6]: This chapter seems to be setting a new record for the number of different things that the letter R can stand for. So far we have R referring to the software package, the number of rows in our table of means, the residuals in the model, and now the correlation coefficient in a regression. Sorry. We clearly don't have enough letters in the alphabet. However, I've tried pretty hard to be clear on which thing R is referring to in each case

However, when doing a factorial ANOVA, there is a second measure of effect size that people like to report, known as partial $\eta^2$. The idea behind partial $\eta^2$ (which is sometimes denoted $p^{\eta^2}$ or $\eta_p^2$) is that, when measuring the effect size for a particular term (say, the main effect of Factor A), you want to deliberately ignore the other effects in the model (e.g., the main effect of Factor B). That is, you would pretend that the effect of all these other terms is zero, and then calculate what the $\eta^2$ value would have been. This is actually pretty easy to calculate. All you have to do is remove the sum of squares associated with the other terms from the denominator. In other words, if you want the partial $\eta^2$ for the main effect of Factor A, the denominator is just the sum of the SS values for Factor A and the residuals

$$\text{partial }\eta_A^2= \frac{SS_A}{SS_A+SS_R}$$

This will always give you a larger number than $\eta^2$, which the cynic in me suspects accounts for the popularity of partial $\eta^2$. And once again you get a number between 0 and 1, where 0 represents no effect. However, it's slightly trickier to interpret what a large partial $\eta^2$ value means. In particular, you can't actually compare the partial $\eta^2$ values across terms! Suppose, for instance, there is no within-groups variability at all: if so, $SS_R = 0$. What that means is that every term has a partial $\eta^2$ value of 1. But that doesn't mean that all terms in your model are equally important, or indeed that they are equally large. All it mean is that all terms in your model have effect sizes that are large relative to the residual variation. It is not comparable across terms.

To see what I mean by this, it's useful to see a concrete example. First, let's have a look at the effect sizes for the original ANOVA (@tbl-tab13-6) without the interaction term, from @fig-fig13-3. --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-6" class="anchored">
<table id="tab:tbl-tab13-6" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表格&nbsp;14.6: ANOVA模型<strong>未</strong>包括交互作用項目的效應量</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;"></td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">eta.sq</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">partial.eta.sq</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">drug</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.71</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.79</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">therapy</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.10</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.34</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>首先觀察<span class="math inline">\(\eta^2\)</span>值，我們可以看到藥物解釋了心情改善的71%變異（即<span class="math inline">\(\eta^2 = 0.71\)</span>），而治療僅解釋了10%。這使得總共有19%的變異未被解釋（即，殘差佔結果變異的19%）。整體來說，這意味著我們有非常大的藥物效應[^factorial-anova-7]和適中的治療效應。</p>
<p>[^factorial-anova-7]：我認為這個數值大得令人難以置信。這個數據集的人工特徵現在真的開始顯露出來了！</p>
<p>現在讓我們看看部分<span class="math inline">\(\eta^2\)</span>值，如@fig-fig13-3所示。由於治療的效果並不是很大，因此對其進行控制並不會產生很大的差異，所以藥物的部分<span class="math inline">\(\eta^2\)</span>不會增加很多，我們得到一個值<span class="math inline">\(p^{\eta^2} = 0.79\)</span>。相反，因為藥物的效果非常大，對其進行控制會產生很大的差異，因此當我們計算治療的部分<span class="math inline">\(\eta^2\)</span>時，可以看到它上升到<span class="math inline">\(p^{\eta^2} = 0.34\)</span>。我們必須問自己的問題是，這些部分<span class="math inline">\(\eta^2\)</span>值實際上意味著什麼？我通常將因子A主效應的部分<span class="math inline">\(\eta^2\)</span>解釋為關於僅因子A變化的假設實驗的說明。所以，即使在這個實驗中我們改變了A和B，我們可以很容易地想像一個僅因子A變化的實驗，部分<span class="math inline">\(\eta^2\)</span>統計數據告訴您在該實驗中預期結果變量的多少變異會被解釋。然而，應該注意的是，這種解釋，就像許多與主效應相關的事物一樣，在存在大的和顯著的交互作用效應時沒有太多意義。</p>
<p>說到交互作用效應，<span class="quarto-unresolved-ref">?tbl-tab13-7顯示了我們在包含交互作用條款的模型中計算效應大小時會得到什麼結果</span>，如@fig-fig13-7所示。如您所見，主效應的<span class="math inline">\(\eta^2\)</span>值沒有改變，但部分<span class="math inline">\(\eta^2\)</span>值發生了變化：</p>
<!--- Looking at the $\eta^2$ values first, we see that drug accounts for 71% of the variance (i.e. $\eta^2 = 0.71$) in mood.gain, whereas therapy only accounts for 10%. This leaves a total of 19% of the variation unaccounted for (i.e., the residuals constitute 19% of the variation in the outcome). Overall, this implies that we have a very large effect[^factorial-anova-7] of drug and a modest effect of therapy.

[^factorial-anova-7]: Implausibly large, I would think. The artificiality of this data set is really starting to show!

Now let's look at the partial $\eta^2$ values, shown in @fig-fig13-3. Because the effect of therapy isn't all that large, controlling for it doesn't make much of a difference, so the partial $\eta^2$ for drug doesn't increase very much, and we obtain a value of $p^{\eta^2} = 0.79$. In contrast, because the effect of drug was very large, controlling for it makes a big difference, and so when we calculate the partial $\eta^2$ for therapy you can see that it rises to $p^{\eta^2} = 0.34$. The question that we have to ask ourselves is, what do these partial $\eta^2$ values actually mean? The way I generally interpret the partial $\eta^2$ for the main effect of Factor A is to interpret it as a statement about a hypothetical experiment in which only Factor A was being varied. So, even though in this experiment we varied both A and B, we can easily imagine an experiment in which only Factor A was varied, and the partial $\eta^2$ statistic tells you how much of the variance in the outcome variable you would expect to see accounted for in that experiment. However, it should be noted that this interpretation, like many things associated with main effects, doesn't make a lot of sense when there is a large and significant interaction effect.

Speaking of interaction effects, @tbl-tab13-7 shows what we get when we calculate the effect sizes for the model that includes the interaction term, as in @fig-fig13-7. As you can see, the $\eta^2$ values for the main effects don't change, but the partial $\eta^2$ values do: --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-7" class="anchored">
<table id="tab:tbl-tab13-7" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表格&nbsp;14.7: ANOVA模型<strong>包含</strong>交互作用項目的效應大小</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;"></td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">eta.sq</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">partial.eta.sq</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">drug</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.71</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.84</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">therapy</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.10</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.42</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">drug*therapy</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0.06</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0.29</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<section id="估計組間平均" class="level3" data-number="14.3.1">
<h3 data-number="14.3.1" class="anchored" data-anchor-id="估計組間平均"><span class="header-section-number">14.3.1</span> 估計組間平均</h3>
<p>在許多情況下，您可能會想要根據ANOVA結果報告所有組均值的估計以及與之相關的置信區間。您可以使用jamovi ANOVA分析中的“估計邊際均值”選項來執行此操作，如@fig-fig13-8所示。如果您運行的ANOVA是一個飽和模型（即，包含所有可能的主效應和所有可能的交互作用效應），那麼組均值的估計實際上與樣本均值相同，儘管置信區間將使用標準誤差的合併估計而不是為每個組使用單獨的估計。</p>
<!--- In many situations you will find yourself wanting to report estimates of all the group means based on the results of your ANOVA, as well as confidence intervals associated with them. You can use the 'Estimated Marginal Means' option in the jamovi ANOVA analysis to do this, as in @fig-fig13-8. If the ANOVA that you have run is a saturated model (i.e., contains all possible main effects and all possible interaction effects) then the estimates of the group means are actually identical to the sample means, though the confidence intervals will use a pooled estimate of the standard errors rather than use a separate one for each group. --->
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-8" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-8.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">图&nbsp;14.8: jamovi屏幕截圖顯示了飽和模型的邊際均值，即包括臨床試驗數據集中的交互作用分量</figcaption>
</figure>
</div>
</div>
</div>
<p>在輸出中，我們看到安慰劑組無治療時的估計平均情緒增益為<span class="math inline">\(0.300\)</span>，<span class="math inline">\(95\%\)</span>置信區間從<span class="math inline">\(0.006\)</span>到<span class="math inline">\(0.594\)</span>。請注意，由於ANOVA模型假定方差同質性並因此使用方差的合併估計，這些置信區間與您單獨為每個組計算的置信區間不同。</p>
<p>當模型不包含交互作用項時，估計的組均值將與樣本均值不同。jamovi將根據邊際均值（即假定無交互作用）計算預期的組均值，而不是報告樣本均值。使用我們之前開發的符號，報告了μrc，對於（行）因子A上的第r級和（列）因子B上的第c級的均值，將是<span class="math inline">\(\mu_{..} + \alpha_r + \beta_c\)</span>。如果兩個因素之間確實沒有交互作用，那麼這實際上比原始樣本均值更好的估計了母體均值。通過jamovi ANOVA分析中的“Model”選項從模型中刪除交互作用項，為@fig-fig13-9所示的分析提供邊際均值。</p>
<!--- In the output we see that the estimated mean mood gain for the placebo group with no therapy was $0.300$, with a $95\%$ confidence interval from $0.006$ to $0.594$. Note that these are not the same confidence intervals that you would get if you calculated them separately for each group, because of the fact that the ANOVA model assumes homogeneity of variance and therefore uses a pooled estimate of the standard deviation.

When the model doesn't contain the interaction term, then the estimated group means will be different from the sample means. Instead of reporting the sample mean, jamovi will calculate the value of the group means that would be expected on the basis of the marginal means (i.e., assuming no interaction). Using the notation we developed earlier, the estimate reported for µrc, the mean for level r on the (row) Factor A and level c on the (column) Factor B would be $\mu_{..} + \alpha_r + \beta_c$. If there are genuinely no interactions between the two factors, this is actually a better estimate of the population mean than the raw sample mean would be. Removing the interaction term from the model, via the 'Model' options in the jamovi ANOVA analysis, provides the marginal means for the analysis shown in @fig-fig13-9. --->
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-9" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-9.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">图&nbsp;14.9: jamovi屏幕截圖顯示了未飽和模型的邊際均值，即未包括臨床試驗數據集中的交互作用分量</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="檢核變異數分析的執行條件" class="level2" data-number="14.4">
<h2 data-number="14.4" class="anchored" data-anchor-id="檢核變異數分析的執行條件"><span class="header-section-number">14.4</span> 檢核變異數分析的執行條件</h2>
<p>與單因素ANOVA一樣，因子ANOVA的關鍵假設是方差同質性（所有組具有相同的標準差）、殘差正態性和觀察值獨立性。前兩者是我們可以檢查的內容。對於第三點，您需要自己評估不同觀察值之間是否存在特殊關係，例如獨立變量是時間的重複測量，因此觀察值在時間1和時間2之間存在關係：不同時間點的觀察值來自同一個人。此外，如果您沒有使用飽和模型（例如，如果您省略了交互作用項），那麼您還假定省略的項不重要。當然，您可以通過運行包含省略項的ANOVA來檢查這最後一點，看看它們是否顯著，所以這非常簡單。那麼方差同質性和殘差正態性呢？事實證明，這些非常容易檢查。這與我們為單因素ANOVA所做的檢查沒有區別。</p>
<!--- As with one-way ANOVA, the key assumptions of factorial ANOVA are homogeneity of variance (all groups have the same standard deviation), normality of the residuals, and independence of the observations. The first two are things we can check for. The third is something that you need to assess yourself by asking if there are any special relationships between different observations, for example repeated measures where the independent variable is time so there is a relationship between the observations at time one and time two: observations at different time points are from the same people. Additionally, if you aren't using a saturated model (e.g., if you've omitted the interaction terms) then you're also assuming that the omitted terms aren't important. Of course, you can check this last one by running an ANOVA with the omitted terms included and see if they're significant, so that's pretty easy. What about homogeneity of variance and normality of the residuals? As it turns out, these are pretty easy to check. It's no different to the checks we did for a one-way ANOVA. --->
<section id="變異數的同質性" class="level3" data-number="14.4.1">
<h3 data-number="14.4.1" class="anchored" data-anchor-id="變異數的同質性"><span class="header-section-number">14.4.1</span> 變異數的同質性</h3>
<p>正如上一章 <a href="13-Comparing-several-means-one-way-ANOVA.html#sec-Checking-the-homogeneity-of-variance-assumption"><span>章节&nbsp;13.6.1</span></a> 中提到的，最好是通過視覺檢查標準差在不同組/類別之間的比較圖，並查看Levene檢驗是否與視覺檢查一致。Levene檢驗的理論在 <span class="quarto-unresolved-ref">?sec-Checking-the-homogeneity-of-variance-assumption中</span> 討論過，所以我不再討論。該檢驗要求您使用一個飽和模型（即，包含所有相關條款），因為該檢驗主要關注的是組內方差，而不是使用與完整模型相關的其他方法計算。在jamovi中，可以在ANOVA ‘Assumption Checks’ - ’Homogeneity Tests’選項下指定Levene檢驗，結果如 <a href="#fig-fig13-10">图&nbsp;<span>14.10</span></a> 所示。Levene檢驗的非顯著性意味著，只要與標準差圖的視覺檢查一致，我們就可以放心地假定方差同質性假設沒有被違反。</p>
<!--- As mentioned in @sec-Checking-the-homogeneity-of-variance-assumption in the last chapter, it's a good idea to visually inspect a plot of the standard deviations compared across different groups / categories, and also see if the Levene test is consistent with the visual inspection. The theory behind the Levene test was discussed in @sec-Checking-the-homogeneity-of-variance-assumption, so I won't discuss it again. This test expects that you have a saturated model (i.e., including all of the relevant terms), because the test is primarily concerned with the within-group variance, and it doesn't really make a lot of sense to calculate this any way other than with respect to the full model. The Levene test can be specified under the ANOVA 'Assumption Checks' - 'Homogeneity Tests' option in jamovi, with the result shown as in @fig-fig13-10. The fact that the Levene test is non-significant means that, providing it is consistent with a visual inspection of the plot of standard deviations, we can safely assume that the homogeneity of variance assumption is not violated. --->
</section>
<section id="殘差的常態性" class="level3" data-number="14.4.2">
<h3 data-number="14.4.2" class="anchored" data-anchor-id="殘差的常態性"><span class="header-section-number">14.4.2</span> 殘差的常態性</h3>
<p>與單因素ANOVA一樣，我們可以用直接的方式測試殘差的正態性（參見 <a href="13-Comparing-several-means-one-way-ANOVA.html#sec-Checking-the-normality-assumption"><span>章节&nbsp;13.6.4</span></a> )。然而，通常最好是使用QQ圖以圖形方式檢查殘差。請參見 <a href="#fig-fig13-10">图&nbsp;<span>14.10</span></a> 。</p>
<!--- As with one-way ANOVA we can test for the normality of residuals in a straightforward fashion (see @sec-Checking-the-normality-assumption). Primarily though, it's generally a good idea to examine the residuals graphically using a QQ plot. See @fig-fig13-10. --->
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-10" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-10.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">图&nbsp;14.10: 檢查ANOVA模型的假設</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="sec-analysis-of-covariance-ancova" class="level2" data-number="14.5">
<h2 data-number="14.5" class="anchored" data-anchor-id="sec-analysis-of-covariance-ancova"><span class="header-section-number">14.5</span> 共變數分析 (ANCOVA)</h2>
<p>ANOVA的一種變體是當您擁有一個可能與因變量相關的額外連續變量時。這個額外的變量可以作為協變量添加到分析中，正如協方差分析（ANCOVA）這個貼切的名稱所示。</p>
<p>在ANCOVA中，因變量的值會根據協變量的影響進行「調整」，然後以通常的方式在各組之間測試「調整後」的均值。這種技術可以提高實驗的精確性，因此提供了對因變量中組均值相等性的更「有效」的檢驗。ANCOVA是如何做到這一點的呢？儘管協變量本身通常不是實驗性的，但對協變量的調整可以降低實驗誤差的估計，從而通過減少誤差變異，提高精確性。這意味著不適當地無法拒絕虛無假設（偽陰性或第二類錯誤）的可能性較小。</p>
<p>儘管存在這個優勢，ANCOVA仍然存在解除組間實際差異的風險，這應該避免。例如，看看@fig-fig13-11，它顯示了統計焦慮與年齡的關係，並顯示了兩個不同的組別–具有藝術或科學背景或偏好的學生。以年齡為協變量的ANCOVA可能會得出統計焦慮在兩個組別之間沒有差異的結論。這個結論是否合理呢？很可能不合理，因為兩個組別的年齡不重疊，方差分析實質上是「將結果外推到沒有數據的區域」（<span class="citation" data-cites="Everitt1996">Everitt (<a href="References.html#ref-Everitt1996" role="doc-biblioref">1996</a>)</span>，第68頁）。</p>
<!--- A variation in ANOVA is when you have an additional continuous variable that you think might be related to the dependent variable. This additional variable can be added to the analysis as a covariate, in the aptly named analysis of covariance (ANCOVA).

In ANCOVA the values of the dependent variable are "adjusted" for the influence of the covariate, and then the "adjusted" score means are tested between groups in the usual way. This technique can increase the precision of an experiment, and therefore provide a more "powerful" test of the equality of group means in the dependent variable. How does ANCOVA do this? Well, although the covariate itself is typically not of any experimental interest, adjustment for the covariate can decrease the estimate of experimental error and thus, by reducing error variance, precision is increased. This means that an inappropriate failure to reject the null hypothesis (false negative or type II error) is less likely.

Despite this advantage, ANCOVA runs the risk of undoing real differences between groups, and this should be avoided. Look at @fig-fig13-11, for example, which shows a plot of Statistics anxiety against age and shows two distinct groups -- students who have either an Arts or Science background or preference. ANCOVA with age as a covariate might lead to the conclusion that statistics anxiety does not differ in the two groups. Would this conclusion be reasonable -- probably not because the ages of the two groups do not overlap and analysis of variance has essentially "extrapolated into a region with no data" (@Everitt1996, p. 68). --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-11" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-11.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">图&nbsp;14.11: 統計焦慮與年齡的圖示，對於兩個不同的組別</figcaption>
</figure>
</div>
</div>
</div>
<p>顯然，需要仔細考慮對區別鮮明的組別進行協方差分析。這適用於單因素和因子設計，因為ANCOVA可以用於兩者。</p>
<!---Clearly, careful thought needs to be given to an analysis of covariance with distinct groups. This applies to both one-way and factorial designs, as ANCOVA can be used with both.--->
<section id="使用jamovi完成共變數分析" class="level3" data-number="14.5.1">
<h3 data-number="14.5.1" class="anchored" data-anchor-id="使用jamovi完成共變數分析"><span class="header-section-number">14.5.1</span> 使用jamovi完成共變數分析</h3>
<p>一位健康心理學家對例行騎自行車和壓力對幸福程度的影響感興趣，並將年齡作為協變量。您可以在<em>ancova.csv</em>文件中找到數據集。在jamovi中打開此文件，然後選擇分析 - ANOVA - ANCOVA 以打開ANCOVA分析窗口（<a href="#fig-fig13-12">图&nbsp;<span>14.12</span></a>）。突顯因變量「幸福」，將其轉移到「因變量」文本框中。突顯自變量「壓力」和「通勤」，將它們轉移到「固定因素」文本框中。突顯協變量「年齡」，將其轉移到「協變量」文本框中。然後單擊估計邊際均值以顯示圖表和表格選項。</p>

<!---A health psychologist was interested in the effect of routine cycling and stress on happiness levels, with age as a covariate. You can find the dataset in the file *ancova.csv*. Open this file in jamovi and then, to undertake an ANCOVA, select Analyses - ANOVA - ANCOVA to open the ANCOVA analysis window (@fig-fig13-12). Highlight the dependent variable 'happiness' and transfer it into the 'Dependent Variable' text box. Highlight the independent variables 'stress' and 'commute' and transfer them into the 'Fixed Factors' text box. Highlight the covariate 'age' and transfer it into the 'Covariates' text box. Then Click on Estimated Marginal Means to bring up the plots and tables options. --->
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-12" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-12.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">图&nbsp;14.12: jamovi ANCOVA分析窗口</figcaption>
</figure>
</div>
</div>
</div>
<p>jamovi結果窗口中產生了一個顯示主題效應測試的ANCOVA表格（<a href="#fig-fig13-13">图&nbsp;<span>14.13</span></a>）。協變量「年齡」的F值在 <span class="math inline">\(p = .023\)</span> 上顯著，這表明年齡是影響因變量幸福的重要預測因子。當我們查看估計的邊際平均分數（<a href="#fig-fig13-14">图&nbsp;<span>14.14</span></a>）時，由於在此ANCOVA中包含協變量「年齡」，所以已進行了調整（與未包含協變量的分析相比）。圖表（<a href="#fig-fig13-15">图&nbsp;<span>14.15</span></a>）是一個很好的視覺化和解釋顯著效應的方法。</p>

<!--- An ANCOVA table showing Tests of Between-Subjects Effects is produced in the jamovi results window (@fig-fig13-13). The F value for the covariate 'age' is significant at $p = .023$, suggesting that age is an important predictor of the dependent variable, happiness. When we look at the estimated marginal mean scores (@fig-fig13-14), adjustments have been made (compared to an analysis without the covariate) because of the inclusion of the covariate 'age' in this ANCOVA. A plot (@fig-fig13-15) is a good way of visualising and interpreting the significant effects. --->
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-13" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-13.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">图&nbsp;14.13: jamovi ANCOVA輸出，將幸福度作為壓力和通勤方法的函數，年齡作為協變量</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-14" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-14.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">图&nbsp;14.14: 作為壓力和通勤方式函數的平均幸福水平表（根據協變量年齡進行調整），帶有95％置信區間</figcaption>
</figure>
</div>
</div>
</div>
<p><span class="math inline">\(F\)</span> 值主要效果「壓力」（52.61）的相應概率為 <span class="math inline">\(p &lt; .001\)</span>。主要效果「通勤」（42.33）的 <span class="math inline">\(F\)</span> 值的相應概率為 <span class="math inline">\(p &lt; .001\)</span>。由於這兩者都小於通常用於判定統計結果是否顯著的概率（<span class="math inline">\(p &lt; .05\)</span>），我們可以得出壓力的顯著主要效應（<span class="math inline">\(F(1, 15) = 52.61, p &lt; .001\)</span>）和通勤方式的顯著主要效應（<span class="math inline">\(F(1, 15) = 42.33, p &lt; .001\)</span>）。還發現了壓力和通勤方式之間的顯著交互作用（<span class="math inline">\(F(1, 15) = 14.15, p = .002\)</span>）。</p>
<p>在 <a href="#fig-fig13-15">图&nbsp;<span>14.15</span></a> 中，我們可以看到年齡作為協變量時的調整後、邊際的平均幸福分數。在這個分析中，存在一個顯著的交互效應，即壓力較低的騎自行車上班的人比壓力較低的開車上班的人和壓力較高的人（無論他們是騎自行車還是開車上班）更幸福。還有壓力的顯著主要效應——壓力較低的人比壓力較高的人更幸福。而且通勤行為的顯著主要效應也是如此——平均而言，騎自行車上班的人比開車上班的人更幸福。</p>
<!--- The $F$ value for the main effect 'stress' (52.61) has an associated probability of $p < .001$. The $F$ value for the main effect 'commute' (42.33) has an associated probability of $p < .001$. Since both of these are less than the probability that is typically used to decide if a statistical result is significant ($p < .05$) we can conclude that there was a significant main effect of stress ($F(1, 15) = 52.61, p < .001$) and a significant main effect of commuting method ($F(1, 15) = 42.33, p < .001$). A significant interaction between stress and commuting method was also found ($F(1, 15) = 14.15, p = .002$).

In @fig-fig13-15 we can see the adjusted, marginal, mean happiness scores when age is a covariate in an ANCOVA. In this analysis there is a significant interaction effect, whereby people with low stress who cycle to work are happier than people with low stress who drive and people with high stress whether they cycle or drive to work. There is also a significant main effect of stress -- people with low stress are happier than those with high stress. And there is also a significant main effect of commuting behaviour -- people who cycle are happier, on average, than those who drive to work. --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-15" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-15.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">图&nbsp;14.15: 作為壓力和通勤方式函數的平均幸福水平圖</figcaption>
</figure>
</div>
</div>
</div>
<p>需要注意的一點是，如果您想在 ANOVA 中包含協變量，那麼還有一個額外的假設：協變量與因變量之間的關係應對所有自變量的水平都是相似的。這可以通過在 jamovi Model - Model terms 選項中為協變量和每個自變量添加交互項來檢查。如果交互效應不顯著，則可以將其移除。如果它顯著，則可能需要使用更高級的統計技術（這超出了本書的範疇，所以您可能需要諮詢一位友好的統計學家）。總之，在進行 ANCOVA 分析時，要仔細考慮協變量與自變量的關係，以確保結果的準確性和有效性。</p>
<blockquote class="blockquote">
<p>總的來說，ANCOVA 分析可以幫助我們更好地瞭解不同變量之間的關係，並通過引入協變量來提高實驗的精確性。然而，在實際應用中，我們需要仔細思考和評估協變量的選擇，以確保結果的可靠性。在進行分析時，要注意檢查假設，並在必要時尋求統計專家的幫助。</p>
</blockquote>
<!--- One thing to be aware of is that, if you are thinking of including a covariate in your ANOVA, there is an additional assumption: the relationship between the covariate and the dependent variable should be similar for all levels of the independent variable. This can be checked by adding an interaction term between the covariate and each independent variable in the jamovi Model - Model terms option. If the interaction effect is not significant it can be removed. If it is significant then a different and more advanced statistical technique might be appropriate (which is beyond the scope of this book so you might want to consult a friendly statistician). --->
</section>
</section>
<section id="sec-ANOVA-as-a-linear-model" class="level2" data-number="14.6">
<h2 data-number="14.6" class="anchored" data-anchor-id="sec-ANOVA-as-a-linear-model"><span class="header-section-number">14.6</span> 變異數分析就是線性模型</h2>
<p>一個非常重要的事情是要了解 ANOVA 和回歸實際上是一回事。從表面上看，您可能不會認為這是真的。畢竟，到目前為止我對它們的描述表明 ANOVA 主要關注測試組間差異，而回歸主要關注瞭解變量之間的相關性。在這一點上，這完全沒錯。但是當你深入了解時，所謂的 ANOVA 和回歸的基本機制非常相似。事實上，如果你仔細想想，你已經看到了這一點的證據。 ANOVA 和回歸都依賴於平方和 (SS)，都使用 F 檢驗等。回顧過去，很難逃避這樣的感覺： <a href="12-Correlation-and-linear-regression.html"><span>章节&nbsp;12</span></a> 和 <a href="13-Comparing-several-means-one-way-ANOVA.html"><span>章节&nbsp;13</span></a> 有點重複。</p>
<p>這樣做的原因是 ANOVA 和回歸都是<strong>線性模型</strong>。在回歸的情況下，這是顯而易見的。我們用來定義預測因素和結果之間關係的回歸方程是一條直線的方程，所以這顯然是一個線性模型，方程式為</p>
<p><span class="math display">\[Y_p=b_0+b_1 X_{1p} +b_2 X_{2p} + \epsilon_p\]</span></p>
<p>其中 <span class="math inline">\(Y_p\)</span> 是第 p 次觀察（例如，第 p 個人）的結果值，<span class="math inline">\(X_{1p}\)</span> 是第 p 次觀察的第一個預測因子的值，<span class="math inline">\(X_{2p}\)</span> 是第 p 次觀察的第二個預測因子的值，<span class="math inline">\(b_0\)</span>，<span class="math inline">\(b_1\)</span> 和 <span class="math inline">\(b_2\)</span> 是我們的回歸係數，<span class="math inline">\(\epsilon_p\)</span> 是第 p 個殘差。如果我們忽略殘差 <span class="math inline">\(\epsilon_p\)</span>，僅關注回歸線本身，我們得到以下公式：</p>
<p><span class="math display">\[\hat{Y}_p=b_0+b_1 X_{1p} +b_2 X_{2p} \]</span></p>
<p>其中 <span class="math inline">\(\hat{Y}_p\)</span> 是回歸線為第 p 個人預測的 Y 值，而不是實際觀察到的值 <span class="math inline">\(Y_p\)</span>。不是立即顯而易見的事情是，我們可以將 ANOVA 也寫成線性模型。然而，實際上這非常簡單。讓我們從一個非常簡單的例子開始，將 <span class="math inline">\(2 \times 2\)</span> 因子 ANOVA 重寫為線性模型。</p>
<!---為了將 ANOVA 轉換為線性模型，我們需要用不同的方式表示變量。對於回歸，我們可以通過觀察一個連續變量（例如，年齡）來預測另一個連續變量（例如，收入）。然而，對於 ANOVA，我們試圖比較一個分類變量（例如，性別）的不同組別。為了將 ANOVA 重寫為線性模型，我們需要將分類變量轉換為一系列虛擬（或指示）變量，這些變量采用 0 和 1 的值。然後，我們可以將這些虛擬變量用作回歸模型中的預測因子。

以 $2 \times 2$ 因子 ANOVA 為例，我們可以通過將兩個分類變量的每個水平轉換為一個虛擬變量來重寫線性模型。因此，我們將具有以下形式的線性模型：

$$\hat{Y}_p=b_0+b_1 X_{1p} +b_2 X_{2p} +b_3 X_{1p} X_{2p} $$

其中 $X_{1p}$ 和 $X_{2p}$ 是經過轉換的虛擬變量，它們的值為 0 或 1。我們可以將 ANOVA 中的組別平均值表示為這些回歸係數，並將組間平方和、組內平方和等概念直接與回歸模型中的平方和相關聯。

總之，ANOVA 和回歸都可以表示為線性模型，它們之間的區別主要在於我們如何表示變量和預測因子。儘管 ANOVA 和回歸在概念上可能看起來有所不同，但它們在統計上是密切相關的。這意味著，無論我們在研究中使用哪種方法，都可以將它們視為解決相同問題的不同角度。在許多情況下，這使我們能夠更靈活地應對問題，並更好地理解我們的 --->
<!--- One of the most important things to understand about ANOVA and regression is that they're basically the same thing. On the surface of it, you maybe wouldn't think this is true. After all, the way that I've described them so far suggests that ANOVA is primarily concerned with testing for group differences, and regression is primarily concerned with understanding the correlations between variables. And, as far as it goes that's perfectly true. But when you look under the hood, so to speak, the underlying mechanics of ANOVA and regression are awfully similar. In fact, if you think about it, you've already seen evidence of this. ANOVA and regression both rely heavily on sums of squares (SS), both make use of F tests, and so on. Looking back, it's hard to escape the feeling that  @sec-Correlation-and-linear-regression and @sec-Comparing-several-means-one-way-ANOVA were a bit repetitive.

The reason for this is that ANOVA and regression are both kinds of **linear models**. In the case of regression, this is kind of obvious. The regression equation that we use to define the relationship between predictors and outcomes is the equation for a straight line, so it's quite obviously a linear model, with the equation

$$Y_p=b_0+b_1 X_{1p} +b_2 X_{2p} + \epsilon_p$$

where $Y_p$ is the outcome value for the p-th observation (e.g., p-th person), $X_{1p}$ is the value of the first predictor for the p-th observation, $X_{2p}$ is the value of the second predictor for the p-th observation, the $b_0$, $b_1$, and $b_2$ terms are our regression coefficients, and $\epsilon_p$ is the p-th residual. If we ignore the residuals $\epsilon_p$ and just focus on the regression line itself, we get the following formula:

$$\hat{Y}_p=b_0+b_1 X_{1p} +b_2 X_{2p} $$

where $\hat{Y}_p$ is the value of Y that the regression line predicts for person p, as opposed to the actually-observed value $Y_p$. The thing that isn't immediately obvious is that we can write ANOVA as a linear model as well. However, it's actually pretty straightforward to do this. Let's start with a really simple example, rewriting a $2 \times 2$ factorial ANOVA as a linear model. --->
<section id="示範資料" class="level3" data-number="14.6.1">
<h3 data-number="14.6.1" class="anchored" data-anchor-id="示範資料"><span class="header-section-number">14.6.1</span> 示範資料</h3>
<p>為了具體說明，假設我們的結果變量是學生在我的課堂上獲得的成績，這是一個比例尺度變量，對應於 <span class="math inline">\(0％\)</span> 到 <span class="math inline">\(100％\)</span> 的分數。有兩個感興趣的預測變量：學生是否參加了課程（出席變量）以及學生是否真正閱讀了教科書（閱讀變量）。我們將假設如果學生參加課程，那麼 attend = 1，如果他們沒有參加，那麼 attend = 0。同樣，如果學生閱讀了教科書，我們將說 reading = 1，如果他們沒有，那麼 reading = 0。</p>
<p>好吧，到目前為止，這還算簡單。接下來我們需要做的是將一些數學概念應用在這裡（抱歉！）。為了舉例，讓 <span class="math inline">\(Y_p\)</span> 表示課堂中第 p 個學生的成績。這與我們在本章前面使用的符號不完全相同。以前，我們用符號 <span class="math inline">\(Y_{rci}\)</span> 來表示第 1 個預測因子的第 r 個組中的第 i 個人（行因子）和第 2 個預測因子的第 c 個組（列因子）。這種擴展符號對於描述如何計算 SS 值非常方便，但在目前的情況下很繁瑣，所以我在這裡更換符號。現在，<span class="math inline">\(Y_p\)</span> 符號比 <span class="math inline">\(Y_{rci}\)</span> 更簡單，但它的缺點是它實際上沒有跟踪組成員資訊！也就是說，如果我告訴你 <span class="math inline">\(Y_{0,0,3} = 35\)</span>，你會立刻知道我們在談論一個沒有上課（即 attend = 0）並且沒有閱讀教科書（即 reading = 0）的學生（事實上是第 3 個這樣的學生），並且最終未通過課程（成績 = 35）。但如果我告訴你 <span class="math inline">\(Y_p = 35\)</span>，你只知道第 p 個學生沒有取得好成績。我們在這裡丟失了一些關鍵資訊。當然，想想如何解決這個問題並不費力。相反，我們將引入兩個新變量 <span class="math inline">\(X_{1p}\)</span> 和 <span class="math inline">\(X_{2p}\)</span> 來追踪這些資訊。在我們假設的學生案例中，我們知道 <span class="math inline">\(X_{1p} = 0\)</span>（即 attend = 0）和 <span class="math inline">\(X_{2p} = 0\)</span>（即 reading = 0）。因此，數據可能如 <a href="#tbl-tab13-8">表格&nbsp;<span>14.8</span></a> 所示。</p>
<!--- To make things concrete, let's suppose that our outcome variable is the grade that a student receives in my class, a ratio-scale variable corresponding to a mark from $0%$ to $100%$. There are two predictor variables of interest: whether or not the student turned up to lectures (the attend variable) and whether or not the student actually read the textbook (the reading variable). We'll say that attend = 1 if the student attended class, and attend = 0 if they did not. Similarly, we'll say that reading = 1 if the student read the textbook, and reading = 0 if they did not.

Okay, so far that's simple enough. The next thing we need to do is to wrap some maths around this (sorry!). For the purposes of this example, let $Y_p$ denote the grade of the p-th student in the class. This is not quite the same notation that we used earlier in this chapter. Previously, we've used the notation $Y_{rci}$ to refer to the i-th person in the r-th group for predictor 1 (the row factor) and the c-th group for predictor 2 (the column factor). This extended notation was really handy for describing how the SS values are calculated, but it's a pain in the current context, so I'll switch notation here. Now, the $Y_p$ notation is visually simpler than $Y_{rci}$, but it has the shortcoming that it doesn't actually keep track of the group memberships! That is, if I told you that $Y_{0,0,3} = 35$, you'd immediately know that we're talking about a student (the 3rd such student, in fact) who didn't attend the lectures (i.e., attend = 0) and didn't read the textbook (i.e. reading = 0), and who ended up failing the class (grade = 35). But if I tell you that $Y_p = 35$, all you know is that the p-th student didn't get a good grade. We've lost some key information here. Of course, it doesn't take a lot of thought to figure out how to fix this. What we'll do instead is introduce two new variables $X_{1p}$ and $X_{2p}$ that keep track of this information. In the case of our hypothetical student, we know that $X_{1p} = 0$ (i.e., attend = 0) and $X_{2p} = 0$ (i.e., reading = 0). So the data might look like @tbl-tab13-8. --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-8" class="anchored">
<table id="tab:tbl-tab13-8" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表格&nbsp;14.8: 成績，出勤和閱讀教科書的數據</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;">person, \(p\)</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">grade, \(Y_p\)</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">attendance, \(X_{1p}\)</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">reading, \(X_{2p}\)</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">1</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">90</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">2</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">87</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">1</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">3</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">75</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">4</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">60</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">5</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">35</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">6</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">50</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">7</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">65</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">8</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">70</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">1</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>當然，這並沒有什麼特別之處。這正是我們期望看到的數據格式！請參閱數據文件 <em>rtfm.csv</em>。我們可以使用 jamovi 的 ‘Descriptives’ 分析來確認這個數據集對應於一個平衡設計，對於 attend 和 reading 的每個組合，都有 2 個觀測值。同樣，我們還可以為每個組合計算平均成績。這在 <a href="#fig-fig13-16">图&nbsp;<span>14.16</span></a> 中顯示。看著平均分數，人們會強烈感覺到閱讀課本和上課都非常重要。</p>
<!--- This isn't anything particularly special, of course. It's exactly the format in which we expect to see our data! See the data file *rtfm.csv*. We can use the jamovi 'Descriptives' analysis to confirm that this data set corresponds to a balanced design, with 2 observations for each combination of attend and reading. In the same way we can also calculate the mean grade for each combination. This is shown in @fig-fig13-16. Looking at the mean scores, one gets the strong impression that reading the text and attending the class both matter a lot. --->
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-16" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-16.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">图&nbsp;14.16: rtfm 數據集的 jamovi 描述性統計</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="以迴歸模型處理非連續因子" class="level3" data-number="14.6.2">
<h3 data-number="14.6.2" class="anchored" data-anchor-id="以迴歸模型處理非連續因子"><span class="header-section-number">14.6.2</span> 以迴歸模型處理非連續因子</h3>
<p>好吧，讓我們回到數學上的討論。現在，我們的數據已用三個數值變量表示：連續變量 <span class="math inline">\(Y\)</span> 和兩個二元變量 <span class="math inline">\(X_1\)</span> 和 <span class="math inline">\(X_2\)</span>。我希望您能認識到，我們的 <span class="math inline">\(2 \times 2\)</span> 因子分析變異數完全等同於迴歸模型</p>
<p><span class="math display">\[Y_p=b_0+b_1 X_{1p} + b_2 X_{2p} + \epsilon_p\]</span></p>
<p>當然，這正是我之前用來描述具有兩個預測變量的迴歸模型的完全相同的方程式！唯一的區別是 <span class="math inline">\(X_1\)</span> 和 <span class="math inline">\(X_2\)</span> 現在是二元變量（即，值只能為 0 或 1），而在迴歸分析中，我們期望 <span class="math inline">\(X_1\)</span> 和 <span class="math inline">\(X_2\)</span> 是連續的。有幾種方法可以說服您相信這一點。一個可能性是進行冗長的數學練習，證明這兩者是相同的。然而，我要冒昧地猜測，這本書的大多數讀者會覺得這很煩人而不是有幫助。相反，我將解釋基本思想，然後依賴 jamovi 來說明 ANOVA 分析和迴歸分析不僅相似，而且在所有意圖和目的上是相同的。讓我們首先將其作為 ANOVA 運行。為此，我們將使用 rtfm 數據集，<a href="#fig-fig13-17">图&nbsp;<span>14.17</span></a> 顯示了在 jamovi 中運行分析時我們得到的結果。</p>
<!--- Okay, let's get back to talking about the mathematics. We now have our data expressed in terms of three numeric variables: the continuous variable $Y$ and the two binary variables $X_1$ and $X_2$. What I want you to recognise is that our $2 \times 2$ factorial ANOVA is exactly equivalent to the regression model

$$Y_p=b_0+b_1 X_{1p} + b_2 X_{2p} + \epsilon_p$$

This is, of course, the exact same equation that I used earlier to describe a two-predictor regression model! The only difference is that $X_1$ and $X_2$ are now binary variables (i.e., values can only be 0 or 1), whereas in a regression analysis we expect that $X_1$ and $X_2$ will be continuous. There's a couple of ways I could try to convince you of this. One possibility would be to do a lengthy mathematical exercise proving that the two are identical. However, I'm going to go out on a limb and guess that most of the readership of this book will find that annoying rather than helpful. Instead, I'll explain the basic ideas and then rely on jamovi to show that ANOVA analyses and regression analyses aren't just similar, they're identical for all intents and purposes. Let's start by running this as an ANOVA. To do this, we'll use the rtfm data set, and @fig-fig13-17 shows what we get when we run the analysis in jamovi. --->
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-17" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-17.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">图&nbsp;14.17: 在 jamovi 中的 <em>rtfm.csv</em> 數據集 ANOVA，不包含交互作用項</figcaption>
</figure>
</div>
</div>
</div>
<p>好的，通過從 ANOVA 表和我們之前呈現的平均分數中讀取關鍵數字，我們可以看到，如果學生參加課程（<span class="math inline">\(F_{1,5} = 21.6, p = .0056\)</span>），他們的成績會更高，如果他們閱讀教材（<span class="math inline">\(F_{1,5} = 52.3, p = .0008\)</span>）。讓我們記下這些 p 值和這些 <span class="math inline">\(F\)</span> 統計數字。</p>
<p>現在讓我們從線性迴歸的角度考慮相同的分析。在 rtfm 數據集中，我們將 attend 和 reading 編碼為數值預測變量。在這種情況下，這是完全可以接受的。在某種意義上，參加課程的學生（即 attend = 1）事實上的確比沒有參加的學生（即 attend = 0）做了“更多的出席”。因此，將其作為迴歸模型中的預測變量完全不是不合理的。這有點不尋常，因為預測變量只有兩個可能的值，但這並不違反線性迴歸的任何假設。而且易於解釋。如果 attend 的迴歸係數大於 0，則意味著參加課程的學生會獲得更高的成績。如果小於零，那麼參加課程的學生會獲得較低的成績。對於我們的閱讀變量也是如此。</p>
<p>等一下。為什麼會這樣？這對於接受過幾堂統計課程並熟悉數學的人來說是直觀明顯的，但對其他人來說一開始並不清楚。要理解為什麼會這樣，有助於仔細觀察幾個特定的學生。讓我們首先考慮我們數據集中的第 6 位和第 7 位學生（即 <span class="math inline">\(p = 6\)</span> 和 <span class="math inline">\(p = 7\)</span>）。兩者都沒有閱讀教科書，因此在這兩種情況下，我們都可以將 reading 設為 0。換句話說，用我們的數學符號表示，我們觀察到 <span class="math inline">\(X_{2,6} = 0\)</span> 和 <span class="math inline">\(X_{2,7} = 0\)</span>。然而，第 7 位學生參加了課程（即 attend = 1，<span class="math inline">\(X_{1,7} = 1\)</span>），而第 6 位學生沒有參加（即 attend = 0，<span class="math inline">\(X_{1,6} = 0\)</span>）。現在讓我們看看當我們將這些數字插入迴歸線的一般公式時會發生什麼。對於第 6 位學生，迴歸預測：</p>
<p><span class="math display">\[
\begin{split}
\hat{Y}_6 &amp; = b_0 + b_1 X_{1,6} + b_2 X_{2,6} \\
&amp; = b_0 + (b_1 \times 0) + (b_2 \times 0) \\
&amp; = b_0
\end{split}
\]</span></p>
<p>因此，我們預計這位學生將獲得與截距項 <span class="math inline">\(b_0\)</span> 相對應的成績。那麼第 7 位學生呢？這次當我們將數字插入迴歸線公式時，我們得到以下結果：</p>
<p><span class="math display">\[
\begin{split}
\hat{Y}_7 &amp; = b_0 + b_1 X_{1,7} + b_2 X_{2,7} \\
&amp; = b_0 + (b_1 \times 1) + (b_2 \times 0) \\
&amp; = b_0 + b_1
\end{split}
\]</span></p>
<p>因為這位學生參加了課程，預計成績等於截距項 b0 加上與 attend 變量相關的係數 <span class="math inline">\(b_1\)</span>。所以，如果 <span class="math inline">\(b_1\)</span> 大於零，我們預期參加課程的學生將比那些沒有參加的學生獲得更高的成績。如果這個係數為負，我們則預期相反：上課的學生表現會更差。實際上，我們可以更進一步。第一位學生呢？他參加了課程（<span class="math inline">\(X_{1,1} = 1\)</span>），並且閱讀了教科書（<span class="math inline">\(X_{2,1} = 1\)</span>）？如果我們將這些數字插入迴歸，我們得到：</p>
<p><span class="math display">\[
\begin{split}
\hat{Y}_1 &amp; = b_0 + b_1 X_{1,1} + b_2 X_{2,1} \\
&amp; = b_0 + (b_1 \times 1) + (b_2 \times 1) \\
&amp; = b_0 + b_1 + b_2
\end{split}
\]</span></p>
<p>因此，如果我們假設參加課程有助於獲得好成績（即 <span class="math inline">\(b1 \&gt; 0\)</span>），並假設閱讀教科書也有助於獲得好成績（即 <span class="math inline">\(b2 \&gt; 0\)</span>），那麼我們的預期是，第 1 位學生將比第 6 位學生和第 7 位學生獲得更高的成績。</p>
<p>此時，你可能一點也不會感到驚訝地了解到迴歸模型預測，讀了書但沒有參加課程的第 3 位學生將獲得 <span class="math inline">\(b_{2} + b_{0}\)</span> 的成績。我不會再用另一個迴歸公式來煩悶你。相反，我將向你展示的是帶有<em>預期成績</em>的 <a href="#tbl-tab13-9">表格&nbsp;<span>14.9</span></a>。</p>

<!--- So, by reading the key numbers off the ANOVA table and the mean scores that we presented earlier, we can see that the students obtained a higher grade if they attended class ($F_{1,5} = 21.6, p = .0056$) and if they read the textbook ($F_{1,5} = 52.3, p = .0008$). Let's make a note of those p-values and those $F$ statistics.

Now let's think about the same analysis from a linear regression perspective. In the rtfm data set, we have encoded attend and reading as if they were numeric predictors. In this case, this is perfectly acceptable. There really is a sense in which a student who turns up to class (i.e. attend = 1) has in fact done "more attendance" than a student who does not (i.e. attend = 0). So it's not at all unreasonable to include it as a predictor in a regression model. It's a little unusual, because the predictor only takes on two possible values, but it doesn't violate any of the assumptions of linear regression. And it's easy to interpret. If the regression coefficient for attend is greater than 0 it means that students that attend lectures get higher grades. If it's less than zero then students attending lectures get lower grades. The same is true for our reading variable.

Wait a second though. Why is this true? It's something that is intuitively obvious to everyone who has taken a few stats classes and is comfortable with the maths, but it isn't clear to everyone else at first pass. To see why this is true, it helps to look closely at a few specific students. Let's start by considering the 6th and 7th students in our data set (i.e. $p = 6$ and $p = 7$). Neither one has read the textbook, so in both cases we can set reading = 0. Or, to say the same thing in our mathematical notation, we observe $X_{2,6} = 0$ and $X_{2,7} = 0$. However, student number 7 did turn up to lectures (i.e., attend = 1, $X_{1,7} = 1$) whereas student number 6 did not (i.e., attend = 0, $X_{1,6} = 0$). Now let's look at what happens when we insert these numbers into the general formula for our regression line. For student number 6, the regression predicts that

$$
\begin{split}
\hat{Y}_6 & = b_0 + b_1 X_{1,6} + b_2 X_{2,6} \\
& = b_0 + (b_1 \times 0) + (b_2 \times 0) \\
& = b_0
\end{split}
$$

So we're expecting that this student will obtain a grade corresponding to the value of the intercept term $b_0$. What about student 7? This time when we insert the numbers into the formula for the regression line, we obtain the following

$$
\begin{split}
\hat{Y}_7 & = b_0 + b_1 X_{1,7} + b_2 X_{2,7} \\
& = b_0 + (b_1 \times 1) + (b_2 \times 0) \\
& = b_0 + b_1
\end{split}
$$

Because this student attended class, the predicted grade is equal to the intercept term b0 plus the coefficient associated with the attend variable, $b_1$. So, if $b_1$ is greater than zero, we're expecting that the students who turn up to lectures will get higher grades than those students who don't. If this coefficient is negative we're expecting the opposite: students who turn up at class end up performing much worse. In fact, we can push this a little bit further. What about student number 1, who turned up to class ($X_{1,1} = 1$) and read the textbook ($X_{2,1} = 1$)? If we plug these numbers into the regression we get

$$
\begin{split}
\hat{Y}_1 & = b_0 + b_1 X_{1,1} + b_2 X_{2,1} \\
& = b_0 + (b_1 \times 1) + (b_2 \times 1) \\
& = b_0 + b_1 + b_2
\end{split}
$$

So if we assume that attending class helps you get a good grade (i.e., $b1 \> 0$) and if we assume that reading the textbook also helps you get a good grade (i.e., $b2 \> 0$), then our expectation is that student 1 will get a grade that that is higher than student 6 and student 7.

And at this point you won't be at all suprised to learn that the regression model predicts that student 3, who read the book but didn't attend lectures, will obtain a grade of $b_{2} + b_{0}$. I won't bore you with yet another regression formula. Instead, what I'll do is show you is @tbl-tab13-9 with the *expected grades*. --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-9" class="anchored">
<table id="tab:tbl-tab13-9" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表格&nbsp;14.9: 迴歸模型的預期成績</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;"></td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;"></td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">read textbook</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;"></td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;"></td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;"></td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">no</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">yes</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">attended?</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">no</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \beta_0 \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\( \beta_0 + \beta_2 \)</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;"></td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">yes</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\( \beta_0 + \beta_1 \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\( \beta_0 + \beta_1 + \beta_2 \)</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>正如你所看到的，截距項 <span class="math inline">\(b_0\)</span> 作為一種基線成績，用來表示那些沒有花時間參加課程或閱讀教科書的學生所期望的成績。同樣，<span class="math inline">\(b_1\)</span> 表示你預期能從上課中得到的提升，而 <span class="math inline">\(b_2\)</span> 表示閱讀教科書帶來的提升。事實上，如果這是一個 ANOVA，你可能很想將 b1 稱為出席的主要效應，將 <span class="math inline">\(b_2\)</span> 稱為閱讀的主要效應！事實上，對於一個簡單的 <span class="math inline">\(2 \times 2\)</span> ANOVA，情況確實是這樣。</p>
<p>好的，既然我們已經開始看到為什麼 ANOVA 和迴歸基本上是同一回事，讓我們實際運用 rtfm 數據和 jamovi 迴歸分析來確信這確實是真的。以通常的方式運行迴歸會得到 <a href="#fig-fig13-18">图&nbsp;<span>14.18</span></a> 中顯示的結果。</p>
<!--- As you can see, the intercept term $b_0$ acts like a kind of "baseline" grade that you would expect from those students who don't take the time to attend class or read the textbook. Similarly, $b_1$ represents the boost that you're expected to get if you come to class, and $b_2$ represents the boost that comes from reading the textbook. In fact, if this were an ANOVA you might very well want to characterise b1 as the main effect of attendance, and $b_2$ as the main effect of reading! In fact, for a simple $2 \times 2$ ANOVA that's exactly how it plays out.

Okay, now that we're really starting to see why ANOVA and regression are basically the same thing, let's actually run our regression using the rtfm data and the jamovi regression analysis to convince ourselves that this is really true. Running the regression in the usual way gives the results shown in @fig-fig13-18. --->
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-18" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-18.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">图&nbsp;14.18: 數據集<em>rtfm.csv</em> 在 jamovi 中的迴歸分析，無交互作用項</figcaption>
</figure>
</div>
</div>
</div>
<p>這裡有幾個有趣的地方需要注意。首先，注意截距項是 43.5，接近觀察到的那兩個既沒有閱讀文本也沒有參加課程的學生的 “組” 平均值 42.5。其次，注意我們得到了參加變量的迴歸係數 <span class="math inline">\(b_1 = 18.0\)</span>，這表明參加課程的學生比沒有參加課程的學生高出 18%。因此，我們的期望是，那些上課但沒有閱讀教科書的學生將獲得 <span class="math inline">\(b_0 + b_1\)</span> 的成績，即 <span class="math inline">\(43.5 + 18.0 = 61.5\)</span>。當我們觀察閱讀教科書的學生時，你可以自己驗證同樣的事情。</p>
<p>實際上，我們可以在建立 ANOVA 和迴歸等價性方面進一步推進。看看迴歸輸出中與 attend 變量和 reading 變量相關的 p 值。它們與我們之前在運行 ANOVA 時遇到的完全相同。這可能看起來有點奇怪，因為運行我們的迴歸模型時使用的檢驗計算了一個 t 統計量，而 ANOVA 計算了一個 F 統計量。然而，如果您還記得我們在 <a href="07-Introduction-to-probability.html"><span>章节&nbsp;7</span></a> 中提到的內容，t 分布和 F 分布之間存在著某種關係。如果你有一個根據 k 自由度的 t 分布的數量，然後將其平方，那麼這個新的平方數量就遵循一個自由度為 1 和 k 的 F 分布。對於我們迴歸模型中的 t 統計量，我們可以檢查這一點。對於 attend 變量，我們得到一個 t 值為 4.65。如果我們將這個數字平方，我們最終得到的是 21.6，這與我們 ANOVA 中相應的 F 統計量相匹配。</p>
<p>最後，你還應該知道一件事。因為 jamovi 瞭解到 ANOVA 和迴歸都是線性模型的例子，所以它允許您使用 ‘Linear Regression’ - ‘Model Coefficients’ - ‘Omnibus Test’ - ‘ANOVA Test’ 從迴歸模型中提取經典的 ANOVA 表，這將給你在 <a href="#fig-fig13-19">图&nbsp;<span>14.19</span></a> 中顯示的表格。</p>

<!--- There's a few interesting things to note here. First, notice that the intercept term is 43.5 which is close to the "group" mean of 42.5 observed for those two students who didn't read the text or attend class. Second, notice that we have the regression coefficient of $b_1 = 18.0$ for the attendance variable, suggesting that those students that attended class scored 18% higher than those who didn't. So our expectation would be that those students who turned up to class but didn't read the textbook would obtain a grade of $b_0 + b_1$, which is equal to $43.5 + 18.0 = 61.5$. You can verify for yourself that the same thing happens when we look at the students that read the textbook.

Actually, we can push a little further in establishing the equivalence of our ANOVA and our regression. Look at the p-values associated with the attend variable and the reading variable in the regression output. They're identical to the ones we encountered earlier when running the ANOVA. This might seem a little surprising, since the test used when running our regression model calculates a t-statistic and the ANOVA calculates an F-statistic. However, if you can remember all the way back to @sec-Introduction-to-probability, I mentioned that there's a relationship between the t-distribution and the F-distribution. If you have some quantity that is distributed according to a t-distribution with k degrees of freedom and you square it, then this new squared quantity follows an F-distribution whose degrees of freedom are 1 and k. We can check this with respect to the t statistics in our regression model. For the attend variable we get a t value of 4.65. If we square this number we end up with 21.6, which matches the corresponding F statistic in our ANOVA.

Finally, one last thing you should know. Because jamovi understands the fact that ANOVA and regression are both examples of linear models, it lets you extract the classic ANOVA table from your regression model using the 'Linear Regression' - 'Model Coefficients' - 'Omnibus Test' - 'ANOVA Test', and this will give you the table shown in @fig-fig13-19. --->
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-19" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-19.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">图&nbsp;14.19: jamovi迴歸分析的Omnibus ANOVA Test結果</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="比較因子間平均值的編碼" class="level3" data-number="14.6.3">
<h3 data-number="14.6.3" class="anchored" data-anchor-id="比較因子間平均值的編碼"><span class="header-section-number">14.6.3</span> 比較因子間平均值的編碼</h3>
<!---How to encode non binary factors as contrasts--->
<p>在這一點上，我已經向您展示了如何將 <span class="math inline">\(2 \times 2\)</span> ANOVA 轉換為線性模型。從而很容易看出這如何擴展到 <span class="math inline">\(2 \times 2 \times 2\)</span> ANOVA 或 <span class="math inline">\(2 \times 2 \times 2 \times 2\)</span> ANOVA。事實上，這是同一件事。對於每個因子，你只需添加一個新的二元變量。當我們考慮具有多於兩個級別的因子時，問題變得更加複雜。例如，考慮我們在本章前面使用<em>clinicaltrial.csv</em> 數據運行的 <span class="math inline">\(3 \times 2\)</span> ANOVA。我們如何將具有三個級別的藥物因子轉換為適合迴歸的數值形式？</p>
<p>事實上，這個問題的答案相當簡單。我們所要做的就是意識到三級因子可以被重新描述為兩個二元變量。假設，例如，我要創建一個名為 druganxifree 的新二元變量。每當藥物變量等於 “anxifree” 時，我們將 druganxifree 設為 1。否則，將 druganxifree 設為 0。這個變量設立了一個<strong>對比</strong>，在這種情況下是在 anxifree 和其他兩種藥物之間。當然，僅憑 druganxifree 對比還不足以完全捕捉我們藥物變量中的所有信息。我們需要第二個對比，一個能讓我們區分 joyzepam 和安慰劑的對比。為此，我們可以創建第二個二元對比，名為 drugjoyzepam，如果藥物是 joyzepam，則等於 1，否則等於 0。這兩個對比結合在一起，使我們能夠完美區分所有三種可能的藥物。<a href="#tbl-tab13-10">表格&nbsp;<span>14.10</span></a> 說明了這一點。</p>
<!--- At this point, I've shown you how we can view a $2 \times 2$ ANOVA into a linear model. And it's pretty easy to see how this generalises to a $2 \times 2 \times 2$ ANOVA or a $2 \times 2 \times 2 \times 2$ ANOVA. It's the same thing, really. You just add a new binary variable for each of your factors. Where it begins to get trickier is when we consider factors that have more than two levels. Consider, for instance, the $3 \times 2$ ANOVA that we ran earlier in this chapter using the *clinicaltrial.csv*  data. How can we convert the three-level drug factor into a numerical form that is appropriate for a regression?

The answer to this question is pretty simple, actually. All we have to do is realise that a three-level factor can be redescribed as two binary variables. Suppose, for instance, I were to create a new binary variable called druganxifree. Whenever the drug variable is equal to "anxifree" we set druganxifree = 1. Otherwise, we set druganxifree = 0. This variable sets up a **contrast**, in this case between anxifree and the other two drugs. By itself, of course, the druganxifree contrast isn't enough to fully capture all of the information in our drug variable. We need a second contrast, one that allows us to distinguish between joyzepam and the placebo. To do this, we can create a second binary contrast, called drugjoyzepam, which equals 1 if the drug is joyzepam and 0 if it is not. Taken together, these two contrasts allows us to perfectly discriminate between all three possible drugs. @tbl-tab13-10 illustrates this. --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-10" class="anchored">
<table id="tab:tbl-tab13-10" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表格&nbsp;14.10: 二元對比以區分所有三種可能的藥物</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;">drug</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">druganxifree</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">drugjoyzepam</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">"placebo"</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">"anxifree"</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">"joyzepam"</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">1</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>如果給病人用的藥物是安慰劑，那麼這兩個對比變量都將等於 0。如果藥物是 Anxifree，那麼 druganxifree 變量將等於 1，而 drugjoyzepam 將為 0。對於 Joyzepam，情況剛好相反：drugjoyzepam 為 1，而 druganxifree 為 0。</p>
<p>使用 jamovi 計算新變量命令創建對比變量並不困難。例如，要創建 druganxifree 變量，請在計算新變量公式框中編寫此邏輯表達式：IF(drug == ‘anxifree’, 1, 0)‘。同樣，要創建新變量 drugjoyzepam，請使用此邏輯表達式：IF(drug == ’joyzepam’, 1, 0)。對於 CBTtherapy，請使用：IF(therapy == ‘CBT’, 1, 0)。您可以在 jamovi 數據文件 <em>clinicaltrial2.omv</em> 中查看這些新變量和相應的邏輯表達式。</p>
<p>我們現在已經將三級因子根據兩個二元變量進行了重新編碼，我們已經看到，對於二元變量，ANOVA 和迴歸的行為方式是相同的。然而，在這種情況下，還有一些額外的複雜性，我們將在下一節中討論。</p>
<!-- If the drug administered to a patient is a placebo then both of the two contrast variables will equal 0. If the drug is Anxifree then the druganxifree variable will equal 1, and drugjoyzepam will be 0. The reverse is true for Joyzepam: drugjoyzepam is 1 and druganxifree is 0.

Creating contrast variables is not too difficult to do using the jamovi compute new variable command. For example, to create the druganxifree variable, write this logical expression in the compute new variable formula box: IF(drug == 'anxifree', 1, 0)'. Similarly, to create the new variable drugjoyzepam use this logical expression: IF(drug == 'joyzepam', 1, 0). Likewise for CBTtherapy: IF(therapy == 'CBT', 1, 0). You can see these new variables, and the corresponding logical expressions, in the jamovi data file *clinicaltrial2.omv* .

We have now recoded our three-level factor in terms of two binary variables, and we've already seen that ANOVA and regression behave the same way for binary variables. However, there are some additional complexities that arise in this case, which we'll discuss in the next section. --->
</section>
<section id="變異數分析與非二元因子迴歸分析的等價性" class="level3" data-number="14.6.4">
<h3 data-number="14.6.4" class="anchored" data-anchor-id="變異數分析與非二元因子迴歸分析的等價性"><span class="header-section-number">14.6.4</span> 變異數分析與非二元因子迴歸分析的等價性</h3>
<p>現在，我們有兩個不同版本的相同數據集。我們的原始數據中，<em>clinicaltrial.csv</em> 文件中的藥物變量表示為單個三級因子，而在擴展數據 <em>clinicaltrial2.omv</em> 中，它擴展為兩個二元對比。再次，我們想要證明的是，我們原來的 <span class="math inline">\(3 \times 2\)</span> 因子 ANOVA 等同於應用於對比變量的迴歸模型。讓我們首先重新執行 ANOVA，結果顯示在 <a href="#fig-fig13-20">图&nbsp;<span>14.20</span></a>。</p>
<!--- Now we have two different versions of the same data set. Our original data in which the drug variable from the *clinicaltrial.csv*  file is expressed as a single three-level factor, and the expanded data *clinicaltrial2.omv*  in which it is expanded into two binary contrasts. Once again, the thing that we want to demonstrate is that our original $3 \times 2$ factorial ANOVA is equivalent to a regression model applied to the contrast variables. Let's start by re-running the ANOVA, with results shown in @fig-fig13-20. --->
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-20" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-20.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">图&nbsp;14.20: jamovi ANOVA 結果，無交互組件</figcaption>
</figure>
</div>
</div>
</div>
<p>顯然，這裡沒有什麼驚喜。這正是我們之前執行的相同 ANOVA。接下來，讓我們使用 druganxifree、drugjoyzepam 和 CBTtherapy 作為預測因子進行迴歸。結果顯示在 <a href="#fig-fig13-21">图&nbsp;<span>14.21</span></a>。</p>
<!--- Obviously, there are no surprises here. That's the exact same ANOVA that we ran earlier. Next, let's run a regression using druganxifree, drugjoyzepam and CBTtherapy as the predictors. The results are shown in @fig-fig13-21. --->
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-21" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-21.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">图&nbsp;14.21: jamovi 迴歸結果，包含對比變量 druganxifree 和 drugjoyzepam</figcaption>
</figure>
</div>
</div>
</div>
<p>嗯。這不是我們上次得到的相同輸出。毫不奇怪，迴歸輸出將每個預測因子的結果分別打印出來，就像我們之前進行迴歸分析的每一次一樣。一方面，我們可以看到 CBTtherapy 變量的 p 值與我們原始 ANOVA 中治療因子的 p 值完全相同，因此我們可以放心，迴歸模型與 ANOVA 做的事情相同。另一方面，這個迴歸模型分別測試 druganxifree 對比和 drugjoyzepam 對比，好像它們是兩個完全無關的變量。當然，這並不奇怪，因為可憐的迴歸分析根本無法知道 drugjoyzepam 和 druganxifree 實際上是我們用來編碼三級藥物因子的兩個不同對比。就它所知，drugjoyzepam 和 druganxifree 與 drugjoyzepam 和 therapyCBT 之間的關係沒有任何區別。然而，您和我都知道得更好。在這個階段，我們根本不感興趣確定這兩個對比是否各自具有顯著性。我們只想知道是否存在藥物的“整體”效果。也就是說，我們希望 jamovi 執行某種“模型比較”檢驗，在此檢驗中，為了檢驗的目的，將兩個“與藥物相關”的對比合併在一起。聽起來熟悉嗎？我們所需要做的就是指定我們的零假設模型，該模型將包括 CBTtherapy 預測因子，並省略所有與藥物相關的變量，如 <a href="#fig-fig13-22">图&nbsp;<span>14.22</span></a> 所示。</p>
<!--- Hmm. This isn't the same output that we got last time. Not surprisingly, the regression output prints out the results for each of the three predictors separately, just like it did every other time we conducted a regression analysis. On the one hand we can see that the p-value for the CBTtherapy variable is exactly the same as the one for the therapy factor in our original ANOVA, so we can be reassured that the regression model is doing the same thing as the ANOVA did. On the other hand, this regression model is testing the druganxifree contrast and the drugjoyzepam contrast *separately*, as if they were two completely unrelated variables. It's not surprising of course, because the poor regression analysis has no way of knowing that drugjoyzepam and druganxifree are actually the two different contrasts that we used to encode our three-level drug factor. As far as it knows, drugjoyzepam and druganxifree are no more related to one another than drugjoyzepam and therapyCBT. However, you and I know better. At this stage we're not at all interested in determining whether these two contrasts are individually significant. We just want to know if there's an "overall" effect of drug. That is, what we want jamovi to do is to run some kind of "model comparison" test, one in which the two "drugrelated" contrasts are lumped together for the purpose of the test. Sound familiar? All we need to do is specify our null model, which in this case would include the CBTtherapy predictor, and omit both of the drug-related variables, as in @fig-fig13-22. --->
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-22" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-22.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">图&nbsp;14.22: jamovi 迴歸中的模型比較，零模型 1 與對比模型 2</figcaption>
</figure>
</div>
</div>
</div>
<p>啊，這樣好多了。我們的 F 統計量是 26.15，自由度是 2 和 14，p 值是 0.00002。這些數字與我們在原始變異數分析中得到的藥物主效應的數字相同。我們再次看到，變異數分析和迴歸本質上是相同的。它們都是線性模型，變異數分析的底層統計機制與迴歸中使用的機制相同。這一事實的重要性不應被低估。在本章的其餘部分，我們將重點依賴這個想法。</p>
<p>雖然我們在 jamovi 中計算了新變量 druganxifree 和 drugjoyzepam 進行對比，僅僅為了顯示變異數分析和迴歸本質上是相同的，在 jamovi 線性迴歸分析中實際上有一個巧妙的捷徑來獲得這些對比，見 <a href="#fig-fig13-23">图&nbsp;<span>14.23</span></a>。jamovi 在這裡做的是允許您將因子作為預測變量輸入，等待它…因子！聰明，對吧。您還可以通過 ‘Reference Levels’ 選項指定要用作參考級別的組。我們將其分別更改為 ‘placebo’ 和 ‘no.therapy’，因為這是最有意義的。</p>
<!--- Ah, that's better. Our F-statistic is 26.15, the degrees of freedom are 2 and 14, and the p-value is 0.00002. The numbers are identical to the ones we obtained for the main effect of drug in our original ANOVA. Once again we see that ANOVA and regression are essentially the same. They are both linear models, and the underlying statistical machinery for ANOVA is identical to the machinery used in regression. The importance of this fact should not be understated. Throughout the rest of this chapter we're going to rely heavily on this idea.

Although we went through all the faff of computing new variables in jamovi for the contrasts druganxifree and drugjoyzepam, just to show that ANOVA and regression are essentially the same, in the jamovi linear regression analysis there is actually a nifty shortcut to get these contrasts, see @fig-fig13-23. What jamovi is doing here is allowing you to enter the predictor variables that are factors as, wait for it...factors! Smart, eh. You can also specify which group to use as the reference level, via the 'Reference Levels' option. We've changed this to 'placebo' and 'no.therapy', respectively, because this makes most sense. --->
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-23" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-23.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">图&nbsp;14.23: jamovi 中帶有因子和對比的迴歸分析，包括整體變異數分析檢驗結果</figcaption>
</figure>
</div>
</div>
</div>
<p>如果您還在 ‘Model Coefficients’ - ‘Omnibus Test’ 選項下勾選 ‘ANOVA’ 檢驗復選框，我們會看到 F 統計量為 26.15，自由度為 2 和 14，p 值為 0.00002（<a href="#fig-fig13-23">图&nbsp;<span>14.23</span></a>）。這些數字與我們在原始變異數分析中得到的藥物主效應的數字相同。再次，我們看到變異數分析和迴歸本質上是相同的。它們都是線性模型，變異數分析的底層統計機制與迴歸中使用的機制相同。</p>
<!--- If you also click on the 'ANOVA' test checkbox under the 'Model Coefficients' - 'Omnibus Test' option, we see that the F-statistic is 26.15, the degrees of freedom are 2 and 14, and the p-value is 0.00002 (@fig-fig13-23). The numbers are identical to the ones we obtained for the main effect of drug in our original ANOVA. Once again, we see that ANOVA and regression are essentially the same. They are both linear models, and the underlying statistical machinery for ANOVA is identical to the machinery used in regression. --->
</section>
<section id="自由度就是計算有多少參數" class="level3" data-number="14.6.5">
<h3 data-number="14.6.5" class="anchored" data-anchor-id="自由度就是計算有多少參數"><span class="header-section-number">14.6.5</span> 自由度就是計算有多少參數</h3>
<p>經過漫長的等待，我終於可以給出一個我滿意的自由度定義。自由度是根據模型中需要估計的參數數量來定義的。對於迴歸模型或變異數分析，參數數量對應於迴歸係數的數量（即 b 值），包括截距。請記住，任何 F 檢驗都始終是兩個模型之間的比較，第一個 df 是參數數量的差。例如，在上面的模型比較中，零模型（mood.gain ~ therapyCBT）有兩個參數：therapyCBT 變量的一個迴歸係數和截距的第二個參數。替代模型（mood.gain ~ druganxifree + drugjoyzepam + therapyCBT）有四個參數：三個對比中的一個迴歸係數和截距的一個參數。因此，這兩個模型之間的差的自由度是 <span class="math inline">\(df_1 = 4 - 2 = 2\)</span>。</p>
<p>那麼，在似乎沒有零模型的情況下呢？例如，您可能正在考慮在「線性迴歸」-「模型擬合」選項下選擇「F 檢驗」時出現的 F 檢驗。我最初將其描述為對整個迴歸模型的檢驗。然而，這仍然是兩個模型之間的比較。零模型是僅包含 1 個迴歸係數的簡單模型，用於截距項。替代模型包含 <span class="math inline">\(K + 1\)</span> 個迴歸係數，每個 K 個預測變量一個，再加上截距。因此，您在此 F 檢驗中看到的 df 值等於 <span class="math inline">\(df_1 = K + 1 - 1 = K\)</span>。</p>
<p>那麼，在 F 檢驗中出現的第二個 df 值呢？這總是指與殘差相關的自由度。也可以用參數的方式來思考這個問題，但這有點反直覺。想象一下，假設整個研究的觀察值總數為 N。如果您想完美地描述這些 N 個值，您需要使用… N 個數字。當您建立迴歸模型時，您實際上在指定一些數字需要完美地描述數據。如果您的模型有 <span class="math inline">\(K\)</span> 個預測變量和一個截距，那麼您已經指定了 <span class="math inline">\(K + 1\)</span> 個數字。那麼，無需確定這將如何完成，您認為還需要多少數字才能將 K 个 1 參數迴歸模型轉換為原始數據的完美描述呢？如果您發現自己在想 <span class="math inline">\((K + 1) + (N - K - 1) = N\)</span>，因此答案必須是 <span class="math inline">\(N - K - 1\)</span>，那就做得很好！這正是對的。原則上，您可以想像一個包含每個數據點的參數的極其複雜的迴歸模型，它當然可以完美地描述數據。這個模型總共包含了 <span class="math inline">\(N\)</span> 個參數，但是我們感興趣的是描述這個完整模型（即 <span class="math inline">\(N\)</span>）所需的參數數量與您實際感興趣的更簡單的迴歸模型所使用的參數數量（即 <span class="math inline">\(K + 1\)</span>）之間的差別，因此 F 檢驗中的第二個自由度是 <span class="math inline">\(df_2 = N - K - 1\)</span>，其中 K 是預測變量的數量（在迴歸模型中）或對比的數量（在變異數分析中）。在我上面給出的示例中，數據集中有 <span class="math inline">\((N = 18\)</span> 觀察值，並且與變異數分析模型相關的 <span class="math inline">\(K + 1 = 4\)</span> 個迴歸係數，因此殘差的自由度是 <span class="math inline">\(df_2 = 18 - 4 = 14\)</span>。</p>
<!--- At long last, I can finally give a definition of degrees of freedom that I am happy with. Degrees of freedom are defined in terms of the number of parameters that have to be estimated in a model. For a regression model or an ANOVA, the number of parameters corresponds to the number of regression coefficients (i.e. b-values), including the intercept. Keeping in mind that any F-test is always a comparison between two models and the first df is the difference in the number of parameters. For example, in the model comparison above, the null model (mood.gain \~ therapyCBT) has two parameters: there's one regression coefficient for the therapyCBT variable, and a second one for the intercept. The alternative model (mood.gain \~ druganxifree + drugjoyzepam + therapyCBT) has four parameters: one regression coefficient for each of the three contrasts, and one more for the intercept. So the degrees of freedom associated with the difference between these two models is $df_1 = 4 - 2 = 2$.

What about the case when there doesn't seem to be a null model? For instance, you might be thinking of the F-test that shows up when you select 'F Test' under the 'Linear Regression' - 'Model Fit' options. I originally described that as a test of the regression model as a whole. However, that is still a comparison between two models. The null model is the trivial model that only includes 1 regression coefficient, for the intercept term. The alternative model contains $K + 1$ regression coefficients, one for each of the K predictor variables and one more for the intercept. So the df value that you see in this F test is equal to $df_1 = K + 1 - 1 = K$.

What about the second df value that appears in the F-test? This always refers to the degrees of freedom associated with the residuals. It is possible to think of this in terms of parameters too, but in a slightly counter-intuitive way. Think of it like this. Suppose that the total number of observations across the study as a whole is N. If you wanted to perfectly describe each of these N values, you need to do so using, well... N numbers. When you build a regression model, what you're really doing is specifying that some of the numbers need to perfectly describe the data. If your model has $K$ predictors and an intercept, then you've specified $K + 1$ numbers. So, without bothering to figure out exactly how this would be done, how many more numbers do you think are going to be needed to transform a K \`1 parameter regression model into a perfect re-description of the raw data? If you found yourself thinking that $(K + 1) + (N - K - 1) = N$, and so the answer would have to be $N - K - 1$, well done! That's exactly right. In principle you can imagine an absurdly complicated regression model that includes a parameter for every single data point, and it would of course provide a perfect description of the data. This model would contain $N$ parameters in total, but we're interested in the difference between the number of parameters required to describe this full model (i.e. $N$) and the number of parameters used by the simpler regression model that you're actually interested in (i.e., $K +1$), and so the second degrees of freedom in the F test is $df_2 = N - K - 1$, where K is the number of predictors (in a regression model) or the number of contrasts (in an ANOVA). In the example I gave above, there are $(N = 18$ observations in the data set and $K + 1 = 4$ regression coefficients associated with the ANOVA model, so the degrees of freedom for the residuals is $df_2 = 18 - 4 = 14$. --->
</section>
</section>
<section id="各種多重比較方案" class="level2" data-number="14.7">
<h2 data-number="14.7" class="anchored" data-anchor-id="各種多重比較方案"><span class="header-section-number">14.7</span> 各種多重比較方案</h2>
<p>在上一節中，我向您展示了一種將因子轉換為對比組合的方法。在我向您展示的方法中，我們指定了一組二進制變量，其中我們定義了一個類似於 <a href="#tbl-tab13-11">表格&nbsp;<span>14.11</span></a> 的表格。</p>

<!--- In the previous section, I showed you a method for converting a factor into a collection of contrasts. In the method I showed you we specify a set of binary variables in which we defined a table like @tbl-tab13-11. --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-11" class="anchored">
<table id="tab:tbl-tab13-11" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表格&nbsp;14.11: 二進制對比以區分所有三種可能的藥物</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;">drug</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">druganxifree</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">drugjoyzepam</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">"placebo"</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">"anxifree"</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">"joyzepam"</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">1</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>表格中的每一行對應於因子水平之一，每一列對應於對比之一。這個表格，始終比列多一行，有一個特殊的名稱。它被稱為對比矩陣。然而，有很多不同的方法可以指定對比矩陣。在本節中，我討論了統計學家使用的一些標準對比矩陣以及如何在 jamovi 中使用它們。如果您打算稍後閱讀[因子變異數分析 3：不平衡設計]一節，那麼仔細閱讀本節是值得的。如果沒有，您可以瀏覽一下它，因為對於平衡設計來說，對比的選擇並不重要。</p>

<!--- Each row in the table corresponds to one of the factor levels, and each column corresponds to one of the contrasts. This table, which always has one more row than columns, has a special name. It is called a contrast matrix. However, there are lots of different ways to specify a contrast matrix. In this section I discuss a few of the standard contrast matrices that statisticians use and how you can use them in jamovi. If you're planning to read the section on [Factorial ANOVA 3: unbalanced designs] later on, it's worth reading this section carefully. If not, you can get away with skimming it, because the choice of contrasts doesn't matter much for balanced designs. --->
<section id="比較操作效果" class="level3" data-number="14.7.1">
<h3 data-number="14.7.1" class="anchored" data-anchor-id="比較操作效果"><span class="header-section-number">14.7.1</span> 比較操作效果</h3>
<p>在我上面描述的這種對比中，因子的一個水平是特殊的，並作為一種 “基線” 類別（例如，在我們的示例中是安慰劑），其他兩個則是根據這個基線來定義的。這種對比的名稱是治療對比，也稱為 “哑变量编码”。在此對比中，因子的每個水平都與基本參考水平進行比較，基本參考水平是截距的值。</p>
<p>這個名字反映了這樣一個事實，當你的因子中的一個類別確實很特殊，因為它確實代表了基線時，這些對比是非常自然和合理的。這在我們的臨床試驗示例中是有道理的。安慰劑條件對應於不給人們使用任何真正的藥物的情況，因此它是特殊的。其他兩個條件是相對於安慰劑定義的。在一種情況下，您用 Anxifree 替換安慰劑，而在另一種情況下，您用 Joyzepam 替換安慰劑。</p>
<p>上面顯示的表格是具有3個水平的因子的治療對比矩陣。但是，如果我想要一個具有5個水平的因子的治療對比矩陣呢？您可以像 <a href="#tbl-tab13-12">表格&nbsp;<span>14.12</span></a> 那樣排列它。</p>

<!--- In the particular kind of contrasts that I've described above, one level of the factor is special, and acts as a kind of "baseline" category (i.e., placebo in our example), against which the other two are defined. The name for these kinds of contrasts is treatment contrasts, also known as "dummy coding". In this contrast each level of the factor is compared to a base reference level, and the base reference level is the value of the intercept.

The name reflects the fact that these contrasts are quite natural and sensible when one of the categories in your factor really is special because it actually does represent a baseline. That makes sense in our clinical trial example. The placebo condition corresponds to the situation where you don't give people any real drugs, and so it's special. The other two conditions are defined in relation to the placebo. In one case you replace the placebo with Anxifree, and in the other case your replace it with Joyzepam.

The table shown above is a matrix of treatment contrasts for a factor that has 3 levels. But suppose I want a matrix of treatment contrasts for a factor with 5 levels? You would set this out like @tbl-tab13-12. --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-12" class="anchored">
<table id="tab:tbl-tab13-12" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表格&nbsp;14.12: 具有5個水平的治療對比矩陣</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;">Level</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">2</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">3</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">4</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">5</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">1</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">2</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">3</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">4</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">5</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">1</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>在這個例子中，第一個對比是第2級與第1級比較，第二個對比是第3級與第1級比較，依此類推。請注意，默認情況下，因子的<em>第一</em>水平始終被視為基線類別（即，它是所有零的那個，並且沒有與之相關的顯式對比）。在 jamovi 中，您可以通過操作 “數據變量” 窗口中顯示的變量的水平來更改哪個類別是因子的第一個水平（雙擊電子表格列中的變量名稱以彈出 “數據變量” 視圖。</p>
<!--- In this example, the first contrast is level 2 compared with level 1, the second contrast is level 3 compared with level 1, and so on. Notice that, by default, the *first* level of the factor is always treated as the baseline category (i.e., it's the one that has all zeros and doesn't have an explicit contrast associated with it). In jamovi you can change which category is the first level of the factor by manipulating the order of the levels of the variable shown in the 'Data Variable' window (double click on the name of the variable in the spreadsheet column to bring up the 'Data Variable' view. --->
</section>
<section id="helmert-比較法" class="level3" data-number="14.7.2">
<h3 data-number="14.7.2" class="anchored" data-anchor-id="helmert-比較法"><span class="header-section-number">14.7.2</span> Helmert 比較法</h3>
<p>治療對比在很多情況下都很有用。然而，它們在真正存在基線類別的情況下最有意義，並且您希望根據該類別評估所有其他組。然而，在其他情況下，可能不存在這樣的基線類別，與其將每個組與其他組的平均值進行比較可能更有意義。這就是我們遇到 Helmert 對比的地方，由 jamovi ‘ANOVA’ - ‘Contrasts’ 選擇框中的 ‘helmert’ 選項生成。Helmert 對比背後的想法是將每個組與 “前一個” 組的平均值進行比較。也就是說，第一個對比表示第2組和第1組之間的差異，第二個對比表示第3組與第1組和第2組的平均值之間的差異，依此類推。對於具有五個水平的因子，這轉換為看起來像 <a href="#tbl-tab13-13">表格&nbsp;<span>14.13</span></a> 的對比矩陣。</p>
<!--- Treatment contrasts are useful for a lot of situations. However, they make most sense in the situation when there really is a baseline category, and you want to assess all the other groups in relation to that one. In other situations, however, no such baseline category exists, and it may make more sense to compare each group to the mean of the other groups. This is where we meet Helmert contrasts, generated by the 'helmert' option in the jamovi 'ANOVA' - 'Contrasts' selection box. The idea behind Helmert contrasts is to compare each group to the mean of the "previous" ones. That is, the first contrast represents the difference between group 2 and group 1, the second contrast represents the difference between group 3 and the mean of groups 1 and 2, and so on. This translates to a contrast matrix that looks like @tbl-tab13-13 for a factor with five levels. --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-13" class="anchored">
<table id="tab:tbl-tab13-13" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表格&nbsp;14.13: 具有5個水平的 helmert 對比矩陣</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;">1</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">-1</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">-1</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">-1</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">-1</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">2</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">-1</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">-1</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">-1</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">3</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">2</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">-1</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">-1</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">4</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">3</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">-1</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">5</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">4</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>Helmert 對比的一個有用之處是每個對比都加起來為零（即，所有列加起來為零）。這導致了當我們將 ANOVA 解釋為回歸時，如果我們使用 Helmert 對比，截距項對應於大平均數 <span class="math inline">\(\mu_{..}\)</span>。將其與治療對比進行比較，在治療對比中，截距項對應於基線類別的組平均值。這個性質在某些情況下可能非常有用。如果您有一個平衡設計，這並不太重要，到目前為止，我們一直在這樣假設，但是當我們考慮<a href="因子方差分析：不平衡設計">不平衡設計</a>時，它將變得重要。事實上，我甚至麻煩包括這一部分的主要原因是，如果您想了解不平衡 ANOVA，對比變得很重要。</p>
<!--- One useful thing about Helmert contrasts is that every contrast sums to zero (i.e., all the columns sum to zero). This has the consequence that, when we interpret the ANOVA as a regression, the intercept term corresponds to the grand mean $\mu_{..}$ if we are using Helmert contrasts. Compare this to treatment contrasts, in which the intercept term corresponds to the group mean for the baseline category. This property can be very useful in some situations. It doesn't matter very much if you have a balanced design, which we've been assuming so far, but it will turn out to be important later when we consider [unbalanced designs](Factorial ANOVA: unbalanced designs). In fact, the main reason why I've even bothered to include this section is that contrasts become important if you want to understand unbalanced ANOVA. --->
</section>
<section id="簡單比較" class="level3" data-number="14.7.3">
<h3 data-number="14.7.3" class="anchored" data-anchor-id="簡單比較"><span class="header-section-number">14.7.3</span> 簡單比較</h3>
<p>第三個選項是我應該簡要提及的 “總和至零” 對比，在 jamovi 中稱為 “簡單” 對比，它們用於構建組間的兩兩比較。具體來說，每個對比都編碼了某個組與基線類別之間的差異，這種情況下基線類別對應於第一組 (<a href="#tbl-tab13-14">表格&nbsp;<span>14.14</span></a>)。</p>
<!--- The third option that I should briefly mention are "sum to zero"總和至零 contrasts, called "Simple" contrasts in jamovi, which are used to construct pairwise comparisons between groups. Specifically, each contrast encodes the difference between one of the groups and a baseline category, which in this case corresponds to the first group (@tbl-tab13-14). --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-14" class="anchored">
<table id="tab:tbl-tab13-14" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表格&nbsp;14.14: 具有5個水平的 ‘總和至’ 零對比矩陣</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;">1</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">-1</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">-1</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">-1</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">-1</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">2</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">3</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">4</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">1</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">5</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">1</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>與 Helmert 對比非常相似，我們看到每一列的和都是零，這意味著當 ANOVA 被視為回歸模型時，截距項對應於整體平均值。在解釋這些對比時，需要認識到的是，每個對比都是第1組與其他四個組之間的兩兩比較。具體來說，對比1對應於 “第2組減去第1組” 的比較，對比2對應於 “第3組減去第1組” 的比較，依此類推。<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></p>
<!---Much like Helmert contrasts, we see that each column sums to zero, which means that the intercept term corresponds to the grand mean when ANOVA is treated as a regression model. When interpreting these contrasts, the thing to recognise is that each of these contrasts is a pairwise comparison between group 1 and one of the other four groups. Specifically, contrast 1 corresponds to a "group 2 minus group 1" comparison, contrast 2 corresponds to a "group 3 minus group 1" comparison, and so on.[^factorial-anova-8]

[^factorial-anova-8]: What's the difference between treatment and simple contrasts, I hear you ask? Well, as a basic example consider a gender main effect, with $m=0$ and $f=1$. The coefficient corresponding to the treatment contrast will measure the difference in mean between females and males, and the intercept would be the mean of the males. However, with a simple contrast, i.e., $m=-1$ and $f=1$, the intercept is the average of the means and the main effect is the difference of each group mean from the intercept.--->
</section>
<section id="jamovi的各種比較選項" class="level3" data-number="14.7.4">
<h3 data-number="14.7.4" class="anchored" data-anchor-id="jamovi的各種比較選項"><span class="header-section-number">14.7.4</span> jamovi的各種比較選項</h3>
<p>jamovi 還提供了多種可以在 ANOVA 中生成不同類型對比的選項。這些可以在主要的 ANOVA 分析窗口的 ‘對比’ 選項中找到，其中 <a href="#tbl-tab13-15">表格&nbsp;<span>14.15</span></a> 列出了對比類型：</p>
<!--- jamovi also comes with a variety of options that can generate different kinds of contrasts in ANOVA. These can be found in the 'Contrasts' option in the main ANOVA analysis window, where the contrast types in @tbl-tab13-15 are listed: --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-15" class="anchored">
<table id="tab:tbl-tab13-15" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表格&nbsp;14.15: 在 jamovi ANOVA 分析中可用的對比類型</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;">Contrast type</td>
<td data-quarto-table-cell-role="th" style="text-align: left; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;"></td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Deviation</td>
<td style="text-align: left; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">Compares the mean of each level (except a reference category) to the mean of all of the levels (grand mean)</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Simple</td>
<td style="text-align: left; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">Like the treatment contrasts, the simple contrast compares the mean of each level to the mean of a specified level. This type of contrast is useful when there is a control group. By default the first category is the reference. However, with a simple contrast the intercept is the grand mean of all the levels of the factors.</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Difference</td>
<td style="text-align: left; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">Compares the mean of each level (except the first) to the mean of previous levels. (Sometimes called reverse Helmert contrasts)</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Helmert</td>
<td style="text-align: left; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">Compares the mean of each level of the factor (except the last) to the mean of subsequent levels</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Repeated</td>
<td style="text-align: left; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">Compares the mean of each level (except the last) to the mean of the subsequent level</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Polynomial</td>
<td style="text-align: left; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">Compares the linear effect and quadratic effect. The first degree of freedom contains the linear effect across all categories; the second degree of freedom, the quadratic effect. These contrasts are often used to estimate polynomial trends</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</section>
</section>
<section id="sec-Post-hoc-tests" class="level2" data-number="14.8">
<h2 data-number="14.8" class="anchored" data-anchor-id="sec-Post-hoc-tests"><span class="header-section-number">14.8</span> 事後檢定</h2>
<p>現在轉換到另一個主題。而不是使用對比測試您已經計劃好的比較，假設您已經完成了 ANOVA，結果發現您獲得了一些顯著的效果。因為 F 檢驗是“全面”檢驗，它們實際上只測試各組之間沒有差異的虛無假設，所以獲得顯著效果並不能告訴你哪些組與其他組有所不同。我們在 <a href="13-Comparing-several-means-one-way-ANOVA.html"><span>章节&nbsp;13</span></a> 中討論了這個問題，並且在那章節中，我們的解決方案是對所有可能的組對執行 t 檢驗，對多重比較（例如，Bonferroni、Holm）進行校正，以控制所有比較中的 I 類型誤差率。我們在 <a href="13-Comparing-several-means-one-way-ANOVA.html"><span>章节&nbsp;13</span></a> 中使用的方法具有相對簡單的優點，並且可以在您在測試多個假設的多種不同情況下使用，但它們並非在 ANOVA 背景下進行有效的事後檢驗的最佳選擇。統計文獻中有很多用於執行多重比較的方法<span class="citation" data-cites="Hsu1996">(<a href="References.html#ref-Hsu1996" role="doc-biblioref">Hsu, 1996</a>)</span>，本書將超出範疇，無法詳細討論所有這些方法。</p>
<p>話雖如此，有一個工具我想引起您的注意，那就是 Tukey 的 “誠實顯著差異”，簡稱<strong>Tukey’s HSD</strong>。這次，我將不提供公式，只講解質性思路。Tukey’s HSD 的基本思想是檢查所有相關的組之間的成對比較，而且只有在您對成對差異感興趣時，使用 Tukey’s HSD 才合適。<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a> 例如，前面我們使用 <em>clinicaltrial.csv</em> 數據集進行了因子 ANOVA，並指定了藥物的主要作用和治療的主要作用，我們對以下四種比較感興趣：</p>
<ul>
<li>給予 Anxifree 的人與給予安慰劑的人的情緒提升之間的差異。</li>
<li>給予 Joyzepam 的人與給予安慰劑的人的情緒提升之間的差異。</li>
<li>給予 Anxifree 的人與給予 Joyzepam 的人的情緒提升之間的差異。</li>
<li>接受 CBT 治療的人與未接受治療的人的情緒提升之間的差異。</li>
</ul>
<p>對於這些比較中的任何一個，我們都對（群體）組平均值之間的真實差異感興趣。Tukey 的 HSD 會為這四種比較構建同時置信區間。我們所說的 95% “同時”置信區間是指，如果我們重複這個研究很多次，那麼在 95% 的研究結果中，置信區間將包含相關的真實值。此外，我們可以使用這些置信區間計算任何特定比較的校正 p 值。</p>
<p>在 jamovi 中使用 TukeyHSD 函數非常容易。您只需指定要為其執行事後檢驗的 ANOVA 模型項。例如，如果我們要為主效應進行事後檢驗，但不考慮交互作用，我們將在 ANOVA 分析屏幕中打開“事後檢驗”選項，將藥物和治療變量移到右側的框中，然後在可能的事後校正列表中選中“Tukey”複選框。這與相應的結果表在 <a href="#fig-fig13-24">图&nbsp;<span>14.24</span></a> 中顯示。</p>

<!--- Time to switch to a different topic. Rather than pre-planned comparisons that you have tested using contrasts, let's suppose you've done your ANOVA and it turns out that you obtained some significant effects. Because of the fact that the F-tests are "omnibus" tests that only really test the null hypothesis that there are no differences among groups, obtaining a significant effect doesn't tell you which groups are different to which other ones. We discussed this issue back in @sec-Comparing-several-means-one-way-ANOVA, and in that chapter our solution was to run t-tests for all possible pairs of groups, making corrections for multiple comparisons (e.g., Bonferroni, Holm) to control the Type I error rate across all comparisons. The methods that we used back in @sec-Comparing-several-means-one-way-ANOVA have the advantage of being relatively simple and being the kind of tools that you can use in a lot of different situations where you're testing multiple hypotheses, but they're not necessarily the best choices if you're interested in doing efficient post hoc testing in an ANOVA context. There are actually quite a lot of different methods for performing multiple comparisons in the statistics literature [@Hsu1996], and it would be beyond the scope of an introductory text like this one to discuss all of them in any detail.

That being said, there's one tool that I do want to draw your attention to, namely Tukey's "Honestly Significant Difference", or **Tukey's HSD** for short. For once, I'll spare you the formulas and just stick to the qualitative ideas. The basic idea in Tukey's HSD is to examine all relevant pairwise comparisons between groups, and it's only really appropriate to use Tukey's HSD if it is pairwise differences that you're interested in.[^factorial-anova-9] For instance, earlier we conducted a factorial ANOVA using the *clinicaltrial.csv*  data set, and where we specified a main effect for drug and a main effect of therapy we would be interested in the following four comparisons:

[^factorial-anova-9]: If, for instance, you actually find yourself interested to know if Group A is significantly different from the mean of Group B and Group C, then you need to use a different tool (e.g., Scheffe's method, which is more conservative, and beyond the scope of this book). However, in most cases you probably are interested in pairwise group differences, so Tukey's HSD is a pretty useful thing to know about.

- The difference in mood gain for people given Anxifree versus people given the placebo.
- The difference in mood gain for people given Joyzepam versus people given the placebo.
- The difference in mood gain for people given Anxifree versus people given Joyzepam.
- The difference in mood gain for people treated with CBT and people given no therapy.

For any one of these comparisons, we're interested in the true difference between (population) group means. Tukey's HSD constructs simultaneous confidence intervals for all four of these comparisons. What we mean by 95% "simultaneous" confidence interval is that, if we were to repeat this study many times, then in 95% of the study results the confidence intervals would contain the relevant true value. Moreover, we can use these confidence intervals to calculate an adjusted p value for any specific comparison.

The TukeyHSD function in jamovi is pretty easy to use. You simply specify the ANOVA model term that you want to run the post hoc tests for. For example, if we were looking to run post hoc tests for the main effects but not the interaction, we would open up the 'Post Hoc Tests' option in the ANOVA analysis screen, move the drug and therapy variables across to the box on the right, and then select the 'Tukey' checkbox in the list of possible post hoc corrections that could be applied. This, along with the corresponding results table, is shown in @fig-fig13-24. --->
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-24" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-24.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">图&nbsp;14.24: 不帶交互作用的 jamovi 因子 ANOVA 中的 Tukey HSD 事後檢驗</figcaption>
</figure>
</div>
</div>
</div>
<p>在「事後檢驗」結果表中顯示的輸出非常直觀。例如，第一個比較是Anxifree與安慰劑之間的差異，輸出的第一部分顯示組均值之間的觀察差異為0.27。接下來的數字是差異的標準誤，如果我們想要，我們可以根據此計算出95%置信區間，儘管jamovi目前尚不提供此選項。然後有一列是自由度，一列是t值，最後一列是p值。對於第一個比較，調整後的p值為0.21。相比之下，如果您看下一行，我們會發現安慰劑和Joyzepam之間的觀察差異為1.03，並且這個結果顯著（p &lt; .001）。</p>
<p>到目前為止，一切都很好。那麼，如果您的模型包括交互作用項怎麼辦？例如，jamovi中的默認選項是允許藥物和療法之間存在交互作用。如果是這樣，我們需要考慮的兩兩比較數量開始增加。像以前一樣，我們需要考慮與藥物主效應相關的三個比較以及與療法主效應相關的一個比較。但是，如果我們要考慮顯著交互作用的可能性（並嘗試找到支持這一顯著交互作用的組差異），我們需要包括以下比較：</p>
<ul>
<li>使用Anxifree並接受CBT治療的人的情緒增益與使用安慰劑並接受CBT治療的人的情緒增益之間的差異</li>
<li>使用Anxifree並不接受治療的人與使用安慰劑並不接受治療的人的情緒增益之間的差異。</li>
<li>等等</li>
</ul>
<p>您需要考慮相當多的這些比較。因此，當我們對此ANOVA模型運行Tukey事後分析時，我們會發現它進行了很多兩兩比較（共19個），如@fig-fig13-25所示。您會發現它看起來與之前非常相似，但進行了更多的比較。</p>

<!--- The output shown in the 'Post Hoc Tests' results table is (I hope) pretty straightforward. The first comparison, for example, is the Anxifree versus placebo difference, and the first part of the output indicates that the observed difference in group means is .27. The next number is the standard error for the difference, from which we could calculate the 95% confidence interval if we wanted, though jamovi does not currently provide this option. Then there is a column with the degrees of freedom, a column with the t-value, and finally a column with the p-value. For the first comparison the adjusted p-value is .21. In contrast, if you look at the next line, we see that the observed difference between joyzepam and the placebo is 1.03, and this result is significant (p < .001).

So far, so good. What about the situation where your model includes interaction terms? For instance, the default option in jamovi is to allow for the possibility that there is an interaction between drug and therapy. If that's the case, the number of pairwise comparisons that we need to consider starts to increase. As before, we need to consider the three comparisons that are relevant to the main effect of drug and the one comparison that is relevant to the main effect of therapy. But, if we want to consider the possibility of a significant interaction (and try to find the group differences that underpin that significant interaction), we need to include comparisons such as the following:

-   The difference in mood gain for people given Anxifree and treated with CBT, versus people given the placebo and treated with CBT
-   The difference in mood gain for people given Anxifree and given no therapy, versus people given the placebo and given no therapy.
-   etc

There are quite a lot of these comparisons that you need to consider. So, when we run the Tukey post hoc analysis for this ANOVA model, we see that it has made a lot of pairwise comparisons (19 in total), as shown in @fig-fig13-25. You can see that it looks pretty similar to before, but with a lot more comparisons made. --->
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-25" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-25.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">图&nbsp;14.25: jamovi因子ANOVA中的Tukey HSD事後檢驗，包含交互作用項</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-The-method-of-planned-comparisons" class="level2" data-number="14.9">
<h2 data-number="14.9" class="anchored" data-anchor-id="sec-The-method-of-planned-comparisons"><span class="header-section-number">14.9</span> 事前檢定方法</h2>
<p>延續前面關於ANOVA中對比和事後檢驗的部分，我認為預先設定的比較方法（planned comparisons）非常重要，值得簡要討論。在前面的章節以及@sec-Comparing-several-means-one-way-ANOVA中對多重比較的討論中，我們假設你想運行的檢驗確實是事後檢驗。例如，在上面的藥物示例中，可能你認為這些藥物對情緒的影響各有不同（即你假設藥物有主效應），但你沒有關於它們如何不同的具體假設，也沒有任何真正的想法關於哪些兩兩比較值得觀察。如果是這樣，那麼你確實需要使用Tukey的HSD來進行兩兩比較。</p>
<p>然而，情況會有所不同，如果你真的有關於哪些比較感興趣的確切、具體的假設，而且你絕對無意觀察除了提前指定的那些比較以外的任何其他比較。當這是真的，並且如果你真誠並嚴格地堅持不進行任何其他比較的高尚意圖（即使數據看起來似乎對你沒有假設的東西顯示出非常顯著的效應），那麼使用像Tukey的HSD這樣的方法並不合理，因為它對一整套你從未關心過，也從未打算觀察的比較進行了矯正。在這種情況下，你可以安全地運行有限數量的假設檢驗，而無需對多重檢驗進行調整。這種情況被稱為預先設定的比較方法，有時用於臨床試驗。然而，進一步的考慮超出了這本入門書的範疇，但至少你知道這種方法是存在的！</p>
<!--- Following on from the previous sections on contrasts and post hoc tests in ANOVA, I think the method of planned comparisons is important enough to deserve a quick discussion. In our discussions of multiple comparisons, in the previous section and back in @sec-Comparing-several-means-one-way-ANOVA, I've been assuming that the tests you want to run are genuinely post hoc. For instance, in our drugs example above, maybe you thought that the drugs would all have different effects on mood (i.e., you hypothesised a main effect of drug), but you didn't have any specific hypothesis about how they would be different, nor did you have any real idea about which pairwise comparisons would be worth looking at. If that is the case, then you really have to resort to something like Tukey's HSD to do your pairwise comparisons.

The situation is rather different, however, if you genuinely did have real, specific hypotheses about which comparisons are of interest, and you never ever have any intention to look at any other comparisons besides the ones that you specified ahead of time. When this is true, and if you honestly and rigorously stick to your noble intentions to not run any other comparisons (even when the data look like they're showing you deliciously significant effects for stuff you didn't have a hypothesis test for), then it doesn't really make a lot of sense to run something like Tukey's HSD, because it makes corrections for a whole bunch of comparisons that you never cared about and never had any intention of looking at. Under those circumstances, you can safely run a (limited) number of hypothesis tests without making an adjustment for multiple testing. This situation is known as the method of planned comparisons, and it is sometimes used in clinical trials. However, further consideration is out of scope for this introductory book, but at least you know that this method exists! --->
</section>
<section id="不平衡的因子設計分析" class="level2" data-number="14.10">
<h2 data-number="14.10" class="anchored" data-anchor-id="不平衡的因子設計分析"><span class="header-section-number">14.10</span> 不平衡的因子設計分析</h2>
<p>因子ANOVA是一個非常方便的工具。它已經成為分析實驗數據的標準工具之一，已有數十年的歷史，你會發現在心理學上，你無法閱讀超過兩三篇論文而不在其中某個地方遇到ANOVA。然而，在很多真實的科學文章中，你將會看到的ANOVA和我迄今為止描述的ANOVA之間有一個巨大的差異。在現實生活中，我們很少有幸擁有完美平衡的設計。出於某種原因，通常會在某些單元中得到比其他單元更多的觀察結果。換句話說，我們有一個不平衡的設計。</p>
<p>不平衡設計需要比平衡設計更加謹慎地處理，支撐它們的統計理論也更為混亂。這種混亂可能是結果，也可能是時間短缺，但我的經驗是心理學本科研究方法課程有一個令人討厭的傾向，那就是完全忽略這個問題。很多統計教科書也容易忽略它。我認為，這導致了很多領域內的在職研究人員實際上並不知道存在幾種不同類型的不平衡ANOVA，而它們產生的答案相差很大。事實上，閱讀心理學文獻時，我對大多數報告不平衡因子ANOVA結果的人實際上無法提供足夠的詳細信息來重現分析感到驚訝。我暗自懷疑，大多數人甚至沒有意識到他們的統計軟件包正在代替他們做出大量實質性的數據分析決策。當你想到這一點時，它實際上是有點恐怖的。因此，如果你想避免將數據分析的控制權交給愚蠢的軟件，請繼續閱讀。</p>
<!-- Factorial ANOVA is a very handy thing to know about. It's been one of the standard tools used to analyse experimental data for many decades, and you'll find that you can't read more than two or three papers in psychology without running into an ANOVA in there somewhere. However, there's one huge difference between the ANOVAs that you'll see in a lot of real scientific articles and the ANOVAs that I've described so far. In in real life we're rarely lucky enough to have perfectly balanced designs. For one reason or another, it's typical to end up with more observations in some cells than in others. Or, to put it another way, we have an unbalanced design.

Unbalanced designs need to be treated with a lot more care than balanced designs, and the statistical theory that underpins them is a lot messier. It might be a consequence of this messiness, or it might be a shortage of time, but my experience has been that undergraduate research methods classes in psychology have a nasty tendency to ignore this issue completely. A lot of stats textbooks tend to gloss over it too. The net result of this, I think, is that a lot of active researchers in the field don't actually know that there's several different "types" of unbalanced ANOVAs, and they produce quite different answers. In fact, reading the psychological literature, I'm kind of amazed at the fact that most people who report the results of an unbalanced factorial ANOVA don't actually give you enough details to reproduce the analysis. I secretly suspect that most people don't even realise that their statistical software package is making a whole lot of substantive data analysis decisions on their behalf. It's actually a little terrifying when you think about it. So, if you want to avoid handing control of your data analysis to stupid software, read on. --->
<section id="咖啡飲用資料" class="level3" data-number="14.10.1">
<h3 data-number="14.10.1" class="anchored" data-anchor-id="咖啡飲用資料"><span class="header-section-number">14.10.1</span> 咖啡飲用資料</h3>
<p>跟往常一樣，使用一些數據將對我們有所幫助。<em>coffee.csv</em> 文件包含了一個產生不平衡 <span class="math inline">\(3 \times 2\)</span> ANOVA 的假設數據集。假設我們有興趣了解人們在喝太多咖啡時胡言亂語的趨勢是否純粹是咖啡本身的影響，還是人們在咖啡中加入牛奶和糖所產生的影響。假設我們找了18個人，給他們喝了一些咖啡。咖啡/咖啡因的含量保持恆定，我們改變是否加入牛奶，所以牛奶是一個有兩個水平的二元因子，分別是“是”和“否”。我們還改變了涉及的糖的種類。咖啡中可能含有“真正”的糖，或者可能含有“假”的糖（即人工甜味劑），或者可能根本不含糖，所以糖變量是一個有三個水平的因子。我們的結果變量是一個連續變量，這可能意味著某個心理上有意義的衡量某人“胡言亂語”程度的指標。對於我們的目的，細節並不真正重要。查看 jamovi 試算表視圖中的數據，如 <a href="#fig-fig13-26">图&nbsp;<span>14.26</span></a>。</p>
<!--- As usual, it will help us to work with some data. The *coffee.csv* file contains a hypothetical data set that produces an unbalanced $3 \times 2$ ANOVA. Suppose we were interested in finding out whether or not the tendency of people to babble when they have too much coffee is purely an effect of the coffee itself, or whether there's some effect of the milk and sugar that people add to the coffee. Suppose we took 18 people and gave them some coffee to drink. The amount of coffee / caffeine was held constant, and we varied whether or not milk was added, so milk is a binary factor with two levels, "yes" and "no". We also varied the kind of sugar involved. The coffee might contain "real" sugar or it might contain "fake" sugar (i.e., artificial sweetener) or it might contain "none" at all, so the sugar variable is a three level factor. Our outcome variable is a continuous variable that presumably refers to some psychologically sensible measure of the extent to which someone is "babbling". The details don't really matter for our purpose. Take a look at the data in the jamovi spreadsheet view, as in @fig-fig13-26. --->
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-26" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-26.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">图&nbsp;14.26: coffee.csv數據集在 jamovi 中，描述性信息按因子水平匯總</figcaption>
</figure>
</div>
</div>
</div>
<p>查看 <a href="#fig-fig13-26">图&nbsp;<span>14.26</span></a> 中的平均值表，我們可以強烈感受到各組之間的差異。與 babble 變量的標準偏差相比，這一點尤其明顯。在各組中，這個標準偏差從 .14 到 .71 不等，這相對於組間平均值的差異來說相當小。<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a> 雖然這一開始看起來像是一個簡單的因子ANOVA，但當我們查看每個組中有多少個觀察值時，問題就出現了。參見 <a href="#fig-fig13-26">图&nbsp;<span>14.26</span></a> 中顯示的不同組別的不同 N 值。這違反了我們最初的假設，即每個組中的人數是相同的。我們還沒有真正討論如何處理這種情況。</p>

<!--- Looking at the table of means in @fig-fig13-26 we get a strong impression that there are differences between the groups. This is especially true when we compare these means to the standard deviations for the babble variable. Across groups, this standard deviation varies from .14 to .71, which is fairly small relative to the differences in group means.[^14-factorial-anova-8] Whilst this at first may seem like a straightforward factorial ANOVA, a problem arises when we look at how many observations we have in each group. See the different Ns for different groups shown in @fig-fig13-26. This violates one of our original assumptions, namely that the number of people in each group is the same. We haven't really discussed how to handle this situation.

[^14-factorial-anova-8]: This discrepancy in standard deviations might (and should) make you wonder if we have a violation of the homogeneity of variance assumption. I'll leave it as an exercise for the reader to double check this using the Levene test option. --->
</section>
<section id="不平衡設計不適用標準變異數分析" class="level3" data-number="14.10.2">
<h3 data-number="14.10.2" class="anchored" data-anchor-id="不平衡設計不適用標準變異數分析"><span class="header-section-number">14.10.2</span> 不平衡設計不適用「標準變異數分析」</h3>
<p>不平衡設計讓我們發現，實際上並不存在我們可能稱之為標準 ANOVA 的任何一種事物。事實上，你可能希望在不平衡設計中以三種根本不同的方式 <a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a>來運行 ANOVA。如果您有一個平衡設計，這三個版本都會產生相同的結果，與我在本章開始時給出的公式一致的平方和、F 值等。然而，當您的設計不平衡時，它們的答案並不相同。此外，它們對於每種情況的適用程度也不盡相同。有些方法對您的情況可能更適用。鑒於此，了解不同類型的 ANOVA 及其相互之間的差異非常重要。</p>
<p>第一種 ANOVA 通常被稱為<strong>第一類平方和</strong>。我敢肯定你能猜到其他兩個叫什麼。名稱中的“平方和”部分是由 SAS 統計軟件包引入的，並已成為標準術語，但在某些方面有點誤導。我認為把它們稱為不同類型的平方和的邏輯是，當你看到它們產生的 ANOVA 表時，數字之間的關鍵區別是 SS 值。自由度沒有變化，MS 值仍然被定義為 SS 除以 df 等。然而，這種術語的錯誤之處在於它掩蓋了 SS 值之間為何會有差異的原因。為此，了解三種不同類型的 ANOVA 作為三種不同的假設檢驗策略要有幫助得多。這些不同的策略確實導致了不同的 SS 值，但這裡重要的是策略，而不是 SS 值本身。回想一下[ANOVA 作為線性模型]一節，任何特定的 F 檢驗最好被認為是兩個線性模型之間的比較。因此，當您查看 ANOVA 表時，請記住每個 F 檢驗對應於要比較的模型對。當然，這自然引出了要比較哪對模型的問題。這就是 ANOVA 類型 I、II 和 III 之間的根本區別：每一種都對應於為檢驗選擇模型對的不同方式。</p>

<!--- Unbalanced designs lead us to the somewhat unsettling discovery that there isn't really any one thing that we might refer to as a standard ANOVA. In fact, it turns out that there are three fundamentally different ways[^14-factorial-anova-9] in which you might want to run an ANOVA in an unbalanced design. If you have a balanced design all three versions produce identical results, with the sums of squares, F-values, etc., all conforming to the formulas that I gave at the start of the chapter. However, when your design is unbalanced they don't give the same answers. Furthermore, they are not all equally appropriate to every situation. Some methods will be more appropriate to your situation than others. Given all this, it's important to understand what the different types of ANOVA are and how they differ from one another.

[^14-factorial-anova-9]: Actually, this is a bit of a lie. ANOVAs can vary in other ways besides the ones I've discussed in this book. For instance, I've completely ignored the difference between fixed-effect models in which the levels of a factor are "fixed" by the experimenter or the world, and random-effect models in which the levels are random samples from a larger population of possible levels (this book only covers fixed-effect models). Don't make the mistake of thinking that this book, or any other one, will tell you "everything you need to know" about statistics, any more than a single book could possibly tell you everything you need to know about psychology, physics or philosophy. Life is too complicated for that to ever be true. This isn't a cause for despair, though. Most researchers get by with a basic working knowledge of ANOVA that doesn't go any further than this book does. I just want you to keep in mind that this book is only the beginning of a very long story, not the whole story.

The first kind of ANOVA is conventionally referred to as **Type I sum of squares**. I'm sure you can guess what the other two are called. The "sum of squares" part of the name was introduced by the SAS statistical software package and has become standard nomenclature, but it's a bit misleading in some ways. I think the logic for referring to them as different types of sum of squares is that, when you look at the ANOVA tables that they produce, the key difference in the numbers is the SS values. The degrees of freedom don't change, the MS values are still defined as SS divided by df, etc. However, what the terminology gets wrong is that it hides the reason *why* the SS values are different from one another. To that end, it's a lot more helpful to think of the three different kinds of ANOVA as three different *hypothesis testing strategies*. These different strategies lead to different SS values, to be sure, but it's the strategy that is the important thing here, not the SS values themselves. Recall from the section [ANOVA as a linear model] that any particular F-test is best thought of as a comparison between two linear models. So, when you're looking at an ANOVA table, it helps to remember that each of those F-tests corresponds to a pair of models that are being compared. Of course, this leads naturally to the question of which pair of models is being compared. This is the fundamental difference between ANOVA Types I, II and III: each one corresponds to a different way of choosing the model pairs for the tests. --->
</section>
<section id="第一型平方差總和" class="level3" data-number="14.10.3">
<h3 data-number="14.10.3" class="anchored" data-anchor-id="第一型平方差總和"><span class="header-section-number">14.10.3</span> 第一型平方差總和</h3>
<p>類型 I 方法有時被稱為”序列”平方和，因為它涉及一次添加一個術語到模型的過程。以 <em>coffee</em> 數據為例。假設我們要運行完整的 <span class="math inline">\(3 \times 2\)</span> 因子 ANOVA，包括交互作用術語。完整的模型包含了結果變量 babble，預測變量 sugar 和 milk，以及交互術語 sugar <span class="math inline">\(\times\)</span> milk。這可以寫成 <span class="math inline">\(babble \sim sugar + milk + sugar {\times} milk\)</span>。類型 I 策略會按順序構建這個模型，從最簡單的模型開始，逐步添加術語。</p>
<p>數據的最簡單模型將是一個假設牛奶和糖都不影響胡言亂語的模型。這樣的模型只包括截距，寫成 babble ~ 1。這是我們最初的零假設。數據的下一個最簡單模型將是其中只包含兩個主效應之一的模型。在 <em>coffee</em> 數據中，這裡有兩個不同的可能選擇，因為我們可以選擇先添加 milk 或者先添加 sugar。實際上，順序是很重要的，我們稍後會看到，但現在讓我們只是隨意選擇一個，選擇 sugar。所以，我們模型序列中的第二個模型是 babble ~ sugar，它形成了我們第一次檢驗的替代假設。我們現在有了我們的第一個假設檢驗（<a href="#tbl-tab13-16">表格&nbsp;<span>14.16</span></a>）。</p>
<!--- The Type I method is sometimes referred to as the "sequential" sum of squares, because it involves a process of adding terms to the model one at a time. Consider the *coffee* data, for instance. Suppose we want to run the full $3 \times 2$ factorial ANOVA, including interaction terms. The full model contains the outcome variable babble, the predictor variables sugar and milk, and the interaction term sugar $\times$ milk. This can be written as $babble \sim sugar + milk + sugar {\times} milk$. The Type I strategy builds this model up sequentially, starting from the simplest possible model and gradually adding terms.

The simplest possible model for the data would be one in which neither milk nor sugar is assumed to have any effect on babbling. The only term that would be included in such a model is the intercept, written as babble ~ 1. This is our initial null hypothesis. The next simplest model for the data would be one in which only one of the two main effects is included. In the *coffee* data, there are two different possible choices here, because we could choose to add milk first or to add sugar first. The order actually turns out to matter, as we'll see later, but for now let's just make a choice arbitrarily and pick sugar. So, the second model in our sequence of models is babble ~ sugar, and it forms the alternative hypothesis for our first test. We now have our first hypothesis test (@tbl-tab13-16). --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-16" class="anchored">
<table id="tab:tbl-tab13-16" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表格&nbsp;14.16: 使用結果變量 ‘babble’ 的零假設和替代假設。</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;">Null model:</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">\(babble \sim 1\)</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Alternative model:</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(babble \sim sugar\)</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>這個比較形成了我們對糖的主效應的假設檢驗。我們模型建立練習的下一步是添加另一個主效應術語，因此我們序列中的下一個模型是 babble ~ sugar + milk。然後，通過比較以下模型對（<a href="#tbl-tab13-17">表格&nbsp;<span>14.17</span></a>）形成第二個假設檢驗。</p>
<!--- This comparison forms our hypothesis test of the main effect of sugar. The next step in our model building exercise is to add the other main effect term, so the next model in our sequence is babble \~ sugar + milk. The second hypothesis test is then formed by comparing the following pair of models (@tbl-tab13-17). --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-17" class="anchored">
<table id="tab:tbl-tab13-17" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表格&nbsp;14.17: 使用結果變量 ‘babble’ 的進一步零假設和替代假設</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;">Null model:</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">\(babble \sim sugar\)</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Alternative model:</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(babble \sim sugar + milk\)</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>這個比較形成了我們對牛奶主效應的假設檢驗。在某種意義上，這種方法非常優雅：第一次測試的替代假設形成了第二次測試的零假設。正是在這個意義上，類型 I 方法是嚴格有序的。每個測試都直接基於上一個測試的結果。然而，在另一個意義上，它非常不優雅，因為這兩個測試之間有很強的不對稱性。糖的主效應測試（第一次測試）完全忽略了牛奶，而牛奶的主效應測試（第二次測試）確實考慮了糖。無論如何，我們序列中的第四個模型現在是完整的模型，babble ~ sugar + milk + sugar <span class="math inline">\(\times\)</span> milk，相應的假設檢驗顯示在 <a href="#tbl-tab13-18">表格&nbsp;<span>14.18</span></a> 中。</p>
<!--- This comparison forms our hypothesis test of the main effect of milk. In one sense, this approach is very elegant: the alternative hypothesis from the first test forms the null hypothesis for the second one. It is in this sense that the Type I method is strictly sequential. Every test builds directly on the results of the last one. However, in another sense it's very inelegant, because there's a strong asymmetry between the two tests. The test of the main effect of sugar (the first test) completely ignores milk, whereas the test of the main effect of milk (the second test) does take sugar into account. In any case, the fourth model in our sequence is now the full model, babble \~ sugar + milk + sugar $\times$ milk, and the corresponding hypothesis test is shown in @tbl-tab13-18. --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-18" class="anchored">
<table id="tab:tbl-tab13-18" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表格&nbsp;14.18: 使用結果變量 ‘babble’ 的更多可能的零假設和替代假設</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;">Null model:</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">\(babble \sim sugar + milk\)</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Alternative model:</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(babble \sim sugar + milk + sugar * milk \)</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>類型 III 平方和是 jamovi ANOVA 使用的默認假設檢驗方法，因此要運行類型 I 平方和分析，我們必須在 jamovi ‘ANOVA’ - ‘Model’ 選項中的 ‘平方和’ 選擇框中選擇 ‘Type 1’。這給我們提供了 <a href="#fig-fig13-27">图&nbsp;<span>14.27</span></a> 中顯示的 ANOVA 表。</p>

<!--- Type III sum of squares is the default hypothesis testing method used by jamovi ANOVA, so to run a Type I sum of squares analysis we have to select 'Type 1' in the 'Sum of squares' selection box in the jamovi 'ANOVA' - 'Model' options. This gives us the ANOVA table shown in @fig-fig13-27. --->
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-27" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-27.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">图&nbsp;14.27: 使用 jamovi 中類型 I 平方和的 ANOVA 結果表</figcaption>
</figure>
</div>
</div>
</div>
<p>使用類型 I 平方和的最大問題是它確實取決於您輸入變量的順序。然而，在許多情況下，研究人員無需優先考慮一種排序而不考慮另一種排序。這可能是我們牛奶和糖問題的情況。我們應該先添加牛奶還是糖？在數據分析問題中，這與製作咖啡問題一樣隨意。事實上，可能有一些人對排序有堅定的看法，但很難想像這個問題有一個原則性的答案。然而，當我們改變順序時，看看會發生什麼，如 <a href="#fig-fig13-28">图&nbsp;<span>14.28</span></a> 中所示。</p>
<!--- The big problem with using Type I sum of squares is the fact that it really does depend on the order in which you enter the variables. Yet, in many situations the researcher has no reason to prefer one ordering over another. This is presumably the case for our milk and sugar problem. Should we add milk first or sugar first? It feels exactly as arbitrary as a data analysis question as it does as a coffee-making question. There may in fact be some people with firm opinions about ordering, but it's hard to imagine a principled answer to the question. Yet, look what happens when we change the ordering, as in @fig-fig13-28. --->
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-28" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-28.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">图&nbsp;14.28: 使用 jamovi 中類型 I 平方和的 ANOVA 結果表，但因子以不同的順序（首先是牛奶）輸入</figcaption>
</figure>
</div>
</div>
</div>
<p>兩個主效應術語的 p 值都發生了變化，而且變化相當大。在其他方面，牛奶的效果已經顯著（儘管我之前提到過，人們應該避免對此得出任何強烈的結論）。應該報告這兩個 ANOVA 中的哪一個？這並不是立即明顯的。</p>
<p>當您查看用於定義“第一”主效應和“第二”主效應的假設檢驗時，很明顯它們之間有質的不同。在我們最初的示例中，我們看到了糖的主效應檢驗完全忽略了牛奶，而牛奶的主效應檢驗確實考慮了糖。因此，類型 I 檢驗策略確實將第一個主效應視為在第二個主效應之上具有某種理論優越性。根據我的經驗，很少（甚至從未）有這種理論優越性，可以證明將任何兩個主效應非對稱地對待。</p>
<p>所有這些的結果是類型 I 測試很少有趣，所以我們應該繼續討論類型 II 測試和類型 III 測試。</p>
<!--- The p-values for both main effect terms have changed, and fairly dramatically. Among other things, the effect of milk has become significant (though one should avoid drawing any strong conclusions about this, as I've mentioned previously). Which of these two ANOVAs should one report? It's not immediately obvious.

When you look at the hypothesis tests that are used to define the "first" main effect and the "second" one, it's clear that they're qualitatively different from one another. In our initial example, we saw that the test for the main effect of sugar completely ignores milk, whereas the test of the main effect of milk does take sugar into account. As such, the Type I testing strategy really does treat the first main effect as if it had a kind of theoretical primacy over the second one. In my experience there is very rarely if ever any theoretically primacy of this kind that would justify treating any two main effects asymmetrically.

The consequence of all this is that Type I tests are very rarely of much interest, and so we should move on to discuss Type II tests and Type III tests. --->
</section>
<section id="第三型平方差總和" class="level3" data-number="14.10.4">
<h3 data-number="14.10.4" class="anchored" data-anchor-id="第三型平方差總和"><span class="header-section-number">14.10.4</span> 第三型平方差總和</h3>
<p>剛剛談完類型 I 測試後，您可能會認為接下來自然要談論類型 II 測試。然而，我認為在談論類型 II 測試（比較棘手）之前，先討論類型 III 測試（簡單且是 jamovi ANOVA 的默認設置）實際上更自然。類型 III 測試背後的基本思想非常簡單。無論您要評估哪個術語，都要運行 F 檢驗，其中替代假設對應用戶指定的完整 ANOVA 模型，而零模型僅刪除您正在測試的那一個術語。例如，在咖啡示例中，我們的完整模型是 babble ~ sugar + milk + sugar × milk，糖的主效應檢驗將對應於以下兩個模型之間的比較（<a href="#tbl-tab13-19">表格&nbsp;<span>14.19</span></a>）。</p>
<!--- Having just finished talking about Type I tests, you might think that the natural thing to do next would be to talk about Type II tests. However, I think it's actually a bit more natural to discuss Type III tests (which are simple and the default in jamovi ANOVA) before talking about Type II tests (which are trickier). The basic idea behind Type III tests is extremely simple. Regardless of which term you're trying to evaluate, run the F-test in which the alternative hypothesis corresponds to the full ANOVA model as specified by the user, and the null model just deletes that one term that you're testing. For instance, in the coffee example, in which our full model was babble \~ sugar + milk + sugar $\times$ milk, the test for a main effect of sugar would correspond to a comparison between the following two models (@tbl-tab13-19). --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-19" class="anchored">
<table id="tab:tbl-tab13-19" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表格&nbsp;14.19: 以’babble’作為結果變量的零假設和替代假設，使用類型 III 平方和</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;">Null model:</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">\(babble \sim milk + sugar * milk\)</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Alternative model:</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(babble \sim sugar + milk +sugar * milk \)</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>同樣，通過將完整模型與刪除牛奶術語的零模型進行檢驗，可以評估牛奶的主效應，如 <a href="#tbl-tab13-20">表格&nbsp;<span>14.20</span></a>。</p>
<!--- Similarly the main effect of milk is evaluated by testing the full model against a null model that removes the milk term, like in @tbl-tab13-20. --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-20" class="anchored">
<table id="tab:tbl-tab13-20" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表格&nbsp;14.20: 以’babble’作為結果變量的更多零假設和替代假設，使用類型 III 平方和</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;">Null model:</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">\(babble \sim sugar + sugar * milk\)</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Alternative model:</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(babble \sim sugar + milk +sugar * milk \)</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>最後，用完全相同的方式評估糖 × 牛奶的交互項。再次，我們將完整模型與刪除糖 × 牛奶交互項的零模型進行比較，如 <a href="#tbl-tab13-21">表格&nbsp;<span>14.21</span></a>。</p>
<!--- Finally, the interaction term sugar $\times$ milk is evaluated in exactly the same way. Once again, we test the full model against a null model that removes the sugar $\times$ milk interaction term, like in @tbl-tab13-21.--->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-21" class="anchored">
<table id="tab:tbl-tab13-21" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表格&nbsp;14.21: 從以“babble”為結果變量的假設中刪除交互項，使用類型 III 平方和</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;">Null model:</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">\(babble \sim sugar + milk\)</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Alternative model:</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(babble \sim sugar + milk +sugar * milk \)</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>基本思想可以推廣到更高階 ANOVA。例如，假設我們嘗試運行一個具有三個因素 A、B 和 C 的 ANOVA，並且我們希望考慮所有可能的主效應和所有可能的交互作用，包括三者之間的交互作用 A × B × C。(<a href="#tbl-tab13-22">表格&nbsp;<span>14.22</span></a>)為您展示了這種情況下類型 III 測試的外觀。</p>
<!--- The basic idea generalises to higher order ANOVAs. For instance, suppose that we were trying to run an ANOVA with three factors, A, B and C, and we wanted to consider all possible main effects and all possible interactions, including the three way interaction A $\times$ B $\times$ C. (@tbl-tab13-22) shows you what the Type III tests look like for this situation). --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-22" class="anchored">
<table id="tab:tbl-tab13-22" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表格&nbsp;14.22: 具有三個因素和所有主效應和交互項的類型 III 測試</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;">Term being tested is</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">Null model is outcome ~ ...</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">Alternative model is outcome ~ ...</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">A</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(B + C + A*B + A*C + B*C + A*B*C \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B + A*C + B*C + A*B*C \)</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">B</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(A + C + A*B + A*C + B*C + A*B*C \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B + A*C + B*C + A*B*C\)</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">C</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(A + B + A*B + A*C + B*C + A*B*C \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B + A*C + B*C + A*B*C \)</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">A*B</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*C + B*C + A*B*C \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B + A*C + B*C + A*B*C \)</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">A*C</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B + B*C + A*B*C \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B + A*C + B*C + A*B*C \)</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">B*C</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B + A*C + A*B*C \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B + A*C + B*C + A*B*C \)</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">A*B*C</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B + A*C + B*C \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B + A*C + B*C + A*B*C \)</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>儘管該表看起來很難看，但它相當簡單。在所有情況下，替代假設對應於包含三個主效應術語（例如 A）、三個雙向交互作用（例如 A * B）和一個三向交互作用（即 A * B * C）的完整模型。零模型總是包含其中 7 項中的 6 項，而缺少的一項就是我們正在嘗試測試其顯著性的那一項。</p>
<p>初步看來，類型 III 測試似乎是一個好主意。首先，我們消除了在運行類型 I 測試時遇到問題的不對稱性。而且，由於我們現在以相同的方式對待所有術語，假設測試的結果不依賴於我們指定它們的順序。這絕對是一件好事。然而，在解釋測試結果，特別是主效應術語時存在一個大問題。考慮<em>咖啡</em>數據。假設根據類型 III 測試，牛奶的主要效果並不顯著。這告訴我們的是，相比於完整模型，babble ~ sugar + sugar * milk 是數據的更好模型。但這意味著什麼呢？如果糖 * 牛奶的交互項也不顯著，我們會想得出結論說數據告訴我們唯一重要的事情是糖。但是，假設我們有一個顯著的交互項，但是牛奶的主效應不顯著。在這種情況下，我們是否應該認為真的有一個“糖的效果”，一個“牛奶和糖之間的交互作用”，但沒有“牛奶的效果”？那看起來很瘋狂。正確的答案簡直一定是，在交互作用顯著的情況下，談論主效應是毫無意義的<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a>。一般來說，這似乎是大多數統計學家給我們的建議，而我認為這是正確的建議。但是，如果談論存在顯著交互作用的非顯著主效應確實是毫無意義的，那麼類型 III 測試應該允許零假設依賴於一個包括交互作用但省略了其中一個主效應的模型就不是很明顯了。以這種方式表述的零假設實際上根本沒有什麼意義。</p>
<p>稍後，我們將看到類型 III 測試在某些情況下可以挽救，但首先讓我們看一下使用類型 III 和平方的 ANOVA 結果表，見 <a href="#fig-fig13-29">图&nbsp;<span>14.29</span></a>。</p>

<!--- As ugly as that table looks, it's pretty simple. In all cases, the alternative hypothesis corresponds to the full model which contains three main effect terms (e.g. A), three two-way interactions (e.g. A\*B) and one three-way interaction (i.e., A\*B\*C)). The null model always contains 6 of these 7 terms, and the missing one is the one whose significance we're trying to test.

At first pass, Type III tests seem like a nice idea. Firstly, we've removed the asymmetry that caused us to have problems when running Type I tests. And because we're now treating all terms the same way, the results of the hypothesis tests do not depend on the order in which we specify them. This is definitely a good thing. However, there is a big problem when interpreting the results of the tests, especially for main effect terms. Consider the *coffee* data. Suppose it turns out that the main effect of milk is not significant according to the Type III tests. What this is telling us is that babble \~ sugar + sugar\*milk is a better model for the data than the full model. But what does that even mean? If the interaction term sugar\*milk was also non significant, we'd be tempted to conclude that the data are telling us that the only thing that matters is sugar. But suppose we have a significant interaction term, but a non-significant main effect of milk. In this case, are we to assume that there really is an "effect of sugar", an "interaction between milk and sugar", but no "effect of milk"? That seems crazy. The right answer simply must be that it's meaningless[^factorial-anova-12] to talk about the main effect if the interaction is significant. In general, this seems to be what most statisticians advise us to do, and I think that's the right advice. But if it really is meaningless to talk about non-significant main effects in the presence of a significant interaction, then it's not at all obvious why Type III tests should allow the null hypothesis to rely on a model that includes the interaction but omits one of the main effects that make it up. When characterised in this fashion, the null hypotheses really don't make much sense at all.

[^factorial-anova-12]: Or, at the very least, rarely of interest.

Later on, we'll see that Type III tests can be redeemed in some contexts, but first let's take a look at the ANOVA results table using Type III sum of squares, see @fig-fig13-29. --->
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-29" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-29.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">图&nbsp;14.29: 在 jamovi 中使用類型 III 和平方的 ANOVA 結果表</figcaption>
</figure>
</div>
</div>
</div>
<p>但要注意，類型 III 測試策略的一個怪異特徵是，通常結果依賴於用於編碼因子的對比（如果您忘記了不同類型對比是什麼，請參見 [指定對比的不同方式]一節）。<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a></p>
<p>那麼，如果類型 III 分析（但不是在 jamovi 中）通常產生的 p 值對對比的選擇非常敏感，那是否意味著類型 III 測試本質上是任意的，不值得信任？在某種程度上，這是真的，當我們轉向討論類型 II 測試時，我們將看到類型 II 分析完全避免了這種任意性，但我認為這是一個過於強烈的結論。首先，重要的是要認識到某些對比選擇總是會產生相同的答案（啊，所以這就是 jamovi 中發生的事情）。特別重要的是，如果我們的對比矩陣的列都受限於求和為零，那麼類型 III 分析將始終給出相同的答案。</p>
<p>在類型 II 測試中，我們將看到類型 II 分析完全避免了這種任意性，但我認為這是一個過於強烈的結論。首先，重要的是要認識到某些對比選擇總是會產生相同的答案（啊，所以這就是 jamovi 中發生的事情）。特別重要的是，如果我們的對比矩陣的列都受限於求和為零，那麼類型 III 分析將始終給出相同的答案。</p>
<!--- But be aware, one of the perverse features of the Type III testing strategy is that typically the results turn out to depend on the contrasts that you use to encode your factors (see the [Different ways to specify contrasts] section if you've forgotten what the different types of contrasts are).[^factorial-anova-13]

[^factorial-anova-13]: However, in jamovi the results for Type III sum of squares ANOVA are the same regardless of the contrast selected, so jamovi is obviously doing something different!

Okay, so if the p-values that typically come out of Type III analyses (but not in jamovi) are so sensitive to the choice of contrasts, does that mean that Type III tests are essentially arbitrary and not to be trusted? To some extent that's true, and when we turn to a discussion of Type II tests we'll see that Type II analyses avoid this arbitrariness entirely, but I think that's too strong a conclusion. Firstly, it's important to recognise that some choices of contrasts will always produce the same answers (ah, so this is what is happening in jamovi). Of particular importance is the fact that if the columns of our contrast matrix are all constrained to sum to zero, then the Type III analysis will always give the same answers.

In Type II tests we'll see that Type II analyses avoid this arbitrariness entirely, but I think that's too strong a conclusion. Firstly, it's important to recognise that some choices of contrasts will always produce the same answers (ah, so this is what is happening in jamovi). Of particular importance is the fact that if the columns of our contrast matrix are all constrained to sum to zero, then the Type III analysis will always give the same answers.--->
</section>
<section id="第二型平方差總和" class="level3" data-number="14.10.5">
<h3 data-number="14.10.5" class="anchored" data-anchor-id="第二型平方差總和"><span class="header-section-number">14.10.5</span> 第二型平方差總和</h3>
<p>好的，到目前為止，我們已經看過了類型 I 和 III 測試，兩者都非常簡單。類型 I 測試是通過逐一添加條款進行的，而類型 III 測試是通過使用完整模型並檢查在刪除每個條款時會發生什麼來執行的。然而，這兩者都可能有一些局限性。類型 I 測試取決於您輸入條款的順序，而類型 III 測試則取決於您如何編碼對比。類型 II 測試描述起來稍微困難一些，但它們避免了這兩個問題，因此解釋起來稍微容易一些。</p>
<p>類型 II 測試與類型 III 測試大致相似。從一個“完整”模型開始，通過從該模型中刪除特定條款來進行測試。然而，類型 II 測試是基於邊際性原則的，該原則規定如果您的模型中有任何依賴於較低階條款的較高階條款，則不應從模型中省略較低階條款。所以，例如，如果您的模型包含兩個因素的交互作用 A × B（二階條款），那麼它確實應該包含主效應 A 和 B（一階條款）。同樣，如果它包含三個因素的交互作用項 A × B × C，那麼模型還必須包括主效應 A、B 和 C 以及簡單的交互作用 A × B、A × C 和 B × C。類型 III 測試經常違反邊際性原則。例如，考慮在包含所有可能交互作用條款的三因子 ANOVA 中測試 A 的主效應。根據類型 III 測試，我們的零假設和對立假設在 <a href="#tbl-tab13-23">表格&nbsp;<span>14.23</span></a> 中。</p>
<!---- Okay, so we've seen Type I and III tests now, and both are pretty straightforward. Type I tests are performed by gradually adding terms one at a time, whereas Type III tests are performed by taking the full model and looking to see what happens when you remove each term. However, both can have some limitations. Type I tests are dependent on the order in which you enter the terms, and Type III tests are dependent on how you code up your contrasts. Type II tests are a little harder to describe, but they avoid both of these problems, and as a result they are a little easier to interpret.

Type II tests are broadly similar to Type III tests. Start with a "full" model, and test a particular term by deleting it from that model. However, Type II tests are based on the marginality principle which states that you should not omit a lower order term from your model if there are any higher order ones that depend on it. So, for instance, if your model contains the two-way interaction A $\times$ B (a 2nd order term), then it really ought to contain the main effects A and B (1st order terms). Similarly, if it contains a three-way interaction term A $\times$ B $\times$ C, then the model must also include the main effects A, B and C as well as the simpler interactions A $\times$ B, A $\times$ C and B $\times$ C. Type III tests routinely violate the marginality principle. For instance, consider the test of the main effect of A in the context of a three-way ANOVA that includes all possible interaction terms. According to Type III tests, our null and alternative models are in @tbl-tab13-23. --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-23" class="anchored">
<table id="tab:tbl-tab13-23" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表格&nbsp;14.23: 類型 III 測試在包含所有可能交互作用條款的三因子 ANOVA 中對主效應 A 進行測試</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;">Null model:</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">\(outcome \sim B + C + A*B + A*C + B*C + A*B*C\)</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Alternative model:</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(outcome \sim A + B + C + A*B + A*C + B*C + A*B*C\)</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>注意，零假設省略了 A，但將 A × B、A × C 和 A × B × C 作為模型的一部分。根據類型 II 測試，這並不是一個好的零假設選擇。相反，如果我們希望檢驗 A 對結果無關的零假設，我們應該指定一個不依賴於 A 的任何形式（即使是交互作用）的最復雜的模型。對立假設對應於該零模型加上 A 的主效應項。這個概念更接近大多數人對 “A 的主效應” 的直觀理解，並且得出了 A 的主效應的類型 II 測試（<a href="#tbl-tab13-24">表格&nbsp;<span>14.24</span></a>）。<a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a></p>
<!--- Notice that the null hypothesis omits A, but includes A $\times$ B, A $\times$ C and A $\times$ B $\times$ C as part of the model. This, according to the Type II tests, is not a good choice of null hypothesis. What we should do instead, if we want to test the null hypothesis that A is not relevant to our outcome, is to specify the null hypothesis that is the most complicated model that does not rely on A in any form, even as an interaction. The alternative hypothesis corresponds to this null model plus a main effect term of A. This is a lot closer to what most people would intuitively think of as a "main effect of A", and it yields the following as our Type II test of the main effect of A (@tbl-tab13-24). [^factorial-anova-14]

[^factorial-anova-14]: Note, of course, that this does depend on the model that the user specified. If the original ANOVA model doesn't contain an interaction term for $B \times C$, then obviously it won't appear in either the null or the alternative. But that's true for Types I, II and III. They never include any terms that you didn't include, but they make different choices about how to construct tests for the ones that you did include. --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-24" class="anchored">
<table id="tab:tbl-tab13-24" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表格&nbsp;14.24: 類型 II 測試在包含所有可能交互作用條款的三因子 ANOVA 中對主效應 A 進行測試</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;">Null model:</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">\(outcome \sim B + C + B*C\)</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Alternative model:</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(outcome \sim A + B + C + B*C\)</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>無論如何，僅為了讓您了解類型 II 測試是如何進行的，這是在三因子因素分析中應用的完整測試表格（<a href="#tbl-tab13-25">表格&nbsp;<span>14.25</span></a>）：</p>

<!--- Anyway, just to give you a sense of how the Type II tests play out, here's the full table (@tbl-tab13-25) of tests that would be applied in a three-way factorial ANOVA:--->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-25" class="anchored">
<table id="tab:tbl-tab13-25" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表格&nbsp;14.25: 三因子因素模型的類型 II 測試</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;">Term being tested is</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">Null model is outcome ~ ...</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">Alternative model is outcome ~ ...</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">A</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(B + C + B*C \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(A + B + C + B*C \)</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">B</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(A + C + A*C \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*C\)</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">C</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(A + B + A*B \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B\)</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">A*B</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*C + B*C \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B + A*C + B*C \)</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">A*C</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B + B*C \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B + A*C + B*C \)</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">B*C</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B + A*C \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B + A*C + B*C \)</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">A*B*C</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B + A*C + B*C \)</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(A + B + C + A*B + A*C + B*C + A*B*C \)</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>在我們一直在<em>咖啡</em>數據中使用的雙因子 ANOVA 的背景下，假設檢驗更為簡單。糖的主效應對應於比較這兩個模型的 F 檢驗（<a href="#tbl-tab13-26">表格&nbsp;<span>14.26</span></a>）。</p>
<!--- In the context of the two way ANOVA that we've been using in the *coffee* data, the hypothesis tests are even simpler. The main effect of sugar corresponds to an F-test comparing these two models (@tbl-tab13-26). --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-26" class="anchored">
<table id="tab:tbl-tab13-26" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表格&nbsp;14.26: 咖啡數據中糖主效應的類型 II 測試</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;">Null model:</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">\(babble \sim milk \)</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Alternative model:</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(babble \sim sugar + milk\)</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>對牛奶主效應的檢驗位於 <a href="#tbl-tab13-27">表格&nbsp;<span>14.27</span></a>。</p>
<!--- The test for the main effect of milk is in @tbl-tab13-27. --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-27" class="anchored">
<table id="tab:tbl-tab13-27" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表格&nbsp;14.27: 咖啡數據中牛奶主效應的類型 II 測試</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;">Null model:</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">\(babble \sim sugar \)</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Alternative model:</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(babble \sim sugar + milk\)</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>最後，糖與牛奶交互作用的檢驗位於 <a href="#tbl-tab13-28">表格&nbsp;<span>14.28</span></a>。</p>
<!--- Finally, the test for the interaction sugar $\times$ milk is in @tbl-tab13-28. --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-28" class="anchored">
<table id="tab:tbl-tab13-28" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表格&nbsp;14.28: 以類型 II方法分析糖與牛奶交互作用</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;">Null model:</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">\(babble \sim sugar + milk \)</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">Alternative model:</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">\(babble \sim sugar + milk + sugar*milk \)</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>運行測試再次很簡單。只需在 jamovi ‘ANOVA’ - ‘Model’ 選項中的 ‘Sum of squares’ 選擇框中選擇 ‘Type 2’，這將給我們提供 ANOVA 表格，如 <a href="#fig-fig13-30">图&nbsp;<span>14.30</span></a> 所示。</p>

<!--- Running the tests are again straightforward. Just select 'Type 2' in the 'Sum of squares' selection box in the jamovi 'ANOVA' - 'Model' options, This gives us the ANOVA table shown in @fig-fig13-30. --->
<div class="cell enlarge-image" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-fig13-30" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/fig14-30.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">图&nbsp;14.30: 在 jamovi 中使用類型 II 平方和的 ANOVA 結果表</figcaption>
</figure>
</div>
</div>
</div>
<p>類型 II 測試比類型 I 和類型 III 測試具有一些明顯的優勢。它們不依賴於指定因子的順序（與類型 I 不同），也不依賴於用於指定因子的對比（與類型 III 不同）。雖然對於最後一點意見可能會有所不同，而且這肯定取決於你想用你的數據做什麼，但我認為它們指定的假設檢驗更有可能對應於你真正關心的事物。因此，我發現解釋類型 II 測試的結果通常比解釋類型 I 或類型 III 測試的結果更容易。基於這個原因，我的初步建議是，如果您無法想出任何直接映射到研究問題的明顯模型比較，但仍想在不平衡設計中運行 ANOVA，類型 II 測試可能是比類型 I 或類型 III 更好的選擇。<a href="#fn14" class="footnote-ref" id="fnref14" role="doc-noteref"><sup>14</sup></a></p>
<!--- Type II tests have some clear advantages over Type I and Type III tests. They don't depend on the order in which you specify factors (unlike Type I), and they don't depend on the contrasts that you use to specify your factors (unlike Type III). And although opinions may differ on this last point, and it will definitely depend on what you're trying to do with your data, I do think that the hypothesis tests that they specify are more likely to correspond to something that you actually care about. As a consequence, I find that it's usually easier to interpret the results of a Type II test than the results of a Type I or Type III test. For this reason my tentative advice is that, if you can't think of any obvious model comparisons that directly map onto your research questions but you still want to run an ANOVA in an unbalanced design, Type II tests are probably a better choice than Type I or Type III.[^factorial-anova-15]

[^factorial-anova-15]: I find it amusing to note that the default in R is Type I and the default in SPSS and jamovi is Type III. Neither of these appeals to me all that much. Relatedly, I find it depressing that almost nobody in the psychological literature ever bothers to report which Type of tests they ran, much less the order of variables (for Type I) or the contrasts used (for Type III). Often they don't report what software they used either. The only way I can ever make any sense of what people typically report is to try to guess from auxiliary cues which software they were using, and to assume that they never changed the default settings. Please don't do this! Now that you know about these issues make sure you indicate what software you used, and if you're reporting ANOVA results for unbalanced data, then specify what Type of tests you ran, specify order information if you've done Type I tests and specify contrasts if you've done Type III tests. Or, even better, do hypotheses tests that correspond to things you really care about and then report those! --->
</section>
<section id="效果量還有非加成性平方差總和" class="level3" data-number="14.10.6">
<h3 data-number="14.10.6" class="anchored" data-anchor-id="效果量還有非加成性平方差總和"><span class="header-section-number">14.10.6</span> 效果量(還有非加成性平方差總和)</h3>
<p>jamovi 在您選擇這些選項時還會提供效應大小 <span class="math inline">\(\eta^2\)</span> 和部分 <span class="math inline">\(\eta^2\)</span>，如 <a href="#fig-fig13-30">图&nbsp;<span>14.30</span></a>。然而，在不平衡設計中，涉及的額外複雜性有所增加。</p>
<p>如果您回顧我們對 ANOVA 的早期討論，其中一個關鍵想法是在平方和計算的背後，如果我們把所有與模型中的效應相關的 SS 項加起來，再加上殘差 SS，它們應該加起來等於總平方和。此外，<span class="math inline">\(\eta^2\)</span> 背後的整個想法是，因為您將某個 SS 項除以總 SS 值，<span class="math inline">\(\eta^2\)</span> 值可以解釋為由特定項解釋的變異比例。但在不平衡設計中，這並不那麼簡單，因為有些變異會”丟失”。</p>
<p>起初這似乎有點奇怪，但原因是這樣的。當您擁有不平衡設計時，您的因子會相互關聯，因此很難分辨因子 A 的效應和因子 B 的效應。在極端情況下，假設我們進行了一個 <span class="math inline">\(2 \times 2\)</span> 設計，每個組中的參與者人數如 <a href="#tbl-tab13-29">表格&nbsp;<span>14.29</span></a>。</p>
<!--- jamovi also provides the effect sizes $\eta^2$ and partial $\eta^2$ when you select these options, as in @fig-fig13-30. However, when you've got an unbalanced design there's a bit of extra complexity involved.

If you remember back to our very early discussions of ANOVA, one of the key ideas behind the sums of squares calculations is that if we add up all the SS terms associated with the effects in the model, and add that to the residual SS, they're supposed to add up to the total sum of squares. And, on top of that, the whole idea behind $\eta^2$ is that, because you're dividing one of the SS terms by the total SS value, an $\eta^2$ value can be interpreted as the proportion of variance accounted for by a particular term. But this is not so straightforward in unbalanced designs because some of the variance goes "missing".

This seems a bit odd at first, but here's why. When you have unbalanced designs your factors become correlated with one another, and it becomes difficult to tell the difference between the effect of Factor A and the effect of Factor B. In the extreme case, suppose that we'd run a $2 \times 2$ design in which the number of participants in each group had been as in @tbl-tab13-29. --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-29" class="anchored">
<table id="tab:tbl-tab13-29" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表格&nbsp;14.29: 2 x 2 非常（非常！）不平衡的因子設計中的 N 參與者</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;"></td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">sugar</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">no sugar</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">milk</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">100</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">no milk</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">0</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">100</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>在這裡，我們有一個非常不平衡的設計：100人有牛奶和糖，100人沒有牛奶和糖，就是這樣。有0人有牛奶沒有糖，也有0人有糖沒有牛奶。現在假設，當我們收集數據時，發現”牛奶和糖”組與”無牛奶無糖”組之間存在很大（並且具有統計顯著性）的差異。這是糖的主要效應嗎？牛奶的主要效應？還是交互作用？這是不可能知道的，因為糖的存在與牛奶的存在具有完美的關聯。現在假設設計稍微平衡一些（<a href="#tbl-tab13-30">表格&nbsp;<span>14.30</span></a>）。</p>
<!--- Here we have a spectacularly unbalanced design: 100 people have milk and sugar, 100 people have no milk and no sugar, and that's all. There are 0 people with milk and no sugar, and 0 people with sugar but no milk. Now suppose that, when we collected the data, it turned out there is a large (and statistically significant) difference between the "milk and sugar" group and the "no-milk and no-sugar" group. Is this a main effect of sugar? A main effect of milk? Or an interaction? It's impossible to tell, because the presence of sugar has a perfect association with the presence of milk. Now suppose the design had been a little more balanced (@tbl-tab13-30). --->
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="tbl-tab13-30" class="anchored">
<table id="tab:tbl-tab13-30" class="huxtable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>表格&nbsp;14.30: 2 x 2 仍然非常不平衡的因子設計中的 N 參與者</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: bold;"></td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: bold;">sugar</td>
<td data-quarto-table-cell-role="th" style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: bold;">no sugar</td>
</tr>
<tr class="even">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">milk</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">100</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">5</td>
</tr>
<tr class="odd">
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 0pt; font-weight: normal;">no milk</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 12pt 2pt 12pt; font-weight: normal;">5</td>
<td style="text-align: center; vertical-align: top; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 2pt 0pt 2pt 12pt; font-weight: normal;">100</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>這次，從技術上講，可以區分牛奶和糖的效應，因為我們有一些人只擁有其中之一。然而，由於糖和牛奶之間的關聯仍然非常強烈，兩個小組中的觀察值非常少，因此進行區分仍然相當困難。再次，我們很可能處於這樣一種情況：我們<em>知道</em>預測變量（牛奶和糖）與結果（發聲）相關，但我們不知道這種關係的本質是一個或另一個預測因子的主要效應，還是交互作用。</p>
<p>在不平衡設計的背景下，當糖和牛奶的效應相互關聯時，應該選擇 Type II ANOVA 進行分析，因為它更易於解釋並可以避免因變量順序或對比方式帶來的問題。無論您是使用什麼軟件，都應該在報告結果時說明您使用的是哪種類型的 ANOVA 測試，以確保分析結果的準確性。</p>
<!--- This time around, it's technically possible to distinguish between the effect of milk and the effect of sugar, because we have a few people that have one but not the other. However, it will still be pretty difficult to do so, because the association between sugar and milk is still extremely strong, and there are so few observations in two of the groups. Again, we're very likely to be in the situation where we *know* that the predictor variables (milk and sugar) are related to the outcome (babbling), but we don't know if the nature of that relationship is a main effect of one or the other predictor, or the interaction.--->
</section>
</section>
<section id="本章小結" class="level2" data-number="14.11">
<h2 data-number="14.11" class="anchored" data-anchor-id="本章小結"><span class="header-section-number">14.11</span> 本章小結</h2>
<ul>
<li><a href="14-Factorial-ANOVA.html#平衡且無交互作用的因子設計分析">平衡且無交互作用的因子設計分析</a>以及<a href="14-Factorial-ANOVA.html#平衡且有交互作用的因子設計分析">有交互作用因子設計分析</a></li>
<li>因子設計變異數分析的<a href="14-Factorial-ANOVA.html#變異數分析的效果量">效果量</a>估計平均值以及信賴區間。</li>
<li><a href="14-Factorial-ANOVA.html#檢核變異數分析的執行條件">檢核變異數分析的執行條件</a></li>
<li><a href="14-Factorial-ANOVA.html#sec-analysis-of-covariance-ancova">共變數分析 (ANCOVA)</a></li>
<li><a href="14-Factorial-ANOVA.html#sec-ANOVA-as-a-linear-model">變異數分析就是線性模型</a>還有<a href="14-Factorial-ANOVA.html#各種多重比較方案">各種多重比較方案</a></li>
<li><a href="14-Factorial-ANOVA.html#sec-Post-hoc-tests">事後檢定</a>談到杜凱氏HSD，還有提到規劃使用<a href="14-Factorial-ANOVA.html#sec-The-method-of-planned-comparisons">事前檢定方法</a>要思考的條件。</li>
<li><a href="14-Factorial-ANOVA.html#不平衡的因子設計分析">不平衡的因子設計分析</a></li>
</ul>


<div id="refs" class="references csl-bib-body hanging-indent" data-line-spacing="2" role="list" style="display: none">
<div id="ref-Everitt1996" class="csl-entry" role="listitem">
Everitt, B. S. (1996). <em>Making Sense of Statistics in Psychology. A Second-Level Course</em>. Oxford University Press.
</div>
<div id="ref-Hsu1996" class="csl-entry" role="listitem">
Hsu, J. C. (1996). <em>Multiple Comparisons: Theory and Methods</em>. Chapman; Hall.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>下標表示法的好處在於它可以很好地推廣。如果我們的實驗涉及到第三個因子，那麼我們可以添加第三個下標。原則上，表示法可以擴展到您可能想要包括的任意多個因子，但在本書中，我們很少考慮涉及兩個以上因子的分析，也絕不超過三個。<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>技術上說，邊際化與普通均值並不完全相同。邊際化是一個加權平均數，在其中您需要考慮到您正在平均的不同事件的頻率。然而，在一個平衡設計中，我們所有的單元格頻率在概念上都是相等的，所以兩者是等價的。我們稍後將討論不平衡設計，當我們這樣做時，您將看到我們所有的計算都變得非常令人頭痛。但現在讓我們先忽略這一點。<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>現在我們的表示法已經確定，我們可以用相對熟悉的方式計算每個因子的平方和值。對於因子 A，我們通過評估（行）邊緣均值 <span class="math inline">\(\bar{Y}_{1.} , \bar{Y}_{2.}\)</span> 等與總體均值 <span class="math inline">\(\bar{Y}_{..}\)</span> 之間的差異來計算組間平方和。我們用與單因子方差分析相同的方法做到這一點：計算 <span class="math inline">\(\bar{Y}_{i.}\)</span> 值和 <span class="math inline">\(\bar{Y}_{..}\)</span> 值之間的平方差。具體來說，如果每組有 N 個人，那麼我們計算這個 <span class="math display">\[SS_A=(N \times C)\sum_{r=1}^R (\bar{Y}_{r.}-\bar{Y}_{..})^2\]</span> 與單因子方差分析一樣，這個公式最有趣的部分是 ^a 部分，它對應於與第 r 級相關的平方偏差。這個公式所做的就是計算因子的所有 R 個水平的這個平方偏差，加起來，然後將結果乘以 <span class="math inline">\(N \times C\)</span>。這最後一部分的原因是我們的設計中有多個細胞在因子 A 上有水平 <span class="math inline">\(r\)</span>。事實上，它們有 C 個，每個可能的因子 B 水平對應一個。例如，在我們的例子中，設計中有兩個不同的細胞對應於 anxifree 藥物：一個對於沒有治療的人，另一個對於 CBT 組。不僅如此，在這些細胞中的每一個中都有 N 個觀察值。因此，如果我們想將我們的 SS 值轉換為一個在“每次觀察”的基礎上計算組間平方和的數量，我們必須乘以 <span class="math inline">\(N \times C\)</span>。因子 <span class="math inline">\(B\)</span> 的公式當然也是一樣的，只是一些下標被打亂了 <span class="math display">\[SS_B=(N \times R)\sum_{c=1}^C (\bar{Y}_{.c}-\bar{Y}_{..})^2\]</span> 現在我們有了這些公式，我們可以將它們與早期部分的 jamovi 輸出進行對比。再次強調，專用的電子表格程序對於這類計算很有幫助，所以請自己動手試試。您還可以查看我在 Excel 文件<em>clinicaltrial_factorialanova.xls</em>中完成的版本。首先，讓我們計算與藥物主要效果相關的平方和。每個組中共有 <span class="math inline">\(N = 3\)</span> 人，並且有 <span class="math inline">\(C = 2\)</span> 種不同類型的治療。換句話說，共有 <span class="math inline">\(3 \times 2 = 6\)</span> 人接受了任何特定的藥物。當我們在電子表格程序中進行這些計算時，我們得到了一個與藥物主要效果相關的平方和值為 3.45。並不奇怪，這與您在我之前呈現的 ANOVA 表中查看藥物因子的 SS 值時獲得的數字相同，在 <a href="#fig-fig13-3">图&nbsp;<span>14.3</span></a>。 <br> 我們可以對治療效果重複相同類型的計算。同樣，每個組中有 <span class="math inline">\(N = 3\)</span> 人，但由於有 <span class="math inline">\(R = 3\)</span> 種不同的藥物，這次我們注意到有 <span class="math inline">\(3 \times 3 = 9\)</span> 人接受了 CBT 以及另外 9 人接受了安慰劑。因此，在這種情況下，我們的計算給出了與治療主要效果相關的平方和值為 <span class="math inline">\(0.47\)</span>。同樣，我們並不驚訝地看到我們的計算與 <a href="#fig-fig13-3">图&nbsp;<span>14.3</span></a> 中的 ANOVA 輸出相同。<br>我們可以對治療效果重複相同類型的計算。同樣，每個組中有 <span class="math inline">\(N = 3\)</span> 人，但由於有 <span class="math inline">\(R = 3\)</span> 種不同的藥物，這次我們注意到有 <span class="math inline">\(3 \times 3 = 9\)</span> 人接受了 CBT 以及另外 9 人接受了安慰劑。因此，在這種情況下，我們的計算給出了與治療主要效果相關的平方和值為 <span class="math inline">\(0.47\)</span>。同樣，我們並不驚訝地看到我們的計算與 <a href="#fig-fig13-3">图&nbsp;<span>14.3</span></a> 中的 ANOVA 輸出相同。 <br> 這就是您如何計算兩個主要效果的 SS 值。這些 SS 值類似於我們在 <a href="13-Comparing-several-means-one-way-ANOVA.html"><span>章节&nbsp;13</span></a> 中進行單因素方差分析時計算的組間平方和值。然而，將它們視為組間 SS 值並不是個好主意，因為我們有兩個不同的分組變量，容易混淆。然而，為了構建一個 <span class="math inline">\(F\)</span> 檢驗，我們還需要計算組內平方和。為了與我們在 <a href="12-Correlation-and-linear-regression.html"><span>章节&nbsp;12</span></a> 中使用的術語以及 jamovi 在打印 ANOVA 表時使用的術語保持一致，我將開始將組內 SS 值稱為殘差平方和 <span class="math inline">\(SS_R\)</span>。<br>在這種情況下，我認為考慮殘差 SS 值的最簡單方法是將其視為在考慮邊際均值差異（即去除 <span class="math inline">\(SS_A\)</span> 和 <span class="math inline">\(SS_B\)</span> ）後結果變量中剩餘的變異。我的意思是，我們可以首先計算總平方和，我將其標記為 <span class="math inline">\(SS_T\)</span>。這個公式與單因素方差分析時的公式幾乎相同。我們將每個觀察值 Yrci 與總平均數 <span class="math inline">\(\bar{Y}_{..}\)</span> 之間的差異平方，然後將它們全部相加 <span class="math display">\[SS_T=\sum_{r=1}^R \sum_{c=1}^C \sum_{i=1}^N (Y_{rci}-\bar{Y}_{..})^2\]</span> 這裡的“三重求和”看起來比實際上複雜。在前兩個求和中，我們對因子 <span class="math inline">\(A\)</span> 的所有級別進行求和（即在我們的表格中的所有可能行 <span class="math inline">\(r\)</span> ）並對因子 <span class="math inline">\(B\)</span> 的所有級別進行求和（即所有可能列 <span class="math inline">\(c\)</span> ）。每個 rc 組合對應一個單獨的組，每個組包含 <span class="math inline">\(N\)</span> 人，所以我們也必須對所有這些人（即所有 <span class="math inline">\(i\)</span> 值）進行求和。換句話說，我們在這裡做的只是對數據集中的所有觀察值進行求和（即所有可能的 rci 組合）。在這一點上，我們知道結果變量的總變異性 SST，並且知道這些變異性中有多少可以歸因於因子 A（<span class="math inline">\(SS_A\)</span>）以及有多少可以歸因於因子 B（<span class="math inline">\(SS_B\)</span>）。因此，殘差平方和被定義為無法歸因於我們兩個因子的 <span class="math inline">\(Y\)</span> 變異。換句話說 <span class="math display">\[SS_R=SS_T-(SS_A+SS_B)\]</span> 當然，您可以使用一個公式直接計算殘差 SS，但我認為從概念上這樣考慮更有意義。將其稱為殘差的全部意義在於它是剩餘變異，上面的公式說明了這一點。我還應該指出，按照回歸章節中使用的術語，我們通常將 <span class="math inline">\(SS_A + SS_B\)</span> 稱為“ANOVA 模型”可歸因的變異，用 SSM 表示，因此我們經常說總平方和等於模型平方和加殘差平方和。稍後在本章中，我們將看到這不僅僅是表面相似性：在底層，ANOVA 和回歸實際上是相同的事物。無論如何，檢查我們是否可以使用此公式計算 <span class="math inline">\(SS_R\)</span> 並驗證我們是否可以獲得與 jamovi 在其 ANOVA 表中生成的相同答案可能是值得的。在電子表格中完成的計算非常簡單（參見 clinicaltrial_factorialanova.xls 文件）。我們可以使用上面的公式計算總 SS（獲得總 SS = 4.85 的答案），然後計算殘差 SS（= 0.92）。再一次，我們得到了相同的答案。<br> — <br> <span class="math inline">\(^a\)</span> 英文翻譯：“最不繁瑣”。<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>因此，將交互作用效應的概念用零假設和替代假設的條款來正式表示的方式有點困難，我猜想這本書的很多讀者可能對此並不感興趣。儘管如此，我將在此嘗試介紹基本概念。首先，我們需要更明確地說明我們的主要效果。考慮因子<span class="math inline">\(A\)</span>（我們的運行示例中的藥物）的主要效果。我們最初根據兩個邊際均值<span class="math inline">\(\mu_r\)</span>相等的零假設來表述這一點。顯然，如果所有這些值彼此相等，那麼它們也必須等於總均值<span class="math inline">\(\mu_{..}\)</span>，對吧？所以我們可以做的是將因子<span class="math inline">\(A\)</span>在水平<span class="math inline">\(r\)</span>的效應定義為邊際均值<span class="math inline">\(\mu_{r.}\)</span>和總均值<span class="math inline">\(\mu_{..}\)</span>之間的差。讓我們用<span class="math inline">\(\alpha_r\)</span>表示這個效果，並注意到 <span class="math display">\[\alpha_r=\mu_{r.}-\mu_{..}\]</span> 現在，根據定義，所有的<span class="math inline">\(\alpha_r\)</span>值必須相加為零，原因是邊際均值<span class="math inline">\(\mu_c\)</span>的平均值必須等於總平均值<span class="math inline">\(\mu_{..}\)</span>。我們可以類似地將因子B在<span class="math inline">\(c\)</span>水平的效應定義為列邊際均值<span class="math inline">\(\mu_{.c}\)</span>和總均值<span class="math inline">\(\mu_{..}\)</span>之間的差： <span class="math display">\[\beta_c=\mu_{.c}-\mu_{..}\]</span>同樣地，這些<span class="math inline">\(\beta_c\)</span>值必須相加為零。統計學家有時喜歡用這些<span class="math inline">\(\alpha_r\)</span>和<span class="math inline">\(\beta_c\)</span>值來談論主要效果，因為這樣他們可以明確地說明無交互作用效應意味著什麼。如果完全沒有交互作用，那麼這些<span class="math inline">\(\alpha_r\)</span>和<span class="math inline">\(\beta_c\)</span>值將完美地描述組均值<span class="math inline">\(\mu_{rc}\)</span>。具體來說，這意味著<span class="math display">\[\mu_{rc}=\mu_{..}+\alpha_{r}+\beta_{c}\]</span>也就是說，僅僅通過了解所有邊際均值，您就能完全預測到組均值。這就是我們的零假設。替代假設是<span class="math display">\[\mu_{rc} \neq \mu_{..}+\alpha_{r}+\beta_{c}\]</span>至少對於表格中的一個組<span class="math inline">\(rc\)</span>而言。然而，統計學家通常喜歡稍微不同地寫這個。他們通常會定義與組<span class="math inline">\(rc\)</span>相關的特定交互作用為一個數字，笨拙地稱為<span class="math inline">\((\alpha \beta)_{rc}\)</span>，然後他們將說替代假設是<span class="math display">\[\mu_{rc}=\mu_{..} +\alpha_{r} +\beta_{c} + (\alpha \beta )_{rc}\]</span>其中<span class="math inline">\((\alpha \beta)_{rc}\)</span>對於至少一個組是非零。這種表示法看起來有點難看，但在討論如何計算平方和時它非常方便。我們應該如何計算交互項的平方和，<span class="math inline">\(SS_{A:B}\)</span>？首先，有助於注意我們如何剛剛根據實際組均值與僅查看邊際均值所預期的程度的差異來定義交互作用效應。當然，所有這些公式都是指群體參數而非樣本統計數據，因此我們實際上不知道它們是什麼。但是，我們可以通過將樣本均值代替群體均值來估計它們。因此，對於因子<span class="math inline">\(A\)</span>，在<span class="math inline">\(r\)</span>水平的主要效果的一個好的估計方法是樣本邊際均值<span class="math inline">\(\bar{Y}_{rc}\)</span>與樣本總均值<span class="math inline">\(\bar{Y}_{..}\)</span>之間的差。也就是說，我們將使用這個作為效果的估計<span class="math display">\[\hat{\alpha}_r = \bar{Y}_{r.}-\bar{Y}_{..}\]</span>同樣地，我們可以將因子<span class="math inline">\(B\)</span>在<span class="math inline">\(c\)</span>水平的主要效果的估計定義為以下<span class="math display">\[\hat{\beta}_{c}=\bar{Y}_{.c}-\bar{Y}_{..}\]</span>現在，如果您回顧一下我用來描述兩個主要效果的<span class="math inline">\(SS\)</span>值的公式，您會注意到這些效果值正是我們正方形和求和的量！那麼，對於交互項來說，這個類比是什麼呢？通過首先重新排列替代假設下組均值<span class="math inline">\(\mu_{rc}\)</span>的公式，我們可以找到這個答案，以便我們得到這個<span class="math display">\[\begin{aligned} (\alpha \beta)_{rc} &amp; = \mu_{rc} - \mu_{..} - \alpha_r - \beta_c \\ &amp; = \mu_{rc} - \mu_{..} - (\mu_{r.}-\mu_{..})-(\mu_{.c}-\mu_{..}) \\ &amp; = \mu_{rc} - \mu_{r.} - \mu_{.c} +\mu_{..} \end{aligned}\]</span>因此，再次將樣本統計數據代替群體均值，我們將得到以下作為組<span class="math inline">\(rc\)</span>的交互作用效應的估計，即<span class="math display">\[(\hat{\alpha \beta})_{rc}=\bar{Y}_{rc}-\bar{Y}_{r.}-\bar{Y}_{.c}+\bar{Y}_{..}\]</span>現在我們所要做的就是將所有這些估計加起來，涵蓋因子<span class="math inline">\(A\)</span>的所有<span class="math inline">\(R\)</span>水平和因子<span class="math inline">\(B\)</span>的所有<span class="math inline">\(C\)</span>水平，然後我們得到以下公式，與整個交互作用相關的平方和<span class="math display">\[SS_{A:B}=N \sum_{r=1}^R \sum_{c=1}^C (\bar{Y}_{rc}-\bar{Y}_{r.}-\bar{Y}_{.c}+\bar{Y}_{..})^2\]</span>這裡，我們將其乘以N，因為每個組中都有N個觀察值，我們希望我們的<span class="math inline">\(SS\)</span>值反映交互作用解釋的觀察值變異，而不是組之間的變異。現在我們有了計算<span class="math inline">\(SS_{A:B}\)</span>的公式，重要的是要認識到交互項是模型的一部分（當然），所以與模型相關的總平方和，SSM，現在等於三個相關的SS值之和，<span class="math inline">\(SS_A + SS_B + SS_{A:B}\)</span>。剩餘平方和SSR仍然被定義為剩餘變異，即<span class="math inline">\(SS_T - SS_M\)</span>，但現在我們有了交互項，這變成了<span class="math display">\[SS_R=SS_T-(SS_A+SS_B+SS_{A:B})\]</span> 因此，剩餘平方和<span class="math inline">\(SS_R\)</span>將小於我們原先沒有交互作用的ANOVA。<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>當我們稍早前在jamovi中查看主效應分析時，您可能已經發現了這一點。為了本書中的解釋，我從之前的模型中刪除了交互組件，以保持清晰簡單。<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>這一章似乎創下了R字母可以代表的不同事物數量的新紀錄。到目前為止，我們有R指的是軟件包、我們的平均數表中的行數、模型中的殘差，以及現在的回歸中的相關係數。抱歉。顯然我們的字母表中字母不夠多。但是，我已經努力地澄清了在每種情況下R指的是哪一個東西。<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>您可能會問，治療對比和簡單對比之間有什麼區別？以性別主效應為例，其中 <span class="math inline">\(m=0\)</span> 和 <span class="math inline">\(f=1\)</span>。治療對比相應的係數將衡量女性和男性之間的平均值差異，截距將是男性的平均值。然而，對於簡單對比，即 <span class="math inline">\(m=-1\)</span> 和 <span class="math inline">\(f=1\)</span>，截距是平均值的平均數，主效應是每個組平均值與截距的差異。<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>如果，例如，你實際上想知道 A 組與 B 組和 C 組的平均值之間是否存在顯著差異，那麼你需要使用另一種工具（例如，更保守的 Scheffe’s 方法，這超出了本書的範疇）。然而，在大多數情況下，您可能對成對組別的差異感興趣，所以 Tukey 的 HSD 是一個相當有用的工具。<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>這種標準偏差的差異可能會（並且應該）讓您懷疑我們是否違反了變異數同質性假設。我將使用 Levene 檢驗選項將其作為讀者的練習來仔細檢查這一點。<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>實際上，這有點誇張。除了我在本書中討論的那些方面之外，ANOVA 還可以有其他變化。例如，我完全忽略了固定效應模型（其中因子的水平是由實驗者或世界“固定”的）和隨機效應模型（其中水平是來自可能水平的更大群體的隨機樣本）之間的區別（本書僅涵蓋固定效應模型）。不要犯誤認為這本書或任何其他書籍將告訴您關於統計的“您需要知道的一切”，正如一本書可能告訴您關於心理學、物理學或哲學的一切。生活太複雜了，以至於這永遠不會是真的。然而，這並非絕望的原因。大多數研究者只憑本書所涵蓋的基本 ANOVA 工作知識就能應對。我只是希望您記住，這本書只是一個非常長的故事的開始，而不是整個故事。<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p>或者，至少很少有趣。<a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12"><p>但是，在 jamovi 中，類型 III 和平方 ANOVA 的結果與所選對比無關，所以 jamovi 顯然在做一些不同的事情！<a href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn13"><p>當然，這確實取決於用戶指定的模型。如果原始 ANOVA 模型不包含 <span class="math inline">\(B \times C\)</span> 的交互作用項，那麼顯然它不會出現在零假設或對立假設中。但這對類型 I、II 和 III 都是如此。它們永遠不會包含您未包含的任何條款，但是在您包含的條款中，它們在構建測試方面做出了不同的選擇。<a href="#fnref13" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn14"><p>我覺得值得一提的是，R 中的默認值是類型 I，而 SPSS 和 jamovi 中的默認值是類型 III。這兩者都不是我特別喜歡的。此外，我覺得令人沮喪的是，在心理學文獻中，幾乎沒有人報告他們運行了哪種類型的測試，更不用說變量的順序（對於類型 I）或用於類型 III 的對比了。通常他們也不報告使用了什麼軟件。我能從人們通常報告的信息中理解的唯一方法就是嘗試從輔助線索猜測他們使用了哪款軟件，並假設他們從未更改過默認設置。請不要這樣做！現在您了解了這些問題，請確保說明您使用了什麼軟件，如果您報告了不平衡數據的 ANOVA 結果，那麼請指定您運行了哪種類型的測試，指定類型 I 測試的順序信息以及類型 III 測試的對比。或者，更好的是，做出與您真正關心的事物相對應的假設檢驗，然後報告這些！<a href="#fnref14" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "已复制");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "已复制");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp("https:\/\/scgeeker\.github\.io\/lsj-book-zh_tw\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./13-Comparing-several-means-one-way-ANOVA.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">比較多組平均值(單因子變異數分析)</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./15-Factor-Analysis.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">因素分析</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left"><a href="https://learnstatswithjamovi.com">用jamovi上手統計學</a></div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">電子書使用 <a href="https://quarto.org/">Quarto套件</a>創建</div>
  </div>
</footer>



</body></html>